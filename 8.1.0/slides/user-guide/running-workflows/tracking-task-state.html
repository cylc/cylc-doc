<!DOCTYPE html>


<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Tracking Job Status &mdash; Cylc 8.1.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/styles.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/single.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <link rel="stylesheet" href="../../_static/css/slides-custom.css" type="text/css" />
    
    
    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/single.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/diff_selector.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/grid_table.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/hieroglyph_theme_addons.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/tutorial.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/addons.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '8.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sphinx_highlight.js"></script>
    <script type="text/javascript" src="../../_static/js/diff_selector.js"></script>
    <script type="text/javascript" src="../../_static/js/minicylc.js"></script>
    <script type="text/javascript" src="../../_static/js/spoiler.js"></script>
    <script type="text/javascript" src="../../_static/js/addons.js"></script>
    <script type="text/javascript" src="../../_static/common.js"></script>
    
    <script type="text/javascript" src="../../_static/slides.js"></script>
    <script type="text/javascript" src="../../_static/sync.js"></script>
    <script type="text/javascript" src="../../_static/controller.js"></script>
    <script type="text/javascript" src="../../_static/init.js"></script>
    
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="top" title="Cylc 8.1.0 documentation" href="../../index.html" />
    <link rel="up" title="Running Workflows" href="index.html" />
    <link rel="next" title="Workflow Completion" href="workflow-completion.html" />
    <link rel="prev" title="Retrying Tasks" href="retrying-tasks.html" /> 
  </head>
  <body>

<section
   id="slide_container"
   class='slides layout-regular'>


  
<article class="slide level-1" id="tracking-job-status">

<h1>Tracking Job Status<a class="headerlink" href="../../../html/user-guide/running-workflows/tracking-task-state.html#tracking-job-status" title="View HTML">ยง</a></h1>

<p>Cylc supports three ways of tracking task state on job hosts:</p>
<ul class="simple">
<li>task-to-scheduler messaging via TCP (using ZMQ protocol)</li>
<li>task-to-scheduler messaging via non-interactive SSH to the workflow host, then
local TCP.</li>
<li>regular polling by the <a class="reference internal" href="../../glossary.html#term-scheduler"><span class="xref std std-term">scheduler</span></a></li>
</ul>
<p>These can be configured per platform using
<a class="reference internal" href="../../reference/config/global.html#global.cylc[platforms][&lt;platform name&gt;]communication method" title="global.cylc[platforms][&lt;platform name&gt;]communication method"><code class="xref cylc cylc-conf docutils literal notranslate"><span class="pre">global.cylc[platforms][&lt;platform</span> <span class="pre">name&gt;]communication</span> <span class="pre">method</span></code></a>.</p>
<p>If your site prohibits TCP and SSH back from job hosts to workflow hosts,
before resorting to the polling method you should consider installing dedicated
Cylc servers or VMs inside the HPC trust zone (where TCP and SSH should be
allowed).</p>
<p>It is possible to run Cylc <a class="reference internal" href="../../glossary.html#term-scheduler"><span class="xref std std-term">schedulers</span></a> on HPC login nodes,
but be aware of scheduler resource requirements (which depend on workflow size
and run duration).</p>
<p>Port forwarding could potentially provide another solution, but the idea has
been rejected at this stage. Organisations often disable port forwarding for
security reasons.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Use Cylc 8 platform configuration via
<a class="reference internal" href="../../reference/config/workflow.html#flow.cylc[runtime][&lt;namespace&gt;]platform" title="flow.cylc[runtime][&lt;namespace&gt;]platform"><code class="xref cylc cylc-conf docutils literal notranslate"><span class="pre">flow.cylc[runtime][&lt;namespace&gt;]platform</span></code></a>, not the
deprecated <code class="docutils literal notranslate"><span class="pre">host</span></code> setting, to ensure the intended task communication
method is applied.</p>
</div>




</article>
<article class="slide level-2" id="tcp-task-messaging">

<h2>TCP Task Messaging<a class="headerlink" href="../../../html/user-guide/running-workflows/tracking-task-state.html#tcp-task-messaging" title="View HTML">ยง</a></h2>

<p>Cylc <a class="reference internal" href="../../glossary.html#term-job-script"><span class="xref std std-term">job scripts</span></a> automatically invoke <code class="docutils literal notranslate"><span class="pre">cylc</span> <span class="pre">message</span></code> to
report progress back to the <a class="reference internal" href="../../glossary.html#term-scheduler"><span class="xref std std-term">scheduler</span></a> when they begin executing, at
normal exit (success) and abnormal exit (failure).</p>
<p>By default job status messaging goes by an authenticated TCP connection to the
<a class="reference internal" href="../../glossary.html#term-scheduler"><span class="xref std std-term">scheduler</span></a>, using the ZMQ protocol.  This is the preferred task
communications method because it is efficient and direct.</p>
<p>Schedulers automatically install workflow <a class="reference internal" href="../../glossary.html#term-contact-file"><span class="xref std std-term">contact information</span></a> and credentials on job hosts.</p>




</article>
<article class="slide level-2" id="ssh-task-communication">

<h2>SSH Task Communication<a class="headerlink" href="../../../html/user-guide/running-workflows/tracking-task-state.html#ssh-task-communication" title="View HTML">ยง</a></h2>

<p>Cylc can be configured to re-invoke task messaging commands on the workflow
host via non-interactive SSH (from job platform to workflow host).</p>
<p>User-invoked client commands also support this communication method, when
<a class="reference internal" href="../../reference/config/global.html#global.cylc[platforms][&lt;platform name&gt;]communication method" title="global.cylc[platforms][&lt;platform name&gt;]communication method"><code class="xref cylc cylc-conf docutils literal notranslate"><span class="pre">global.cylc[platforms][&lt;platform</span> <span class="pre">name&gt;]communication</span> <span class="pre">method</span></code></a> is
configured to <code class="docutils literal notranslate"><span class="pre">ssh</span></code>.</p>
<p>This is less efficient than direct ZMQ protocol messaging, but it may be useful at
sites where the ZMQ ports are blocked but non-interactive SSH is allowed.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Ensure SSH keys are in place for the remote task platform(s) before enabling
this feature. Failure to do so, will result in <code class="docutils literal notranslate"><span class="pre">Host</span> <span class="pre">key</span> <span class="pre">verification</span>
<span class="pre">failed</span></code> errors.</p>
</div>




</article>
<article class="slide level-2" id="polling-to-track-job-status">

<h2>Polling to Track Job Status<a class="headerlink" href="../../../html/user-guide/running-workflows/tracking-task-state.html#polling-to-track-job-status" title="View HTML">ยง</a></h2>

<p>Schedulers can actively poll jobs at configured intervals, via
non-interactive SSH to the job platform.</p>
<p>This is the least efficient communication method because task status updates
are delayed by up to the polling interval. However, it may be needed at sites
that do not allow TCP or non-interactive SSH from job host to workflow host.</p>
<p>Be careful to avoid spamming task hosts with polling operations. Each poll
opens (and then closes) a new SSH connection.</p>
<p>Polling intervals are configured by
:cylc:conf:
<a class="reference internal" href="../../reference/config/global.html#global.cylc[platforms][&lt;platform name&gt;]submission polling intervals" title="global.cylc[platforms][&lt;platform name&gt;]submission polling intervals"><code class="xref cylc cylc-conf docutils literal notranslate"><span class="pre">global.cylc[platforms][&lt;platform</span> <span class="pre">name&gt;]submission</span> <span class="pre">polling</span> <span class="pre">intervals</span></code></a>
and
:cylc:conf:
<a class="reference internal" href="../../reference/config/global.html#global.cylc[platforms][&lt;platform name&gt;]execution polling intervals" title="global.cylc[platforms][&lt;platform name&gt;]execution polling intervals"><code class="xref cylc cylc-conf docutils literal notranslate"><span class="pre">global.cylc[platforms][&lt;platform</span> <span class="pre">name&gt;]execution</span> <span class="pre">polling</span> <span class="pre">intervals</span></code></a>.</p>
<p>A common use case is to poll:</p>
<ul class="simple">
<li>frequently at first, to check that a job has started running properly;</li>
<li>frequently near the expected end of its run time, to get a timely task finished update;</li>
<li>infrequently in the intervening period.</li>
</ul>
<p>Configured intervals are used in sequence until
the last value, which is used repeatedly until the job is finished:</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">global.cylc</span></div>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[platforms]</span>
    <span class="nt">[[my_platform]]</span>
        <span class="c1"># poll every minute in the &#39;submitted&#39; state:</span>
        <span class="nv">submission polling intervals </span><span class="o">=</span><span class="s"> PT1M</span>

        <span class="c1"># poll one minute after foo starts running, then every 10</span>
        <span class="c1"># minutes for 50 minutes, then every minute until finished:</span>
        <span class="nv">execution polling intervals </span><span class="o">=</span><span class="s"> PT1M, 5*PT10M, PT1M</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">flow.cylc</span></div>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[runtime]</span>
   <span class="nt">[[task]]</span>
      <span class="nv">platform </span><span class="o">=</span><span class="s"> my_platform</span>
</pre></div>
</div>
</div>




</article>

</section>

<section id="slide_notes">

</section>

  </body>
</html>
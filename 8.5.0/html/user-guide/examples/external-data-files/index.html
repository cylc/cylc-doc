

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Using Data To Define Your Workflow &mdash; Cylc 8.5.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=47202671" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/diff_selector.css?v=9704a72b" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/grid_table.css?v=0285b42e" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/hieroglyph_theme_addons.css?v=814c2015" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/tutorial.css?v=b869d33c" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/addons.css?v=d1f804c3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css?v=0fad80e6" />

  
    <link rel="shortcut icon" href="../../../_static/cylc-favicon.ico"/>
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=9b928e36"></script>
      <script src="../../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../_static/js/diff_selector.js?v=3109bfa4"></script>
      <script src="../../../_static/js/minicylc.js?v=ddc882fd"></script>
      <script src="../../../_static/js/spoiler.js?v=12631137"></script>
      <script src="../../../_static/js/addons.js?v=39bd7dee"></script>
      <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Inter-Workflow Triggering" href="../inter-workflow-triggers/index.html" />
    <link rel="prev" title="Extending Workflow" href="../extending-workflow/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html">
            
              <img src="../../../_static/cylc-logo-white.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../7-to-8/index.html">Cylc 8 Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/index.html">Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../writing-workflows/index.html">Writing Workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installing-workflows.html">Installing Workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../running-workflows/index.html">Running Workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../task-implementation/index.html">Task Implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../interventions/index.html">Interventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../removing-workflows.html">Removing Workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cheat-sheet.html">Cheat Sheet</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Examples</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../1-hello-world/index.html">Hello World</a></li>
<li class="toctree-l3"><a class="reference internal" href="../2-integer-cycling/index.html">Integer Cycling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../3-datetime-cycling/index.html">Datetime Cycling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../converging-workflow/index.html">Converging Workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cycle-over-irregular-dates/index.html">Irregular Cycling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../event-driven-cycling/index.html">Event Driven Cycling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../expiry/index.html">Expiring Tasks / Cycles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extending-workflow/index.html">Extending Workflow</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Using Data To Define Your Workflow</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#the-approach">The Approach</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-workflow">The Workflow</a></li>
<li class="toctree-l4"><a class="reference internal" href="#data-types">Data Types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../inter-workflow-triggers/index.html">Inter-Workflow Triggering</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../troubleshooting.html">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../plugins/index.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../workflow-design-guide/index.html">Workflow Design Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/index.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Cylc</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">User Guide</a></li>
          <li class="breadcrumb-item"><a href="../index.html">Examples</a></li>
      <li class="breadcrumb-item active">Using Data To Define Your Workflow</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/user-guide/examples/external-data-files/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="using-data-to-define-your-workflow">
<h1>Using Data To Define Your Workflow<a class="headerlink" href="#using-data-to-define-your-workflow" title="Link to this heading"></a></h1>
<div class="hint admonition">
<p class="admonition-title">Get a copy of this example</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cylc<span class="w"> </span>get-resources<span class="w"> </span>examples/external-data-files
</pre></div>
</div>
</div>
<p>We often want to read in a dataset for use in defining our workflow.</p>
<p>The <a class="reference internal" href="../../../tutorial/runtime/configuration-consolidation/index.html#tutorial-cylc-consolidating-configuration"><span class="std std-ref">Cylc tutorial</span></a> is an
example of this where we want one <code class="docutils literal notranslate"><span class="pre">get_observations</span></code> task for each of a list
of weather stations. Each weather station has a name (e.g. “heathrow”) and an
ID (e.g. 3772).</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[runtime]</span>
    <span class="nt">[[get_observations_heathrow]]</span>
        <span class="nv">script </span><span class="o">=</span><span class="s"> get-observations</span>
        <span class="nt">[[[environment]]]</span>
            <span class="nv">SITE_ID </span><span class="o">=</span><span class="s"> 3772</span>
    <span class="nt">[[get_observations_camborne]]</span>
        <span class="nv">script </span><span class="o">=</span><span class="s"> get-observations</span>
        <span class="nt">[[[environment]]]</span>
            <span class="nv">SITE_ID </span><span class="o">=</span><span class="s"> 3808</span>
    <span class="nt">[[get_observations_shetland]]</span>
        <span class="nv">script </span><span class="o">=</span><span class="s"> get-observations</span>
        <span class="nt">[[[environment]]]</span>
            <span class="nv">SITE_ID </span><span class="o">=</span><span class="s"> 3005</span>
    <span class="nt">[[get_observations_aldergrove]]</span>
        <span class="nv">script </span><span class="o">=</span><span class="s"> get-observations</span>
        <span class="nt">[[[environment]]]</span>
            <span class="nv">SITE_ID </span><span class="o">=</span><span class="s"> 3917</span>
</pre></div>
</div>
<p>It can be inconvenient to write out the name and ID of each station in your
workflow like this, however, you may already have this information in a more
convenient format (i.e. a data file of some form).</p>
<p>With Cylc, we can use <a class="reference internal" href="../../writing-workflows/jinja2.html#jinja"><span class="std std-ref">Jinja2</span></a> to read in a data file and use that data to
define your workflow.</p>
<section id="the-approach">
<h2>The Approach<a class="headerlink" href="#the-approach" title="Link to this heading"></a></h2>
<p>This example has three components:</p>
<ol class="arabic">
<li><p>A JSON file containing a list of weather stations along with all the data
associated with them.</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">stations.json</span><a class="headerlink" href="#id1" title="Link to this code"></a></div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;camborne&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;wmo&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;03808&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;alt&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">87</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;lat&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">50.21841</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;lon&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-5.32753</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;heathrow&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;wmo&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;03772&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;alt&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;lat&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">51.47922</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;lon&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-0.45061</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;lerwick&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;wmo&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;03005&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;alt&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">82</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;lat&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">60.13893</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;lon&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-1.18491</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;aldergrove&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;wmo&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;03917&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;alt&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">63</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;lat&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">54.66365</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;lon&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-6.22534</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;exeter&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;wmo&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;03844&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;alt&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">27</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;lat&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">50.73717</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;lon&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-3.40579</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;middle_wallop&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;wmo&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;03749&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;alt&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">90</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;lat&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">51.14987</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;lon&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-1.56994</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</li>
<li><p>A Python function that reads the JSON file.</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">lib/python/load_data.py</span><a class="headerlink" href="#id2" title="Link to this code"></a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>


<span class="k">def</span><span class="w"> </span><span class="nf">load_json</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We put this Python code in the workflow’s <code class="docutils literal notranslate"><span class="pre">lib/python</span></code> directory which
allows us to import it from within our workflow.</p>
</li>
<li><p>A <code class="docutils literal notranslate"><span class="pre">flow.cylc</span></code> file that uses the Python function to load the
data file.</p>
<p>We can import Python functions with Jinja2 using the following syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%</span> <span class="kn">from</span><span class="w"> </span><span class="s2">&quot;load_data&quot;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">load_json</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
<p>For more information, see <a class="reference internal" href="../../writing-workflows/jinja2.html#jinja2-importing-python-modules"><span class="std std-ref">Importing Python modules</span></a>.</p>
</li>
</ol>
</section>
<section id="the-workflow">
<h2>The Workflow<a class="headerlink" href="#the-workflow" title="Link to this heading"></a></h2>
<p>The three files are arranged like so:</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">File Structure</span><a class="headerlink" href="#id3" title="Link to this code"></a></div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>|-- flow.cylc
|-- lib
|   `-- python
|       `-- load_data.py
`-- stations.json
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">flow.cylc</span></code> file:</p>
<ul class="simple">
<li><p>Imports the Python function.</p></li>
<li><p>Uses it to load the data.</p></li>
<li><p>Then uses the data to define the workflow.</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">flow.cylc</span><a class="headerlink" href="#id4" title="Link to this code"></a></div>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="c1">#!Jinja2</span>

<span class="k">[meta]</span>
<span class="w">    </span><span class="na">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">Weather Station Workflow</span>
<span class="w">    </span><span class="na">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="na">&quot;</span>
<span class="w">        </span><span class="na">This workflow demonstrates how to read in a data file for use in</span>
<span class="w">        </span><span class="na">defining your workflow.</span>

<span class="w">        </span><span class="na">We have a file called &quot;stations.json&quot; which contains a list of weather</span>
<span class="w">        </span><span class="na">stations with some data for each. This workflow reads the</span>
<span class="w">        </span><span class="na">&quot;stations.json&quot; file and creates a family for each weather station</span>
<span class="w">        </span><span class="na">with an environment variable for each data field.</span>

<span class="w">        </span><span class="na">You can load data in other formats too. Try changing &quot;load_json&quot; to</span>
<span class="w">        </span><span class="na">&quot;load_csv&quot; and &quot;stations.json&quot; to &quot;stations.csv&quot; for a CSV example.</span>
<span class="w">    </span><span class="na">&quot;&quot;&quot;</span>


<span class="na">{# Import a Python function to load our data. #}</span>
<span class="na">{% from &quot;load_data&quot; import load_json %}</span>

<span class="na">{# Load data from the specified file. #}</span>
<span class="na">{% set stations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">load_json(&#39;stations.json&#39;) %}</span>

<span class="na">{# Extract a list of station names from the data file. #}</span>
<span class="na">{% set station_names = stations | map(attribute</span><span class="o">=</span><span class="s">&quot;name&quot;</span><span class="na">) | list %}</span>


<span class="na">{# Provide Cylc with a list of weather stations. #}</span>
<span class="k">[task parameters]</span>
<span class="w">    </span><span class="na">station</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">{{ station_names | join(&#39;, &#39;) }}</span>


<span class="k">[scheduling]</span>
<span class="w">    </span><span class="na">initial cycle point</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">2000-01-01</span>
<span class="w">    </span><span class="na">final cycle point</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">2000-01-02</span>
<span class="w">    </span><span class="k">[[graph]]</span>
<span class="w">        </span><span class="na">P1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">fetch&lt;station&gt; =&gt; process&lt;station&gt; =&gt; collate</span>


<span class="k">[runtime]</span>
<span class="na">{# Define a family for each weather station #}</span>
<span class="na">{% for station in stations %}</span>
<span class="w">    </span><span class="k">[[STATION&lt;station={{ station[&quot;name&quot;] }}&gt;]]</span>
<span class="w">        </span><span class="k">[[[environment]]]</span>
<span class="w">            </span><span class="na">{# Turn the &lt;station&gt; parameter into an environment variable #}</span>
<span class="w">            </span><span class="na">{# NB</span><span class="o">:</span><span class="w"> </span><span class="s">Just to show how, we could also have used `station[&quot;name&quot;]`.</span><span class="w"> </span><span class="c1">#}</span>
<span class="w">            </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">%(station)s</span>
<span class="w">            </span><span class="na">{# Turn the data for this station into environment variables. #}</span>
<span class="w">            </span><span class="na">wmo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">{{ station[&quot;wmo&quot;] }}</span>
<span class="w">            </span><span class="na">alt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">{{ station[&quot;alt&quot;] }}</span>
<span class="w">            </span><span class="na">lat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">{{ station[&quot;lat&quot;] }}</span>
<span class="w">            </span><span class="na">lon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">{{ station[&quot;lon&quot;] }}</span>
<span class="na">{% endfor %}</span>

<span class="w">    </span><span class="c1"># a task that gets data</span>
<span class="w">    </span><span class="k">[[fetch&lt;station&gt;]]</span>
<span class="w">        </span><span class="na">inherit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">STATION&lt;station&gt;</span>
<span class="w">        </span><span class="na">script</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">echo &quot;fetch data for $name, WMO ID: $wmo&quot;</span>

<span class="w">    </span><span class="k">[[process&lt;station&gt;]]</span>
<span class="w">        </span><span class="na">inherit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">STATION&lt;station&gt;</span>
<span class="w">        </span><span class="na">script</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">echo &quot;process data for $name, location: $lat,$lon&quot;</span>

<span class="w">    </span><span class="k">[[collate]]</span>
<span class="w">        </span><span class="na">script</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;echo collate data for stations: {{ station_names }}&quot;</span>
</pre></div>
</div>
</div>
</section>
<section id="data-types">
<h2>Data Types<a class="headerlink" href="#data-types" title="Link to this heading"></a></h2>
<p>We can load other types of data file too. This example also includes the same
data in CSV format along with a Python function to load CSV data. To try it
out, open the <code class="docutils literal notranslate"><span class="pre">flow.cylc</span></code> file and replace <code class="docutils literal notranslate"><span class="pre">stations.json</span></code> with
<code class="docutils literal notranslate"><span class="pre">stations.csv</span></code> and <code class="docutils literal notranslate"><span class="pre">load_json</span></code> with <code class="docutils literal notranslate"><span class="pre">load_csv</span></code>.</p>
<p>Any Python code that you import using Jinja2 will be executed using the Python
environment that Cylc is running in. So if you want to import Python code that
isn’t in the standard library, you may need to get your system administrator to
install this dependency into the Cylc environment for you.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../extending-workflow/index.html" class="btn btn-neutral float-left" title="Extending Workflow" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../inter-workflow-triggers/index.html" class="btn btn-neutral float-right" title="Inter-Workflow Triggering" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2008-2025 NIWA &amp; British Crown (Met Office) &amp; Contributors.
      <span class="lastupdated">Last updated on Jul 25, 2025.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <!--
  element which gets populated with the list of available versions and
  formats for the documentation by versions.js
-->
<div
  class="rst-versions"
  data-toggle="rst-versions"
  id='versions-and-formats'
></div>




<script type="text/javascript">
    const CUR_FORMAT = "html";
    const CUR_VERSION = "8.5.0";
    // name of page (in URL), for singlepage builds this will be `index`
    const PAGE_NAME = "user-guide/examples/external-data-files/index";
    // URL path to the base docs dir i.e. ROOT_DIR/version/format
    const ROOT_DIR = "../../../../..";
</script>

<script
  type="text/javascript"
  src="../../../../../versions.js"
></script><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
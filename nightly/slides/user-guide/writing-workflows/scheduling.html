<!DOCTYPE html>


<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Scheduling - Dependency Graphs &mdash; Cylc nightly.2021-07-15 documentation</title>
    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/styles.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/single.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <link rel="stylesheet" href="../../_static/css/slides-custom.css" type="text/css" />
    
    
    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/single.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/diff_selector.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/grid_table.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/hieroglyph_theme_addons.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/tutorial.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/addons.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     'nightly.2021-07-15',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/js/diff_selector.js"></script>
    <script type="text/javascript" src="../../_static/js/minicylc.js"></script>
    <script type="text/javascript" src="../../_static/js/spoiler.js"></script>
    <script type="text/javascript" src="../../_static/js/addons.js"></script>
    <script type="text/javascript" src="../../_static/common.js"></script>
    
    <script type="text/javascript" src="../../_static/slides.js"></script>
    <script type="text/javascript" src="../../_static/sync.js"></script>
    <script type="text/javascript" src="../../_static/controller.js"></script>
    <script type="text/javascript" src="../../_static/init.js"></script>
    
    
    <link rel="shortcut icon" href="../../_static/cylc-favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="top" title="Cylc nightly.2021-07-15 documentation" href="../../index.html" />
    <link rel="up" title="Writing Workflows" href="index.html" />
    <link rel="next" title="Runtime - Task Configuration" href="runtime.html" />
    <link rel="prev" title="Workflow Configuration" href="configuration.html" /> 
  </head>
  <body>

<section
   id="slide_container"
   class='slides layout-regular'>


  
<article class="slide level-1" id="scheduling-dependency-graphs">

<h1>Scheduling - Dependency Graphs<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#scheduling-dependency-graphs" title="View HTML">§</a></h1>

<div class="tip tutorial-ref admonition">
<p class="first admonition-title">Related Tutorial</p>
<p class="last"><a class="reference internal" href="../../tutorial/scheduling/index.html#tutorial-scheduling"><span class="std std-ref">Scheduling Tutorial</span></a></p>
</div>
<p>The <a class="reference internal" href="../../glossary.html#term-graph"><span class="xref std std-term">graph</span></a> defines the workflow in terms of
<a class="reference internal" href="../../glossary.html#term-task"><span class="xref std std-term">tasks</span></a> and the <a class="reference internal" href="../../glossary.html#term-dependency"><span class="xref std std-term">dependencies</span></a>
between them.</p>




</article>
<article class="slide level-2" id="graph-syntax">

<h2>Graph Syntax<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#graph-syntax" title="View HTML">§</a></h2>

<div class="tip tutorial-ref admonition">
<p class="first admonition-title">Related Tutorial</p>
<p class="last"><a class="reference internal" href="../../tutorial/scheduling/graphing.html#tutorial-cylc-graphing"><span class="std std-ref">Graph Tutorial</span></a></p>
</div>
<p>A Cylc <a class="reference internal" href="../../glossary.html#term-graph"><span class="xref std std-term">graph</span></a> is composed of one or more
<a class="reference internal" href="../../glossary.html#term-graph-string"><span class="xref std std-term">graph strings</span></a> which use a special syntax.</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">=&gt;</span></code> defines a dependency.</li>
<li><code class="docutils literal notranslate"><span class="pre">&amp;</span></code> and <code class="docutils literal notranslate"><span class="pre">|</span></code> meaning <em>and</em> &amp; <em>or</em> can be used to write
<a class="reference internal" href="../../glossary.html#term-conditional-dependency"><span class="xref std std-term">conditional dependencies</span></a>.</li>
</ul>
<p>For example:</p>
<div class="highlight-cylc-graph notranslate"><div class="highlight"><pre><span></span><span class="c1"># baz will not be run until both foo and bar have succeeded</span>
<span class="kd">foo</span> <span class="o">&amp;</span> <span class="kd">bar</span> <span class="o">=&gt;</span> <span class="kd">baz</span>
</pre></div>
</div>
<p>These <a class="reference internal" href="../../glossary.html#term-graph-string"><span class="xref std std-term">graph strings</span></a> are configured in the
<a class="reference internal" href="../../reference/config/workflow.html#flow.cylc[scheduling][graph]" title="flow.cylc[scheduling][graph]"><code class="xref cylc cylc-conf docutils literal notranslate"><span class="pre">[scheduling][graph]</span></code></a> section e.g:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">R1 </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            foo &amp; bar =&gt; baz</span>
<span class="s2">        &quot;&quot;&quot;</span>
</pre></div>
</div>
<p>In this example <code class="docutils literal notranslate"><span class="pre">R1</span></code> is the <a class="reference internal" href="../../glossary.html#term-recurrence"><span class="xref std std-term">recurrence</span></a> which defines the interval
at which this graph string is to be run. <code class="docutils literal notranslate"><span class="pre">R1</span></code> means “run once”, <code class="docutils literal notranslate"><span class="pre">P1D</span></code> means every day.</p>
<p>Graph strings may contain blank lines, arbitrary white space and comments e.g:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">R1 </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>

<span class="s2">            foo &amp; bar =&gt; baz</span>  <span class="c1"># baz is dependent on foo and bar</span><span class="s2"></span>

<span class="s2">        &quot;&quot;&quot;</span>
</pre></div>
</div>




</article>
<article class="slide level-2" id="interpreting-graph-strings">

<h2>Interpreting Graph Strings<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#interpreting-graph-strings" title="View HTML">§</a></h2>

<p>Workflow dependency graphs can be broken down into pairs in which the left
side (which may be a single task or family, or several that are
conditionally related) defines a <a class="reference internal" href="../../glossary.html#term-trigger"><span class="xref std std-term">trigger</span></a> for the task or family on the
right. For instance the “word graph” <em>C triggers off B which
triggers off A</em> can be deconstructed into pairs <em>C triggers off B</em>
and <em>B triggers off A</em>. In this section we use only the default
trigger type, which is to trigger off the upstream task succeeding;
see <a class="reference internal" href="#triggertypes"><span class="std std-ref">Task Triggering</span></a> for other available triggers.</p>
<p>In the case of cycling tasks, the triggers defined by a graph string are
valid for cycle points matching the list of hours specified for the
graph section. For example this graph:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">T00,T12 </span><span class="o">=</span><span class="s"> &quot;A =&gt; B&quot;</span>
</pre></div>
</div>
<p>implies that <code class="docutils literal notranslate"><span class="pre">B</span></code> triggers off <code class="docutils literal notranslate"><span class="pre">A</span></code> for cycle points in which the hour
matches <code class="docutils literal notranslate"><span class="pre">00</span></code> or <code class="docutils literal notranslate"><span class="pre">12</span></code>.</p>
<p>To define inter-cycle dependencies, attach an offset indicator to the
left side of a pair:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">T00,T12 </span><span class="o">=</span><span class="s"> &quot;A[-PT12H] =&gt; B&quot;</span>
</pre></div>
</div>
<p>This means <code class="docutils literal notranslate"><span class="pre">B[time]</span></code> triggers off <code class="docutils literal notranslate"><span class="pre">A[time-PT12H]</span></code> (12 hours before) for cycle
points with hours matching <code class="docutils literal notranslate"><span class="pre">00</span></code> or <code class="docutils literal notranslate"><span class="pre">12</span></code>. <code class="docutils literal notranslate"><span class="pre">time</span></code> is implicit because
this keeps graphs clean and concise, given that the
majority of tasks will typically
depend only on others with the same cycle point. Cycle point offsets can only
appear on the left of a pair, because a pairs define triggers for the right
task at cycle point <code class="docutils literal notranslate"><span class="pre">time</span></code>. However, <code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">=&gt;</span> <span class="pre">B[-PT6H]</span></code>, which is
illegal, can be reformulated as a <em>future trigger</em>
<code class="docutils literal notranslate"><span class="pre">A[+PT6H]</span> <span class="pre">=&gt;</span> <span class="pre">B</span></code> (see <a class="reference internal" href="#intercyclepointtriggers"><span class="std std-ref">Inter-Cycle Triggers</span></a>). It is also
possible to combine multiple offsets within a cycle point offset e.g.</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">T00,T12 </span><span class="o">=</span><span class="s"> &quot;A[-P1D-PT12H] =&gt; B&quot;</span>
</pre></div>
</div>
<p>This means that <code class="docutils literal notranslate"><span class="pre">B[Time]</span></code> triggers off <code class="docutils literal notranslate"><span class="pre">A[time-P1D-PT12H]</span></code> (1 day and 12 hours
before).</p>
<p>Triggers can be chained together. This graph:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nv">T00, T12 </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    A =&gt; B</span>  <span class="c1"># B triggers off A</span><span class="s2"></span>
<span class="s2">    B =&gt; C</span>  <span class="c1"># C triggers off B</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>is equivalent to this:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nv">T00, T12 </span><span class="o">=</span><span class="s"> &quot;A =&gt; B =&gt; C&quot;</span>
</pre></div>
</div>
<p><em>Each trigger in the graph must be unique</em> but <em>the same task
can appear in multiple pairs or chains</em>. Separately defined triggers
for the same task have an AND relationship. So this:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nv">T00, T12 </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    A =&gt; X</span>  <span class="c1"># X triggers off A</span><span class="s2"></span>
<span class="s2">    B =&gt; X</span>  <span class="c1"># X also triggers off B</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>is equivalent to this:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nv">T00, T12 </span><span class="o">=</span><span class="s"> &quot;A &amp; B =&gt; X&quot;</span>  <span class="c1"># X triggers off A AND B</span>
</pre></div>
</div>
<p>In summary, the branching tree structure of a dependency graph can
be partitioned into lines (in the <a class="reference internal" href="../../reference/config/workflow.html#flow.cylc" title="flow.cylc"><code class="xref cylc cylc-conf docutils literal notranslate"><span class="pre">flow.cylc</span></code></a> graph string) of pairs
or chains, in any way you like, with liberal use of internal white space
and comments to make the graph structure as clear as possible.</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="c1"># B triggers if A succeeds, then C and D trigger if B succeeds:</span>
    <span class="nv">R1 </span><span class="o">=</span><span class="s"> &quot;A =&gt; B =&gt; C &amp; D&quot;</span>
<span class="c1"># which is equivalent to this:</span>
    <span class="nv">R1 </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        A =&gt; B =&gt; C</span>
<span class="s2">        B =&gt; D</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="c1"># and to this:</span>
    <span class="nv">R1 </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        A =&gt; B =&gt; D</span>
<span class="s2">        B =&gt; C</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="c1"># and to this:</span>
    <span class="nv">R1 </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        A =&gt; B</span>
<span class="s2">        B =&gt; C</span>
<span class="s2">        B =&gt; D</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="c1"># and it can even be written like this:</span>
    <span class="nv">R1 </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        A =&gt; B</span> <span class="c1"># blank line follows:</span><span class="s2"></span>

<span class="s2">        B =&gt; C</span> <span class="c1"># comment ...</span><span class="s2"></span>
<span class="s2">        B =&gt; D</span>
<span class="s2">    &quot;&quot;&quot;</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="splitting-up-long-graph-lines">

<h3>Splitting Up Long Graph Lines<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#splitting-up-long-graph-lines" title="View HTML">§</a></h3>

<p>It is not necessary to use the general line continuation marker
<code class="docutils literal notranslate"><span class="pre">\</span></code> to split long graph lines. Just break at dependency arrows,
or split long chains into smaller ones. This graph:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nv">R1 </span><span class="o">=</span><span class="s"> &quot;A =&gt; B =&gt; C&quot;</span>
</pre></div>
</div>
<p>is equivalent to this:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nv">R1 </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    A =&gt; B =&gt;</span>
<span class="s2">    C</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>and also to this:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nv">R1 </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    A =&gt; B</span>
<span class="s2">    B =&gt; C</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>




</article>
<article class="slide level-2" id="graph-types">

<h2>Graph Types<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#graph-types" title="View HTML">§</a></h2>

<p>A workflow configuration can contain multiple graph strings that are combined
to generate the final graph.</p>




</article>
<article class="slide level-3" id="one-off-non-cycling">

<h3>One-off (Non-Cycling)<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#one-off-non-cycling" title="View HTML">§</a></h3>

<p>The following is a small workflow of one-off non-cycling
tasks; these all share a single cycle point (<code class="docutils literal notranslate"><span class="pre">1</span></code>) and don’t spawn
successors (once they’re all finished the workflow just exits). The integer
<code class="docutils literal notranslate"><span class="pre">1</span></code> attached to each graph node is just an arbitrary label here.</p>
<div class="twocol docutils container">
<div class="caption docutils container">
<p><em>One-off (Non-Cycling) Tasks</em></p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[meta]</span>
    <span class="nv">title </span><span class="o">=</span><span class="s"> some one-off tasks</span>
<span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">R1 </span><span class="o">=</span><span class="s"> &quot;foo =&gt; bar &amp; baz =&gt; qux&quot;</span>
</pre></div>
</div>
</div>
<div class="image docutils container">
<div class="figure align-center" id="fig-test1">
<img alt="../../_images/test1.png" src="../../_images/test1.png" />
</div>
</div>
</div>




</article>
<article class="slide level-3" id="cycling-graphs">

<h3>Cycling Graphs<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#cycling-graphs" title="View HTML">§</a></h3>

<p>For cycling tasks the graph section heading defines a sequence of cycle points
for which the subsequent graph section is valid, as demonstrated here for a
small workflow of cycling tasks:</p>
<div class="twocol docutils container">
<div class="caption docutils container">
<p><em>Cycling Tasks</em></p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[meta]</span>
    <span class="nv">title </span><span class="o">=</span><span class="s"> some cycling tasks</span>
<span class="c1"># (no dependence between cycle points)</span>
<span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">T00,T12 </span><span class="o">=</span><span class="s"> &quot;foo =&gt; bar &amp; baz =&gt; qux&quot;</span>
</pre></div>
</div>
</div>
<div class="image docutils container">
<div class="figure align-center" id="fig-test2">
<img alt="../../_images/test2.png" src="../../_images/test2.png" />
</div>
</div>
</div>




</article>
<article class="slide level-2" id="graph-section-headings">

<h2>Graph Section Headings<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#graph-section-headings" title="View HTML">§</a></h2>

<div class="tip tutorial-ref admonition">
<p class="first admonition-title">Related Tutorial</p>
<p class="last"><a class="reference internal" href="../../tutorial/scheduling/datetime-cycling.html#tutorial-datetime-cycling"><span class="std std-ref">Datetime Tutorial</span></a></p>
</div>
<p>Graph section headings define recurrence expressions, the graph within a graph
section heading defines a workflow at each point of the recurrence. For
example in the following scenario:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">T06 </span><span class="o">=</span><span class="s"> foo =&gt; bar</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">T06</span></code> means “Run every day starting at 06:00 after the
initial cycle point”. Cylc allows you to start (or end) at any particular
time, repeat at whatever frequency you like, and even optionally limit the
number of repetitions.</p>
<p>Graph section heading can also be used with
<a class="reference internal" href="#integercycling"><span class="std std-ref">integer cycling</span></a>.</p>




</article>
<article class="slide level-3" id="syntax-rules">

<h3>Syntax Rules<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#syntax-rules" title="View HTML">§</a></h3>

<p><a class="reference internal" href="../../glossary.html#term-datetime-cycling"><span class="xref std std-term">Date-time cycling</span></a> information is made up of a
starting <a class="reference internal" href="../../glossary.html#term-ISO8601-datetime"><span class="xref std std-term">datetime</span></a>, an interval, and an optional
limit.</p>
<p>The time is assumed to be in the local time zone unless you set
<a class="reference internal" href="../../reference/config/workflow.html#flow.cylc[scheduler]cycle point time zone" title="flow.cylc[scheduler]cycle point time zone"><code class="xref cylc cylc-conf docutils literal notranslate"><span class="pre">[scheduler]cycle</span> <span class="pre">point</span> <span class="pre">time</span> <span class="pre">zone</span></code></a> or <a class="reference internal" href="../../reference/config/workflow.html#flow.cylc[scheduler]UTC mode" title="flow.cylc[scheduler]UTC mode"><code class="xref cylc cylc-conf docutils literal notranslate"><span class="pre">[scheduler]UTC</span> <span class="pre">mode</span></code></a>.
The calendar is assumed to be the proleptic Gregorian calendar unless
you set <a class="reference internal" href="../../reference/config/workflow.html#flow.cylc[scheduling]cycling mode" title="flow.cylc[scheduling]cycling mode"><code class="xref cylc cylc-conf docutils literal notranslate"><span class="pre">[scheduling]cycling</span> <span class="pre">mode</span></code></a>.</p>
<p>The syntax for representations is based on the <a class="reference internal" href="../../glossary.html#term-ISO8601"><span class="xref std std-term">ISO8601</span></a> date-time standard.
This includes the representation of date-times and intervals. What we
define for Cylc’s cycling syntax is our own optionally-heavily-condensed form
of ISO8601 recurrence syntax. The most common full form is:
<code class="docutils literal notranslate"><span class="pre">R[limit?]/[date-time]/[interval]</span></code>. However, we allow omitting
information that can be guessed from the context (rules below). This means
that it can be written as:</p>
<div class="highlight-sub notranslate"><div class="highlight"><pre><span></span>R[limit?]/[date-time]
R[limit?]//[interval]
[date-time]/[interval]
R[limit?] <span class="c"># Special limit of 1 case</span>
[date-time]
[interval]
</pre></div>
</div>
<p>with example graph headings for each form being:</p>
<div class="highlight-sub notranslate"><div class="highlight"><pre><span></span>R5/T00           <span class="c"># Run 5 times at 00:00 every day</span>
R//PT1H          <span class="c"># Run every hour (Note the R// is redundant)</span>
20000101T00Z/P1D <span class="c"># Run every day starting at 00:00 1st Jan 2000</span>
R1               <span class="c"># Run once at the initial cycle point</span>
R1/20000101T00Z  <span class="c"># Run once at 00:00 1st Jan 2000</span>
P1Y              <span class="c"># Run every year</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">T00</span></code> is an example of <code class="docutils literal notranslate"><span class="pre">[date-time]</span></code>, with an
inferred 1 day period and no limit.</p>
</div>
<p>Where some or all date-time information is omitted, it is inferred to
be relative to the <a class="reference internal" href="../../glossary.html#term-initial-cycle-point"><span class="xref std std-term">initial cycle point</span></a>. For example, <code class="docutils literal notranslate"><span class="pre">T00</span></code>
by itself would mean the next occurrence of midnight that follows, or is, the
initial cycle point. Entering <code class="docutils literal notranslate"><span class="pre">+PT6H</span></code> would mean 6 hours after the
initial cycle point. Entering <code class="docutils literal notranslate"><span class="pre">-P1D</span></code> would mean 1 day before the
initial cycle point. Entering no information for the date-time implies
the initial cycle point date-time itself.</p>
<p>Where the interval is omitted and some (but not all) date-time
information is omitted, it is inferred to be a single unit above
the largest given specific date-time unit. For example, the largest
given specific unit in <code class="docutils literal notranslate"><span class="pre">T00</span></code> is hours, so the inferred interval is
1 day (daily), <code class="docutils literal notranslate"><span class="pre">P1D</span></code>.</p>
<p>Where the limit is omitted, unlimited cycling is assumed. This will be
bounded by the final cycle point’s date-time if given.</p>
<p>Another supported form of ISO8601 <a class="reference internal" href="../../glossary.html#term-recurrence"><span class="xref std std-term">recurrence</span></a> is:
<code class="docutils literal notranslate"><span class="pre">R[limit?]/[interval]/[date-time]</span></code>. This form uses the
date-time as the end of the cycling sequence rather than the start.
For example, <code class="docutils literal notranslate"><span class="pre">R3/P5D/20140430T06</span></code> means:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>20140420T06
20140425T06
20140430T06
</pre></div>
</div>
<p>This kind of form can be used for specifying special behaviour near the end of
the workflow, at the final cycle point’s date-time. We can also represent this in
cylc with a collapsed form:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>R[limit?]/[interval]
R[limit?]//[date-time]
[interval]/[date-time]
</pre></div>
</div>
<p>So, for example, you can write:</p>
<div class="highlight-sub notranslate"><div class="highlight"><pre><span></span>R1//+P0D  <span class="c"># Run once at the final cycle point</span>
R5/P1D    <span class="c"># Run 5 times, every 1 day, ending at the final</span>
          <span class="c"># cycle point</span>
P2W/T00   <span class="c"># Run every 2 weeks ending at 00:00 following</span>
          <span class="c"># the final cycle point</span>
R//T00    <span class="c"># Run every 1 day ending at 00:00 following the</span>
          <span class="c"># final cycle point</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="referencing-the-initial-and-final-cycle-points">

<h3>Referencing The Initial And Final Cycle Points<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#referencing-the-initial-and-final-cycle-points" title="View HTML">§</a></h3>

<p>For convenience the caret and dollar symbols may be used as shorthand for the
initial and final cycle points. Using this shorthand you can write:</p>
<div class="highlight-sub notranslate"><div class="highlight"><pre><span></span>R1/^+PT12H  <span class="c"># Repeat once 12 hours after the initial cycle point</span>
            <span class="c"># R[limit]/[date-time]</span>
            <span class="c"># Equivalent to R1/+PT12H</span>
R1/$        <span class="c"># Repeat once at the final cycle point</span>
            <span class="c"># R[limit]/[date-time]</span>
            <span class="c"># Equivalent to R1//+P0D</span>
$-P2D/PT3H  <span class="c"># Repeat 3 hourly starting two days before the</span>
            <span class="c"># [date-time]/[interval]</span>
            <span class="c"># final cycle point</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>There can be multiple ways to write the same headings, for instance
the following all run once at the final cycle point:</p>
<div class="last highlight-sub notranslate"><div class="highlight"><pre><span></span>R1/P0Y       <span class="c"># R[limit]/[interval]</span>
R1/P0Y/$     <span class="c"># R[limit]/[interval]/[date-time]</span>
R1/$         <span class="c"># R[limit]/[date-time]</span>
</pre></div>
</div>
</div>




</article>
<article class="slide level-3" id="how-multiple-graph-strings-combine">

<h3>How Multiple Graph Strings Combine<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#how-multiple-graph-strings-combine" title="View HTML">§</a></h3>

<p>For a cycling graph with multiple validity sections for different
hours of the day, the different sections <em>add</em> to generate the
complete graph. Different graph sections can overlap (i.e. the same
hours may appear in multiple section headings) and the same tasks may
appear in multiple sections, but individual dependencies should be
unique across the entire graph. For example, the following graph defines
a duplicate prerequisite for task C:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">T00,T06,T12,T18 </span><span class="o">=</span><span class="s"> &quot;A =&gt; B =&gt; C&quot;</span>
        <span class="nv">T06,T18 </span><span class="o">=</span><span class="s"> &quot;B =&gt; C =&gt; X&quot;</span>
        <span class="c1"># duplicate prerequisite: B =&gt; C already defined at T06, T18</span>
</pre></div>
</div>
<p>This does not affect scheduling, but for the sake of clarity and brevity
the graph should be written like this:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">T00,T06,T12,T18 </span><span class="o">=</span><span class="s"> &quot;A =&gt; B =&gt; C&quot;</span>
        <span class="c1"># X triggers off C only at 6 and 18 hours</span>
        <span class="nv">T06,T18 </span><span class="o">=</span><span class="s"> &quot;C =&gt; X&quot;</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="id2">

<h3>Excluding Dates<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#id2" title="View HTML">§</a></h3>

<p><a class="reference internal" href="../../glossary.html#term-ISO8601-datetime"><span class="xref std std-term">Date-times</span></a> can be excluded from a <a class="reference internal" href="../../glossary.html#term-recurrence"><span class="xref std std-term">recurrence</span></a>
by an exclamation mark for example <code class="docutils literal notranslate"><span class="pre">PT1D!20000101</span></code> means run daily except on
the first of January 2000.</p>
<p>This syntax can be used to exclude one or multiple date-times from a
recurrence. Multiple date-times are excluded using the syntax
<code class="docutils literal notranslate"><span class="pre">PT1D!(20000101,20000102,...)</span></code>. All date-times listed within
the parentheses after the exclamation mark will be excluded.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal notranslate"><span class="pre">^</span></code> and <code class="docutils literal notranslate"><span class="pre">$</span></code> symbols (shorthand for the initial
and final cycle points) are both date-times so <code class="docutils literal notranslate"><span class="pre">T12!$-PT1D</span></code>
is valid.</p>
</div>
<p>If using a run limit in combination with an exclusion, the heading might not
run the number of times specified in the limit. For example in the following
workflow <code class="docutils literal notranslate"><span class="pre">foo</span></code> will only run once as its second run has been excluded.</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nv">initial cycle point </span><span class="o">=</span><span class="s"> 20000101T00Z</span>
    <span class="nv">final cycle point </span><span class="o">=</span><span class="s"> 20000105T00Z</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">R2/P1D!20000102 </span><span class="o">=</span><span class="s"> foo</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="excluding-recurrences">

<h3>Excluding Recurrences<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#excluding-recurrences" title="View HTML">§</a></h3>

<p>In addition to excluding isolated date-time points or lists of date-time points
from recurrences, exclusions themselves may be date-time recurrence sequences.
Any partial date-time or sequence given after the exclamation mark will be
excluded from the main sequence.</p>
<p>For example, partial date-times can be excluded using the syntax:</p>
<div class="highlight-sub notranslate"><div class="highlight"><pre><span></span>PT1H ! T12                   <span class="c"># Run hourly but not at 12:00 from the initial</span>
                             <span class="c"># cycle point.</span>
T-00 ! (T00, T06, T12, T18)  <span class="c"># Run hourly but not at 00:00, 06:00,</span>
                             <span class="c"># 12:00, 18:00.</span>
PT5M ! T-15                  <span class="c"># Run 5-minutely but not at 15 minutes past the</span>
                             <span class="c"># hour from the initial cycle point.</span>
T00 ! W-1T00                 <span class="c"># Run daily at 00:00 except on Mondays.</span>
</pre></div>
</div>
<p>It is also valid to use sequences for exclusions. For example:</p>
<div class="highlight-sub notranslate"><div class="highlight"><pre><span></span>PT1H ! PT6H         <span class="c"># Run hourly from the initial cycle point but</span>
                    <span class="c"># not 6-hourly from the initial cycle point.</span>
T-00 ! PT6H         <span class="c"># Run hourly on the hour but not 6-hourly on the hour.</span>
<span class="c"># Same as T-00 ! T-00/PT6H (T-00 context is implied)</span>
<span class="c"># Same as T-00 ! (T00, T06, T12, T18)</span>
<span class="c"># Same as PT1H ! (T00, T06, T12, T18) Initial cycle point dependent</span>

T12 ! T12/P15D      <span class="c"># Run daily at 12:00 except every 15th day.</span>

R/^/P1H ! R5/20000101T00/P1D    <span class="c"># Any valid recurrence may be used to</span>
                                <span class="c"># determine exclusions. This example</span>
                                <span class="c"># translates to: Repeat every hour from</span>
                                <span class="c"># the initial cycle point, but exclude</span>
                                <span class="c"># 00:00 for 5 days from the 1st January</span>
                                <span class="c"># 2000.</span>
</pre></div>
</div>
<p>You can combine exclusion sequences and single point exclusions within a
comma separated list enclosed in parentheses:</p>
<div class="highlight-sub notranslate"><div class="highlight"><pre><span></span>T-00 ! (20000101T07, PT2H)  <span class="c"># Run hourly on the hour but not at 07:00</span>
                            <span class="c"># on the 1st Jan, 2000 and not 2-hourly</span>
                            <span class="c"># on the hour.</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="advanced-examples">

<h3>Advanced Examples<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#advanced-examples" title="View HTML">§</a></h3>

<p>The following examples show the various ways of writing graph headings in Cylc.</p>
<div class="highlight-sub notranslate"><div class="highlight"><pre><span></span>R1         <span class="c"># Run once at the initial cycle point</span>
P1D        <span class="c"># Run every day starting at the initial cycle point</span>
PT5M       <span class="c"># Run every 5 minutes starting at the initial cycle point</span>
T00/P2W    <span class="c"># Run every 2 weeks starting at 00:00 after the</span>
           <span class="c"># initial cycle point</span>
+P5D/P1M   <span class="c"># Run every month, starting 5 days after the initial cycle point</span>
R1/T06     <span class="c"># Run once at 06:00 after the initial cycle point</span>
R1/P0Y     <span class="c"># Run once at the final cycle point</span>
R1/$       <span class="c"># Run once at the final cycle point (alternative form)</span>
R1/$-P3D   <span class="c"># Run once three days before the final cycle point</span>
R3/T0830   <span class="c"># Run 3 times, every day at 08:30 after the initial cycle point</span>
R3/01T00   <span class="c"># Run 3 times, every month at 00:00 on the first</span>
           <span class="c"># of the month after the initial cycle point</span>
R5/W-1/P1M <span class="c"># Run 5 times, every month starting on Monday</span>
           <span class="c"># following the initial cycle point</span>
T00!^      <span class="c"># Run at the first occurrence of T00 that isn&#39;t the</span>
           <span class="c"># initial cycle point</span>
PT1D!20000101  <span class="c"># Run every day days excluding 1st Jan 2000</span>
20140201T06/P1D    <span class="c"># Run every day starting at 20140201T06</span>
R1/min(T00,T06,T12,T18)  <span class="c"># Run once at the first instance</span>
                         <span class="c"># of either T00, T06, T12 or T18</span>
                         <span class="c"># starting at the initial cycle point</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="advanced-starting-up">

<h3>Advanced Starting Up<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#advanced-starting-up" title="View HTML">§</a></h3>

<p>Dependencies that are only valid at the <a class="reference internal" href="../../glossary.html#term-initial-cycle-point"><span class="xref std std-term">initial cycle point</span></a> can be
written using the <code class="docutils literal notranslate"><span class="pre">R1</span></code> notation. For example:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduler]</span>
    <span class="nv">UTC mode </span><span class="o">=</span><span class="s"> True</span>
    <span class="nv">allow implicit tasks </span><span class="o">=</span><span class="s"> True</span>
<span class="nt">[scheduling]</span>
    <span class="nv">initial cycle point </span><span class="o">=</span><span class="s"> 20130808T00</span>
    <span class="nv">final cycle point </span><span class="o">=</span><span class="s"> 20130812T00</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">R1 </span><span class="o">=</span><span class="s"> &quot;prep =&gt; foo&quot;</span>
        <span class="nv">T00 </span><span class="o">=</span><span class="s"> &quot;foo[-P1D] =&gt; foo =&gt; bar&quot;</span>
</pre></div>
</div>
<p>In the example above, <code class="docutils literal notranslate"><span class="pre">R1</span></code> implies <code class="docutils literal notranslate"><span class="pre">R1/20130808T00</span></code>, so
<code class="docutils literal notranslate"><span class="pre">prep</span></code> only runs once at that cycle point (the initial cycle point).
At that cycle point, <code class="docutils literal notranslate"><span class="pre">foo</span></code> will have a dependence on
<code class="docutils literal notranslate"><span class="pre">prep</span></code> - but not at subsequent cycle points.</p>
<p>However, it is possible to have a workflow that has multiple effective initial
cycles - for example, one starting at <code class="docutils literal notranslate"><span class="pre">T00</span></code> and another starting
at <code class="docutils literal notranslate"><span class="pre">T12</span></code>. What if they need to share an initial task?</p>
<p>Let’s suppose that we add the following section to the workflow example above:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduler]</span>
    <span class="nv">UTC mode </span><span class="o">=</span><span class="s"> True</span>
    <span class="nv">allow implicit tasks </span><span class="o">=</span><span class="s"> True</span>
<span class="nt">[scheduling]</span>
    <span class="nv">initial cycle point </span><span class="o">=</span><span class="s"> 20130808T00</span>
    <span class="nv">final cycle point </span><span class="o">=</span><span class="s"> 20130812T00</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">R1 </span><span class="o">=</span><span class="s"> &quot;prep =&gt; foo&quot;</span>
        <span class="nv">T00 </span><span class="o">=</span><span class="s"> &quot;foo[-P1D] =&gt; foo =&gt; bar&quot;</span>
        <span class="nv">T12 </span><span class="o">=</span><span class="s"> &quot;baz[-P1D] =&gt; baz =&gt; qux&quot;</span>
</pre></div>
</div>
<p>We’ll also say that there should be a starting dependence between
<code class="docutils literal notranslate"><span class="pre">prep</span></code> and our new task <code class="docutils literal notranslate"><span class="pre">baz</span></code> - but we still want to have
a single <code class="docutils literal notranslate"><span class="pre">prep</span></code> task, at a single cycle.</p>
<p>We can write this using a special case of the <code class="docutils literal notranslate"><span class="pre">task[-interval]</span></code> syntax -
if the interval is null, this implies the task at the initial cycle point.</p>
<p>For example, we can write our workflow like so, to produce the graph as shown:</p>
<div class="twocol docutils container">
<div class="caption docutils container">
<p><em>Staggered Start Workflow</em></p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduler]</span>
    <span class="nv">UTC mode </span><span class="o">=</span><span class="s"> True</span>
    <span class="nv">allow implicit tasks </span><span class="o">=</span><span class="s"> True</span>
<span class="nt">[scheduling]</span>
    <span class="nv">initial cycle point </span><span class="o">=</span><span class="s"> 20130808T00</span>
    <span class="nv">final cycle point </span><span class="o">=</span><span class="s"> 20130812T00</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">R1 </span><span class="o">=</span><span class="s"> &quot;prep&quot;</span>
        <span class="c1"># ^ implies the initial cycle point:</span>
        <span class="nv">R1/T00 </span><span class="o">=</span><span class="s"> &quot;prep[^] =&gt; foo&quot;</span>
        <span class="c1"># ^ is initial cycle point, as above:</span>
        <span class="nv">R1/T12 </span><span class="o">=</span><span class="s"> &quot;prep[^] =&gt; baz&quot;</span>
        <span class="nv">T00 </span><span class="o">=</span><span class="s"> &quot;foo[-P1D] =&gt; foo =&gt; bar&quot;</span>
        <span class="nv">T12 </span><span class="o">=</span><span class="s"> &quot;baz[-P1D] =&gt; baz =&gt; qux&quot;</span>
</pre></div>
</div>
</div>
<div class="image docutils container">
<div class="figure align-center" id="fig-test4">
<img alt="../../_images/test4.png" src="../../_images/test4.png" />
</div>
</div>
</div>
<p>This neatly expresses what we want - a task running at the initial cycle point
that has one-off dependencies with other task sets at different cycles.</p>
<p>Cylc also caters for a different kind of requirement.</p>
<p>Usually, we want to specify additional tasks and dependencies at the initial
cycle point. What if we want our first cycle point to be entirely special,
with some tasks missing compared to subsequent cycle points?</p>
<p>In the workflow below, <code class="docutils literal notranslate"><span class="pre">bar</span></code> will not be run at the initial
cycle point, but will still run at subsequent cycle points, where
<code class="docutils literal notranslate"><span class="pre">+PT6H/PT6H</span></code> means start at <code class="docutils literal notranslate"><span class="pre">+PT6H</span></code> (6 hours after
the initial cycle point) and then repeat every <code class="docutils literal notranslate"><span class="pre">PT6H</span></code> (6 hours):</p>
<div class="twocol docutils container">
<div class="caption docutils container">
<p><em>Restricted First Cycle Point Workflow</em></p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduler]</span>
    <span class="nv">UTC mode </span><span class="o">=</span><span class="s"> True</span>
    <span class="nv">allow implicit tasks </span><span class="o">=</span><span class="s"> True</span>
<span class="nt">[scheduling]</span>
    <span class="nv">initial cycle point </span><span class="o">=</span><span class="s"> 20130808T00</span>
    <span class="nv">final cycle point </span><span class="o">=</span><span class="s"> 20130808T18</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">R1 </span><span class="o">=</span><span class="s"> &quot;setup_foo =&gt; foo&quot;</span>
        <span class="nv">+PT6H/PT6H </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            foo[-PT6H] =&gt; foo</span>
<span class="s2">            foo =&gt; bar</span>
<span class="s2">        &quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
<div class="image docutils container">
<div class="figure align-center" id="fig-test5">
<img alt="../../_images/test5.png" src="../../_images/test5.png" />
</div>
</div>
</div>
<p>Some workflows may have staggered start-up sequences where different tasks need
running once but only at specific cycle points, potentially due to differing
data sources at different cycle points with different possible initial cycle
points. To allow this Cylc provides a <code class="docutils literal notranslate"><span class="pre">min(</span> <span class="pre">)</span></code> function that can be
used as follows:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduler]</span>
    <span class="nv">UTC mode </span><span class="o">=</span><span class="s"> True</span>
    <span class="nv">allow implicit tasks </span><span class="o">=</span><span class="s"> True</span>
<span class="nt">[scheduling]</span>
    <span class="nv">initial cycle point </span><span class="o">=</span><span class="s"> 20100101T03</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">R1/min(T00,T12) </span><span class="o">=</span><span class="s"> &quot;prep1 =&gt; foo&quot;</span>
        <span class="nv">R1/min(T06,T18) </span><span class="o">=</span><span class="s"> &quot;prep2 =&gt; foo&quot;</span>
        <span class="nv">T00,T06,T12,T18 </span><span class="o">=</span><span class="s"> &quot;foo =&gt; bar&quot;</span>
</pre></div>
</div>
<p>In this example the initial cycle point is <code class="docutils literal notranslate"><span class="pre">20100101T03</span></code>, so the
<code class="docutils literal notranslate"><span class="pre">prep1</span></code> task will run once at <code class="docutils literal notranslate"><span class="pre">20100101T12</span></code> and the
<code class="docutils literal notranslate"><span class="pre">prep2</span></code> task will run once at <code class="docutils literal notranslate"><span class="pre">20100101T06</span></code> as these are
the first cycle points after the initial cycle point in the respective
<code class="docutils literal notranslate"><span class="pre">min(</span> <span class="pre">)</span></code> entries.</p>




</article>
<article class="slide level-3" id="integer-cycling">

<h3>An Integer Cycling Example<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#an-integer-cycling-example" title="View HTML">§</a></h3>

<div class="tip tutorial-ref admonition">
<p class="first admonition-title">Related Tutorial</p>
<p class="last"><a class="reference internal" href="../../tutorial/scheduling/integer-cycling.html#tutorial-integer-cycling"><span class="std std-ref">Integer Cycling Tutorial</span></a></p>
</div>
<p>In addition to non-repeating and <a class="reference internal" href="../../glossary.html#term-datetime-cycling"><span class="xref std std-term">datetime cycling</span></a> workflows, Cylc can do
<a class="reference internal" href="../../glossary.html#term-integer-cycling"><span class="xref std std-term">integer cycling</span></a> for repeating workflows that are not date-time based.</p>
<p>To construct an integer cycling workflow, set
<a class="reference internal" href="../../reference/config/workflow.html#flow.cylc[scheduling]cycling mode" title="flow.cylc[scheduling]cycling mode"><code class="xref cylc cylc-conf docutils literal notranslate"><span class="pre">[scheduling]cycling</span> <span class="pre">mode=integer</span></code></a>, and specify integer values
for the <a class="reference internal" href="../../glossary.html#term-initial-cycle-point"><span class="xref std std-term">initial cycle point</span></a> and optionally the
<a class="reference internal" href="../../glossary.html#term-final-cycle-point"><span class="xref std std-term">final cycle point</span></a>. The notation for intervals,
offsets, and <a class="reference internal" href="../../glossary.html#term-recurrence"><span class="xref std std-term">recurrences</span></a> (sequences) is similar to the
date-time cycling notation, except for the simple integer values.</p>
<p>The full integer recurrence expressions supported are:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">Rn/start-point/interval</span> <span class="pre">#</span> <span class="pre">e.g.</span> <span class="pre">R3/1/P2</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">Rn/interval/end-point</span> <span class="pre">#</span> <span class="pre">e.g.</span> <span class="pre">R3/P2/9</span></code></li>
</ul>
<p>But, as for date-time cycling, sequence start and end points can be omitted
where workflow initial and final cycle points can be assumed. Some examples:</p>
<div class="highlight-sub notranslate"><div class="highlight"><pre><span></span>R1        <span class="c"># Run once at the initial cycle point</span>
          <span class="c"># (short for R1/initial-point/?)</span>
P1        <span class="c"># Repeat with step 1 from the initial cycle point</span>
          <span class="c"># (short for R/initial-point/P1)</span>
P5        <span class="c"># Repeat with step 5 from the initial cycle point</span>
          <span class="c"># (short for R/initial-point/P5)</span>
R2//P2    <span class="c"># Run twice with step 3 from the initial cycle point</span>
          <span class="c"># (short for R2/initial-point/P2)</span>
R/+P1/P2  <span class="c"># Repeat with step 2, from 1 after the initial cycle point</span>
R2/P2     <span class="c"># Run twice with step 2, to the final cycle point</span>
          <span class="c"># (short for R2/P2/final-point)</span>
R1/P0     <span class="c"># Run once at the final cycle point</span>
          <span class="c"># (short for R1/P0/final-point)</span>
</pre></div>
</div>
<div class="section level-4" id="advanced-integer-cycling-syntax">
<p>The same syntax used to reference the initial and final cycle points
(introduced in <a class="reference internal" href="#referencing-the-initial-and-final-cycle-points"><span class="std std-ref">Referencing The Initial And Final Cycle Points</span></a>) for
use with date-time cycling can also be used for integer cycling. For
example you can write:</p>
<div class="highlight-sub notranslate"><div class="highlight"><pre><span></span>R1/^     <span class="c"># Run once at the initial cycle point</span>
R1/$     <span class="c"># Run once at the final cycle point</span>
R3/^/P2  <span class="c"># Run three times with step two starting at the</span>
                 <span class="c"># initial cycle point</span>
</pre></div>
</div>
<p>Likewise the syntax introduced in <a class="reference internal" href="#excluding-dates"><span class="std std-ref">How Multiple Graph Strings Combine</span></a> for excluding
a particular point from a recurrence also works for integer cycling. For
example:</p>
<div class="highlight-sub notranslate"><div class="highlight"><pre><span></span>R/P4!8       <span class="c"># Run with step 4, to the final cycle point but not at point 8</span>
R3/3/P2!5    <span class="c"># Run with step 2 from point 3 but not at point 5</span>
R/+P1/P6!14  <span class="c"># Run with step 6 from 1 step after the</span>
             <span class="c"># initial cycle point but not at point 14</span>
</pre></div>
</div>
<p>Multiple integer exclusions are also valid in the same way as the syntax
in <a class="reference internal" href="#excluding-dates"><span class="std std-ref">How Multiple Graph Strings Combine</span></a>. Integer exclusions may be a list of single
integer points, an integer sequence, or a combination of both:</p>
<div class="highlight-sub notranslate"><div class="highlight"><pre><span></span>R/P1!(2,3,7)  <span class="c"># Run with step 1 to the final cycle point,</span>
              <span class="c"># but not at points 2, 3, or 7.</span>
P1 ! P2       <span class="c"># Run with step 1 from the initial to final</span>
              <span class="c"># cycle point, skipping every other step from</span>
              <span class="c"># the initial cycle point.</span>
P1 ! +P1/P2   <span class="c"># Run with step 1 from the initial cycle point,</span>
              <span class="c"># excluding every other step beginning one step</span>
              <span class="c"># after the initial cycle point.</span>
P1 !(P2,6,8)  <span class="c"># Run with step 1 from the initial cycle point,</span>
              <span class="c"># excluding every other step, and also excluding</span>
              <span class="c"># steps 6 and 8.</span>
</pre></div>
</div>
</div><div class="section level-4" id="an-integer-cycling-example">
<span class="target" id="fig-integer-pipeline"></span><p>The following workflow definition, as <a class="reference internal" href="#fig-integer-pipeline"><span class="std std-ref">graphed above</span></a>,
implements a classical linear pipeline using integer cycling. The workflow
ensures that one instance each of A, B, and C runs concurrently and the
pipeline is kept full: when A.1 has finished processing the first dataset, A.2
can start on the second one at the same time as B.1 begins processing the
output of A.1, and so on. The artificial cross-cycle dependence ensures that
only one instance of A can run at a time; and similarly B and C. If available
compute resource supports more than three concurrent jobs, remove the
cross-cycle dependence and Cylc will run many cycles at once. Task runtime
configuration is omitted, but it would likely involve retrieving datasets by
cycle point and processing them in cycle point-specific shared workspaces under
the self-contained run directory.</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nv">cycling mode </span><span class="o">=</span><span class="s"> integer</span>
    <span class="nv">initial cycle point </span><span class="o">=</span><span class="s"> 1</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">R/^/P1 </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            A =&gt; B =&gt; C</span>
<span class="s2">            A[-P1] =&gt; A</span>
<span class="s2">            B[-P1] =&gt; B</span>
<span class="s2">            C[-P1] =&gt; C</span>
<span class="s2">        &quot;&quot;&quot;</span>
<span class="nt">[runtime]</span>
    <span class="nt">[[A]]</span>
        <span class="c1"># ...</span>
    <span class="nt">[[B]]</span>
        <span class="c1"># ...</span>
    <span class="nt">[[C]]</span>
        <span class="c1"># ...</span>
</pre></div>
</div>
</div>



</article>
<article class="slide level-2" id="task-triggering">

<h2>Task Triggering<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#task-triggering" title="View HTML">§</a></h2>

<p>A task is said to <a class="reference internal" href="../../glossary.html#term-trigger"><span class="xref std std-term">trigger</span></a> when it submits its job to run, as soon as all of
its dependencies (also known as its separate “triggers”) are met. Tasks can
be made to trigger off of the state of other tasks (indicated by a
<code class="docutils literal notranslate"><span class="pre">:state</span></code> <a class="reference internal" href="../../glossary.html#term-qualifier"><span class="xref std std-term">qualifier</span></a> on the upstream task (or family)
name in the graph) and, and off the clock, and arbitrary external events.</p>
<p>External triggering is relatively more complicated, and is documented
separately in <a class="reference internal" href="external-triggers.html#section-external-triggers"><span class="std std-ref">External Triggers</span></a>.</p>




</article>
<article class="slide level-3" id="success-triggers">

<h3>Success Triggers<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#success-triggers" title="View HTML">§</a></h3>

<p>The default, with no trigger type specified, is to trigger off the
upstream task succeeding:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="c1"># B triggers if A SUCCEEDS:</span>
    <span class="nv">R1 </span><span class="o">=</span><span class="s"> &quot;A =&gt; B&quot;</span>
</pre></div>
</div>
<p>For consistency and completeness, however, the success trigger can be
explicit:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="c1"># B triggers if A SUCCEEDS:</span>
    <span class="nv">R1 </span><span class="o">=</span><span class="s"> &quot;A =&gt; B&quot;</span>
<span class="c1"># or:</span>
    <span class="nv">R1 </span><span class="o">=</span><span class="s"> &quot;A:succeed =&gt; B&quot;</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="failure-triggers">

<h3>Failure Triggers<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#failure-triggers" title="View HTML">§</a></h3>

<p>To trigger off the upstream task reporting failure:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="c1"># B triggers if A FAILS:</span>
    <span class="nv">R1 </span><span class="o">=</span><span class="s"> &quot;A:fail =&gt; B&quot;</span>
</pre></div>
</div>
<p><em>Suicide triggers</em> can be used to remove task <code class="docutils literal notranslate"><span class="pre">B</span></code> here if
<code class="docutils literal notranslate"><span class="pre">A</span></code> does not fail, see <a class="reference internal" href="#suicidetriggers"><span class="std std-ref">Suicide Triggers</span></a>.</p>




</article>
<article class="slide level-3" id="start-triggers">

<h3>Start Triggers<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#start-triggers" title="View HTML">§</a></h3>

<p>To trigger off the upstream task starting to execute:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="c1"># B triggers if A STARTS EXECUTING:</span>
    <span class="nv">R1 </span><span class="o">=</span><span class="s"> &quot;A:start =&gt; B&quot;</span>
</pre></div>
</div>
<p>This can be used to trigger tasks that monitor other tasks once they
(the target tasks) start executing. Consider a long-running forecast model,
for instance, that generates a sequence of output files as it runs. A
postprocessing task could be launched with a start trigger on the model
(<code class="docutils literal notranslate"><span class="pre">model:start</span> <span class="pre">=&gt;</span> <span class="pre">post</span></code>) to process the model output as it
becomes available. Note, however, that there are several alternative
ways of handling this scenario: both tasks could be triggered at the
same time (<code class="docutils literal notranslate"><span class="pre">foo</span> <span class="pre">=&gt;</span> <span class="pre">model</span> <span class="pre">&amp;</span> <span class="pre">post</span></code>), but depending on
external queue delays this could result in the monitoring task starting
to execute first; or a different postprocessing task could be
triggered off a message output for each data file
(<code class="docutils literal notranslate"><span class="pre">model:out1</span> <span class="pre">=&gt;</span> <span class="pre">post1</span></code> etc.; see <a class="reference internal" href="#messagetriggers"><span class="std std-ref">Message Triggers</span></a>), but this
may not be practical if the
number of output files is large or if it is difficult to add Cylc
messaging calls to the model.</p>




</article>
<article class="slide level-3" id="finish-triggers">

<h3>Finish Triggers<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#finish-triggers" title="View HTML">§</a></h3>

<p>To trigger off the upstream task succeeding or failing, i.e. finishing
one way or the other:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="c1"># B triggers if A either SUCCEEDS or FAILS:</span>
    <span class="nv">R1 </span><span class="o">=</span><span class="s"> &quot;A | A:fail =&gt; B&quot;</span>
<span class="c1"># or</span>
    <span class="nv">R1 </span><span class="o">=</span><span class="s"> &quot;A:finish =&gt; B&quot;</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="message-triggers">

<h3>Message Triggers<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#message-triggers" title="View HTML">§</a></h3>

<div class="tip tutorial-ref admonition">
<p class="first admonition-title">Related Tutorial</p>
<p class="last"><a class="reference internal" href="../../tutorial/furthertopics/message-triggers.html#tutorial-cylc-message-triggers"><span class="std std-ref">Message Trigger Tutorial</span></a></p>
</div>
<p>Tasks can also trigger off custom output messages. These must be registered in
the <a class="reference internal" href="../../reference/config/workflow.html#flow.cylc[runtime][&lt;namespace&gt;][outputs]" title="flow.cylc[runtime][&lt;namespace&gt;][outputs]"><code class="xref cylc cylc-conf docutils literal notranslate"><span class="pre">[runtime][&lt;namespace&gt;][outputs]</span></code></a> section of the emitting task,
and reported using the <code class="docutils literal notranslate"><span class="pre">cylc</span> <span class="pre">message</span></code> command in task scripting.
The graph trigger notation refers to the item name of the registered
output message. An example message triggering workflow:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[meta]</span>
    <span class="nv">title </span><span class="o">=</span><span class="s"> &quot;test workflow for cylc-6 message triggers&quot;</span>

<span class="nt">[scheduling]</span>
    <span class="nv">initial cycle point </span><span class="o">=</span><span class="s"> 20140801T00</span>
    <span class="nv">final cycle point </span><span class="o">=</span><span class="s"> 20141201T00</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">P2M </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            foo:out1 =&gt; bar</span>
<span class="s2">            foo[-P2M]:out2 =&gt; baz</span>
<span class="s2">        &quot;&quot;&quot;</span>

<span class="nt">[runtime]</span>
    <span class="nt">[[foo]]</span>
        <span class="nv">script </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            sleep 5</span>
<span class="s2">            cylc message -- &quot;${CYLC_WORKFLOW_NAME}&quot; &quot;${CYLC_TASK_JOB}&quot; &quot;file 1 done&quot;</span>
<span class="s2">            sleep 10</span>
<span class="s2">            cylc message -- &quot;${CYLC_WORKFLOW_NAME}&quot; &quot;${CYLC_TASK_JOB}&quot; &quot;file 2 done&quot;</span>
<span class="s2">            sleep 10</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="nt">[[[outputs]]]</span>
            <span class="nv">out1 </span><span class="o">=</span><span class="s"> &quot;file 1 done&quot;</span>
            <span class="nv">out2 </span><span class="o">=</span><span class="s"> &quot;file 2 done&quot;</span>
    <span class="nt">[[bar, baz]]</span>
        <span class="nv">script </span><span class="o">=</span><span class="s"> sleep 10</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="job-submission-triggers">

<h3>Job Submission Triggers<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#job-submission-triggers" title="View HTML">§</a></h3>

<p>It is also possible to trigger off a task submitting, or failing to submit:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="c1"># B triggers if A submits successfully:</span>
    <span class="nv">R1 </span><span class="o">=</span><span class="s"> &quot;A:submit =&gt; B&quot;</span>
<span class="c1"># D triggers if C fails to submit successfully:</span>
    <span class="nv">R1 </span><span class="o">=</span><span class="s"> &quot;C:submit-fail =&gt; D&quot;</span>
</pre></div>
</div>
<p>A possible use case for submit-fail triggers: if a task goes into the
submit-failed state, possibly after several job submission retries,
another task that inherits the same runtime but sets a different job
submission method and/or host could be triggered to, in effect, run the
same job on a different platform.</p>




</article>
<article class="slide level-3" id="conditional-triggers">

<h3>Conditional Triggers<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#conditional-triggers" title="View HTML">§</a></h3>

<p><a class="reference internal" href="../../glossary.html#term-conditional-trigger"><span class="xref std std-term">Conditional triggers</span></a> allow the configuration of
more advanced task dependencies.</p>
<p>AND operators (<code class="docutils literal notranslate"><span class="pre">&amp;</span></code>) can appear on both sides of an arrow. They
provide a concise alternative to defining multiple triggers separately:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1/ this:</span>
    <span class="nv">R1 </span><span class="o">=</span><span class="s"> &quot;A &amp; B =&gt; C&quot;</span>
<span class="c1"># is equivalent to:</span>
    <span class="nv">R1 </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        A =&gt; C</span>
<span class="s2">        B =&gt; C</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="c1"># 2/ this:</span>
    <span class="nv">R1 </span><span class="o">=</span><span class="s"> &quot;A =&gt; B &amp; C&quot;</span>
<span class="c1"># is equivalent to:</span>
    <span class="nv">R1 </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        A =&gt; B</span>
<span class="s2">        A =&gt; C</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="c1"># 3/ and this:</span>
    <span class="nv">R1 </span><span class="o">=</span><span class="s"> &quot;A &amp; B =&gt; C &amp; D&quot;</span>
<span class="c1"># is equivalent to this:</span>
    <span class="nv">R1 </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        A =&gt; C</span>
<span class="s2">        B =&gt; C</span>
<span class="s2">        A =&gt; D</span>
<span class="s2">        B =&gt; D</span>
<span class="s2">    &quot;&quot;&quot;</span>
</pre></div>
</div>
<p>OR operators (<code class="docutils literal notranslate"><span class="pre">|</span></code>) which result in true conditional triggers,
can only appear on the left <a class="footnote-reference" href="#id6" id="id3">[1]</a> :</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="c1"># C triggers when either A or B finishes:</span>
    <span class="nv">R1 </span><span class="o">=</span><span class="s"> &quot;A | B =&gt; C&quot;</span>
</pre></div>
</div>
<p>Any valid conditional expression can be used, as shown in the graph below,
where conditional triggers are plotted with open arrow heads:</p>
<div class="twocol docutils container">
<div class="caption docutils container">
<p><em>Conditional triggers</em></p>
<div class="highlight-cylc-graph notranslate"><div class="highlight"><pre><span></span><span class="c1"># D triggers if A or (B and C) succeed</span>
<span class="kd">A</span> <span class="o">|</span> <span class="kd">B</span> <span class="o">&amp;</span> <span class="kd">C</span> <span class="o">=&gt;</span> <span class="kd">D</span>
<span class="c1"># just to align the two graph sections</span>
<span class="kd">D</span> <span class="o">=&gt;</span> <span class="kd">W</span>
<span class="c1"># Z triggers if (W or X) and Y succeed</span>
<span class="p">(</span><span class="kd">W</span><span class="o">|</span><span class="kd">X</span><span class="p">)</span> <span class="o">&amp;</span> <span class="kd">Y</span> <span class="o">=&gt;</span> <span class="kd">Z</span>
</pre></div>
</div>
</div>
<div class="image docutils container">
<div class="figure align-center" id="fig-conditional">
<img alt="../../_images/conditional-triggers.png" src="../../_images/conditional-triggers.png" />
</div>
</div>
</div>




</article>
<article class="slide level-3" id="suicide-triggers">

<h3>Suicide Triggers<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#suicide-triggers" title="View HTML">§</a></h3>

<div class="tip tutorial-ref admonition">
<p class="first admonition-title">Related Tutorial</p>
<p class="last"><a class="reference internal" href="../../tutorial/furthertopics/suicide-triggers.html#tut-cylc-suicide-triggers"><span class="std std-ref">Suicide Trigger Tutorial</span></a></p>
</div>
<p>Suicide triggers take tasks out of the workflow. This can be used for automated
failure recovery. The following <a class="reference internal" href="../../reference/config/workflow.html#flow.cylc" title="flow.cylc"><code class="xref cylc cylc-conf docutils literal notranslate"><span class="pre">flow.cylc</span></code></a> listing and accompanying
<a class="reference internal" href="../../glossary.html#term-graph"><span class="xref std std-term">graph</span></a> show how to define a chain of failure recovery tasks that trigger
if they’re needed but otherwise remove themselves from the workflow (you can run
the <em>AutoRecover.async</em> example workflow to see how this works). The dashed graph
edges ending in solid dots indicate suicide triggers, and the open arrowheads
indicate conditional triggers as usual.</p>
<div class="twocol docutils container">
<div class="caption docutils container">
<p><em>Automated failure recovery via suicide triggers</em></p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[meta]</span>
    <span class="nv">title </span><span class="o">=</span><span class="s"> automated failure recovery</span>
    <span class="nv">description </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Model task failure triggers diagnosis</span>
<span class="s2">        and recovery tasks, which take themselves</span>
<span class="s2">        out of the workflow if model succeeds. Model</span>
<span class="s2">        post processing triggers off model OR</span>
<span class="s2">        recovery tasks.</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">R1 </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            pre =&gt; model</span>
<span class="s2">            model:fail =&gt; diagnose =&gt; recover</span>
<span class="s2">            model =&gt; !diagnose &amp; !recover</span>
<span class="s2">            model | recover =&gt; post</span>
<span class="s2">        &quot;&quot;&quot;</span>
<span class="nt">[runtime]</span>
    <span class="nt">[[model]]</span>
        <span class="c1"># UNCOMMENT TO TEST FAILURE:</span>
        <span class="c1"># script = /bin/false</span>
</pre></div>
</div>
</div>
<div class="image docutils container">
<div class="figure align-center" id="fig-suicide">
<img alt="../../_images/suicide.png" src="../../_images/suicide.png" />
</div>
</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Multiple suicide triggers combine in the same way as other
triggers, so this:</p>
<div class="highlight-cylc-graph notranslate"><div class="highlight"><pre><span></span><span class="kd">foo</span> <span class="o">=&gt;</span> <span class="x">!baz</span>
<span class="kd">bar</span> <span class="o">=&gt;</span> <span class="x">!baz</span>
</pre></div>
</div>
<p>is equivalent to this:</p>
<div class="highlight-cylc-graph notranslate"><div class="highlight"><pre><span></span><span class="kd">foo</span> <span class="o">&amp;</span> <span class="kd">bar</span> <span class="o">=&gt;</span> <span class="x">!baz</span>
</pre></div>
</div>
<p>i.e. both <code class="docutils literal notranslate"><span class="pre">foo</span></code> and <code class="docutils literal notranslate"><span class="pre">bar</span></code> must succeed for
<code class="docutils literal notranslate"><span class="pre">baz</span></code> to be taken out of the workflow. If you really want a task
to be taken out if any one of several events occurs then be careful to
write it that way:</p>
<div class="last highlight-cylc-graph notranslate"><div class="highlight"><pre><span></span><span class="kd">foo</span> <span class="o">|</span> <span class="kd">bar</span> <span class="o">=&gt;</span> <span class="x">!baz</span>
</pre></div>
</div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>A word of warning on the meaning of “bare suicide triggers”. Consider
the following workflow:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">R1 </span><span class="o">=</span><span class="s"> &quot;foo =&gt; !bar&quot;</span>
</pre></div>
</div>
<p>Task <code class="docutils literal notranslate"><span class="pre">bar</span></code> has a suicide trigger but no normal prerequisites
(a suicide trigger is not a task triggering prerequisite, it is a task
removal prerequisite) so this is entirely equivalent to:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">R1 </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            foo &amp; bar</span>
<span class="s2">            foo =&gt; !bar</span>
<span class="s2">        &quot;&quot;&quot;</span>
</pre></div>
</div>
<p class="last">In other words both tasks will trigger immediately, at the same time,
and then <code class="docutils literal notranslate"><span class="pre">bar</span></code> will be removed if <code class="docutils literal notranslate"><span class="pre">foo</span></code> succeeds.</p>
</div>
<p>If an active task proxy (currently in the submitted or running states)
is removed from the workflow by a suicide trigger, a warning will be logged.</p>




</article>
<article class="slide level-3" id="family-triggers">

<h3>Family Triggers<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#family-triggers" title="View HTML">§</a></h3>

<p><a class="reference internal" href="../../glossary.html#term-family"><span class="xref std std-term">Families</span></a> defined by the namespace inheritance hierarchy
(<a class="reference internal" href="runtime.html#user-guide-runtime"><span class="std std-ref">Runtime - Task Configuration</span></a>) can be used in the graph to <a class="reference internal" href="../../glossary.html#term-trigger"><span class="xref std std-term">trigger</span></a> whole
groups of tasks at the same time (e.g. forecast model ensembles and groups of
tasks for processing different observation types at the same time) and for
triggering downstream tasks off families as a whole. Higher level families,
i.e. families of families, can also be used, and are reduced to the lowest
level member tasks.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Tasks can also trigger off individual family members if necessary.</p>
</div>
<p>To trigger an entire task family at once:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">R1 </span><span class="o">=</span><span class="s"> &quot;foo =&gt; FAM&quot;</span>
<span class="nt">[runtime]</span>
    <span class="nt">[[FAM]]</span>    <span class="c1"># a family (because others inherit from it)</span>
    <span class="nt">[[m1,m2]]</span>  <span class="c1"># family members (inherit from namespace FAM)</span>
        <span class="nv">inherit </span><span class="o">=</span><span class="s"> FAM</span>
</pre></div>
</div>
<p>This is equivalent to:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">R1 </span><span class="o">=</span><span class="s"> &quot;foo =&gt; m1 &amp; m2&quot;</span>
<span class="nt">[runtime]</span>
    <span class="nt">[[FAM]]</span>
    <span class="nt">[[m1,m2]]</span>
        <span class="nv">inherit </span><span class="o">=</span><span class="s"> FAM</span>
</pre></div>
</div>
<p>To trigger other tasks off families we have to specify whether
to triggering off <em>all members</em> starting, succeeding, failing,
or finishing, or off <em>any</em> members (doing the same). Legal family
triggers are thus:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">R1 </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
            <span class="c1"># all-member triggers:</span><span class="s2"></span>
<span class="s2">            FAM:start-all =&gt; one</span>
<span class="s2">            FAM:succeed-all =&gt; one</span>
<span class="s2">            FAM:fail-all =&gt; one</span>
<span class="s2">            FAM:finish-all =&gt; one</span>
            <span class="c1"># any-member triggers:</span><span class="s2"></span>
<span class="s2">            FAM:start-any =&gt; one</span>
<span class="s2">            FAM:succeed-any =&gt; one</span>
<span class="s2">            FAM:fail-any =&gt; one</span>
<span class="s2">            FAM:finish-any =&gt; one</span>
<span class="s2">        &quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Here’s how to trigger downstream processing after if one or more family
members succeed, but only after all members have finished (succeeded or
failed):</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">R1 </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">           FAM:finish-all &amp; FAM:succeed-any =&gt; foo</span>
<span class="s2">        &quot;&quot;&quot;</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="efficient-inter-family-triggering">

<h3>Efficient Inter-Family Triggering<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#efficient-inter-family-triggering" title="View HTML">§</a></h3>

<p>While Cylc allows writing <a class="reference internal" href="../../glossary.html#term-dependency"><span class="xref std std-term">dependencies</span></a> between two
<a class="reference internal" href="../../glossary.html#term-family"><span class="xref std std-term">families</span></a> it is important to consider the number of
dependencies this will generate. In the following example, each member of
<code class="docutils literal notranslate"><span class="pre">FAM2</span></code> has dependencies pointing at all the members of <code class="docutils literal notranslate"><span class="pre">FAM1</span></code>.</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">R1 </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            FAM1:succeed-any =&gt; FAM2</span>
<span class="s2">        &quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Expanding this out, you generate <code class="docutils literal notranslate"><span class="pre">N</span> <span class="pre">*</span> <span class="pre">M</span></code> dependencies, where <code class="docutils literal notranslate"><span class="pre">N</span></code> is the
number of members of <code class="docutils literal notranslate"><span class="pre">FAM1</span></code> and <code class="docutils literal notranslate"><span class="pre">M</span></code> is the number of members of <code class="docutils literal notranslate"><span class="pre">FAM2</span></code>.
This can result in high memory use as the number of members of these families
grows, potentially rendering the workflow impractical for running on some systems.</p>
<p>You can greatly reduce the number of dependencies generated in these situations
by putting blank tasks in the graphing to represent the state of the family you
want to trigger off. For example, if <code class="docutils literal notranslate"><span class="pre">FAM2</span></code> should trigger off any
member of <code class="docutils literal notranslate"><span class="pre">FAM1</span></code> succeeding you can create a blank task
<code class="docutils literal notranslate"><span class="pre">FAM1_succeed_any_marker</span></code> and place a dependency on it as follows:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">R1 </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            FAM1:succeed-any =&gt; FAM1_succeed_any_marker =&gt; FAM2</span>
<span class="s2">        &quot;&quot;&quot;</span>
<span class="nt">[runtime]</span>
<span class="c1"># ...</span>
    <span class="nt">[[FAM1_succeed_any_marker]]</span>
        <span class="nv">script </span><span class="o">=</span><span class="s"> true</span>
<span class="c1"># ...</span>
</pre></div>
</div>
<p>This <a class="reference internal" href="../../glossary.html#term-graph"><span class="xref std std-term">graph</span></a> generates only <code class="docutils literal notranslate"><span class="pre">N</span> <span class="pre">+</span> <span class="pre">M</span></code> dependencies, which takes
significantly less memory and CPU to store and evaluate.</p>




</article>
<article class="slide level-3" id="inter-cycle-triggers">

<h3>Inter-Cycle Triggers<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#inter-cycle-triggers" title="View HTML">§</a></h3>

<p>Typically most tasks in a workflow will trigger off others in the same
cycle point, but some may depend on others with other cycle points.
This notably applies to warm-cycled forecast models, which depend on
their own previous instances (see below); but other kinds of
<a class="reference internal" href="../../glossary.html#term-inter-cycle-dependency"><span class="xref std std-term">inter-cycle dependence</span></a> are possible too <a class="footnote-reference" href="#id7" id="id4">[2]</a> .
Here’s how to express this kind of relationship in cylc:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[[graph]]</span>
    <span class="c1"># B triggers off A in the previous cycle point</span>
    <span class="nv">PT6H </span><span class="o">=</span><span class="s"> &quot;A[-PT6H] =&gt; B&quot;</span>
</pre></div>
</div>
<p>inter-cycle and trigger type (or message trigger) notation can be
combined:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="c1"># B triggers if A in the previous cycle point fails:</span>
<span class="nv">PT6H </span><span class="o">=</span><span class="s"> &quot;A[-PT6H]:fail =&gt; B&quot;</span>
</pre></div>
</div>
<p>At workflow start-up inter-cycle triggers refer to a previous cycle point
that does not exist. This does not cause the dependent task to wait
indefinitely, however, because Cylc ignores triggers that reach back
beyond the initial cycle point. That said, the presence of an
inter-cycle trigger does normally imply that something special has to
happen at start-up. If a model depends on its own previous instance for
restart files, for instance, then an initial set of restart files has to be
generated somehow or the first model task will presumably fail with
missing input files. There are several ways to handle this in Cylc
using different kinds of one-off (non-cycling) tasks that run at workflow
start-up.</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">R1</span></code> tasks (recommended):</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">R1 </span><span class="o">=</span><span class="s"> &quot;prep&quot;</span>
        <span class="nv">R1/T00,R1/T12 </span><span class="o">=</span><span class="s"> &quot;prep[^] =&gt; foo&quot;</span>
        <span class="nv">T00,T12 </span><span class="o">=</span><span class="s"> &quot;foo[-PT12H] =&gt; foo =&gt; bar&quot;</span>
</pre></div>
</div>
</li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">R1</span></code>, or <code class="docutils literal notranslate"><span class="pre">R1/date-time</span></code> tasks are the recommended way to
specify unusual start up conditions. They allow you to specify a clean
distinction between the dependencies of initial cycles and the dependencies
of the subsequent cycles.</p>
<p>Initial tasks can be used for real model cold-start processes, whereby a
warm-cycled model at any given cycle point can in principle have its inputs
satisfied by a previous instance of itself, <em>or</em> by an initial task with
(nominally) the same cycle point.</p>
<p>In effect, the <code class="docutils literal notranslate"><span class="pre">R1</span></code> task masquerades as the previous-cycle-point trigger
of its associated cycling task. At workflow start-up initial tasks will
trigger the first cycling tasks, and thereafter the inter-cycle trigger
will take effect.</p>
<p>If a task has a dependency on another task in a different cycle point, the
dependency can be written using the <code class="docutils literal notranslate"><span class="pre">[offset]</span></code> syntax such as
<code class="docutils literal notranslate"><span class="pre">[-PT12H]</span></code> in <code class="docutils literal notranslate"><span class="pre">foo[-PT12H]</span> <span class="pre">=&gt;</span> <span class="pre">foo</span></code>. This means that
<code class="docutils literal notranslate"><span class="pre">foo</span></code> at the current cycle point depends on a previous instance of
<code class="docutils literal notranslate"><span class="pre">foo</span></code> at 12 hours before the current cycle point. Unlike recurrences
(e.g. <code class="docutils literal notranslate"><span class="pre">T00,T12</span></code>), dependencies assume that relative times are relative to the
current cycle point, not the initial cycle point.</p>
<p>However, it can be useful to have specific dependencies on tasks at or near
the initial cycle point. You can switch the context of the offset to be
the initial cycle point by using the caret symbol: <code class="docutils literal notranslate"><span class="pre">^</span></code>.</p>
<p>For example, you can write <code class="docutils literal notranslate"><span class="pre">foo[^]</span></code> to mean foo at the initial
cycle point, and <code class="docutils literal notranslate"><span class="pre">foo[^+PT6H]</span></code> to mean foo 6 hours after the initial
cycle point. Usually, this kind of dependency will only apply in a limited
number of cycle points near the start of the workflow, so you may want to write
it in <code class="docutils literal notranslate"><span class="pre">R1</span></code>-based graphs. Here’s the example inter-cycle
<code class="docutils literal notranslate"><span class="pre">R1</span></code> workflow from above again.</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">R1 </span><span class="o">=</span><span class="s"> &quot;prep&quot;</span>
        <span class="nv">R1/T00,R1/T12 </span><span class="o">=</span><span class="s"> &quot;prep[^] =&gt; foo&quot;</span>
        <span class="nv">T00,T12 </span><span class="o">=</span><span class="s"> &quot;foo[-PT12H] =&gt; foo =&gt; bar&quot;</span>
</pre></div>
</div>
<p>You can see there is a dependence on the initial <code class="docutils literal notranslate"><span class="pre">R1</span></code> task
<code class="docutils literal notranslate"><span class="pre">prep</span></code> for <code class="docutils literal notranslate"><span class="pre">foo</span></code> at the first <code class="docutils literal notranslate"><span class="pre">T00</span></code> cycle point,
and at the first <code class="docutils literal notranslate"><span class="pre">T12</span></code> cycle point. Thereafter, <code class="docutils literal notranslate"><span class="pre">foo</span></code> just
depends on its previous (12 hours ago) instance.</p>
<p>Finally, it is also possible to have a dependency on a task at a specific cycle
point.</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">R1/20200202 </span><span class="o">=</span><span class="s"> &quot;baz[20200101] =&gt; qux&quot;</span>
</pre></div>
</div>
<p>However, in a long running workflow, a repeating cycle should avoid having a
dependency on a task with a specific cycle point (including the initial cycle
point) - as it can currently cause performance issue. In the following example,
all instances of <code class="docutils literal notranslate"><span class="pre">qux</span></code> will depend on <code class="docutils literal notranslate"><span class="pre">baz.20200101</span></code>, which
will never be removed from the task pool:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nv">initial cycle point </span><span class="o">=</span><span class="s"> 2010</span>
    <span class="nt">[[graph]]</span>
        <span class="c1"># Can cause performance issue!</span>
        <span class="nv">P1D </span><span class="o">=</span><span class="s"> &quot;baz[20200101] =&gt; qux&quot;</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="special-sequential-tasks">

<h3>Special Sequential Tasks<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#special-sequential-tasks" title="View HTML">§</a></h3>

<p>Tasks that depend on their own previous-cycle instance can be declared as
<em>sequential</em>:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[special tasks]]</span>
        <span class="c1"># foo depends on its previous instance:</span>
        <span class="nv">sequential </span><span class="o">=</span><span class="s"> foo</span>  <span class="c1"># deprecated - see below!</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">T00,T12 </span><span class="o">=</span><span class="s"> &quot;foo =&gt; bar&quot;</span>
</pre></div>
</div>
<p><em>The sequential declaration is deprecated</em> however, in favor of explicit
inter-cycle triggers which clearly expose the same scheduling behaviour in the
graph:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="c1"># foo depends on its previous instance:</span>
        <span class="nv">T00,T12 </span><span class="o">=</span><span class="s"> &quot;foo[-PT12H] =&gt; foo =&gt; bar&quot;</span>
</pre></div>
</div>
<p>The sequential declaration is arguably convenient in one unusual situation
though: if a task has a non-uniform cycling sequence then multiple explicit
triggers,</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">T00,T03,T11 </span><span class="o">=</span><span class="s"> &quot;foo =&gt; bar&quot;</span>
        <span class="nv">T00 </span><span class="o">=</span><span class="s"> &quot;foo[-PT13H] =&gt; foo&quot;</span>
        <span class="nv">T03 </span><span class="o">=</span><span class="s"> &quot;foo[-PT3H] =&gt; foo&quot;</span>
        <span class="nv">T11 </span><span class="o">=</span><span class="s"> &quot;foo[-PT8H] =&gt; foo&quot;</span>
</pre></div>
</div>
<p>can be replaced by a single sequential declaration,</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[special tasks]]</span>
        <span class="nv">sequential </span><span class="o">=</span><span class="s"> foo</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">T00,T03,T11 </span><span class="o">=</span><span class="s"> &quot;foo =&gt; bar&quot;</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="future-triggers">

<h3>Future Triggers<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#future-triggers" title="View HTML">§</a></h3>

<p>Cylc also supports term:<cite>inter-cycle triggering &lt;inter-cycle trigger&gt;</cite> off
tasks “in the future” (with respect to cycle point - which has no bearing on
wall-clock job submission time unless the task has a clock trigger):</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[[graph]]</span>
    <span class="nv">T00,T06,T12,T18 </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
        <span class="c1"># A runs in this cycle:</span><span class="s2"></span>
<span class="s2">        A</span>
        <span class="c1"># B in this cycle triggers off A in the next cycle.</span><span class="s2"></span>
<span class="s2">        A[PT6H] =&gt; B</span>
<span class="s2">    &quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Future triggers present a problem at workflow shutdown rather than at start-up.
Here, <code class="docutils literal notranslate"><span class="pre">B</span></code> at the final cycle point wants to trigger off an instance
of <code class="docutils literal notranslate"><span class="pre">A</span></code> that will never exist because it is beyond the workflow stop
point. Consequently Cylc prevents tasks from spawning successors that depend on
other tasks beyond the final point.</p>




</article>
<article class="slide level-3" id="clock-triggers">

<h3>Clock Triggers<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#clock-triggers" title="View HTML">§</a></h3>

<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Please read External Triggers (<a class="reference internal" href="external-triggers.html#section-external-triggers"><span class="std std-ref">External Triggers</span></a>) before
using the older clock triggers described in this section.</p>
</div>
<p>By default, date-time cycle points are not connected to the real time
(the <a class="reference internal" href="../../glossary.html#term-wall-clock-time"><span class="xref std std-term">wall-clock time</span></a>).
They are just labels that are passed to task jobs (e.g. to
initialize an atmospheric model run with a particular date-time value). In real
time cycling systems, however, some tasks - typically those near the top of the
graph in each cycle - need to trigger at or near the time when their cycle point
is equal to the real clock date-time.</p>
<p>So <em>clock triggers</em> allow tasks to trigger at (or after, depending on other
triggers) a wall clock time expressed as an offset from cycle point:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[special tasks]]</span>
        <span class="nv">clock-trigger </span><span class="o">=</span><span class="s"> foo(PT2H)</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">T00 </span><span class="o">=</span><span class="s"> foo</span>
</pre></div>
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">foo[2015-08-23T00]</span></code> would trigger (other dependencies allowing)
when the wall clock time reaches <code class="docutils literal notranslate"><span class="pre">2015-08-23T02</span></code>. Clock-trigger
offsets are normally positive, to trigger some time <em>after</em> the wall-clock
time is equal to task cycle point.</p>
<p>Clock-triggers have no effect on scheduling if a workflow is running sufficiently
far behind the clock (e.g. after a delay, or because it is processing archived
historical data) that the trigger times, which are relative to task cycle
point, have already passed.</p>




</article>
<article class="slide level-3" id="clock-expire-triggers">

<h3>Clock-Expire Triggers<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#clock-expire-triggers" title="View HTML">§</a></h3>

<p>Tasks can be configured to <em>expire</em> - i.e. to skip job submission and
enter the <em>expired</em> state - if they are too far behind the wall clock when
they become ready to run, and other tasks can trigger off this. As a possible
use case, consider a cycling task that copies the latest of a set of files to
overwrite the previous set: if the task is delayed by more than one cycle there
may be no point in running it because the freshly copied files will just be
overwritten immediately by the next task instance as the workflow catches back up
to real time operation. Clock-expire tasks are configured with
<a class="reference internal" href="../../reference/config/workflow.html#flow.cylc[scheduling][special tasks]clock-expire" title="flow.cylc[scheduling][special tasks]clock-expire"><code class="xref cylc cylc-conf docutils literal notranslate"><span class="pre">[scheduling][special</span> <span class="pre">tasks]clock-expire</span></code></a> using a syntax like
<a class="reference internal" href="../../reference/config/workflow.html#flow.cylc[scheduling][special tasks]clock-trigger" title="flow.cylc[scheduling][special tasks]clock-trigger"><code class="xref cylc cylc-conf docutils literal notranslate"><span class="pre">clock-trigger</span></code></a>
with a date-time offset relative to cycle point.
The offset should be positive to make the task expire if the wall-clock time
has gone beyond the cycle point. Triggering off an expired task typically
requires suicide triggers to remove the workflow that runs if the task has not
expired. Here a task called <code class="docutils literal notranslate"><span class="pre">copy</span></code> expires, and its downstream
workflow is skipped, if it is more than one day behind the wall-clock:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduler]</span>
   <span class="nv">allow implicit tasks </span><span class="o">=</span><span class="s"> True</span>
   <span class="nv">cycle point format </span><span class="o">=</span><span class="s"> %Y-%m-%dT%H</span>
<span class="nt">[scheduling]</span>
    <span class="nv">initial cycle point </span><span class="o">=</span><span class="s"> 2015-08-15T00</span>
    <span class="nt">[[special tasks]]</span>
        <span class="nv">clock-expire </span><span class="o">=</span><span class="s"> copy(-P1D)</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">P1D </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            model[-P1D] =&gt; model =&gt; copy =&gt; proc</span>
<span class="s2">            copy:expired =&gt; !proc</span>
<span class="s2">        &quot;&quot;&quot;</span>
</pre></div>
</div>




</article>
<article class="slide level-3" id="external-triggers">

<h3>External Triggers<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#external-triggers" title="View HTML">§</a></h3>

<p>This is a substantial topic, documented in <a class="reference internal" href="external-triggers.html#section-external-triggers"><span class="std std-ref">External Triggers</span></a>.</p>




</article>
<article class="slide level-2" id="graph-branching">

<h2>Graph Branching<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#graph-branching" title="View HTML">§</a></h2>

<div class="versionadded">
<p><span class="versionmodified added">New in version 8.0.0.</span></p>
</div>
<p>Cylc handles <a class="reference internal" href="../../glossary.html#term-graph"><span class="xref std std-term">graphs</span></a> in an event-driven manner which means
that a workflow can follow different paths in different eventualities.
This is called <a class="reference internal" href="../../glossary.html#term-branching"><span class="xref std std-term">branching</span></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Before Cylc 8 graphs were not event-driven so
<a class="reference internal" href="../../glossary.html#term-suicide-trigger"><span class="xref std std-term">suicide triggers</span></a>
were used to allow the graph to evolve at runtime.</p>
</div>




</article>
<article class="slide level-3" id="basic-example">

<h3>Basic Example<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#basic-example" title="View HTML">§</a></h3>

<p>In this example Cylc will follow one of two possible “branches” depending
on the outcome of task <code class="docutils literal notranslate"><span class="pre">b</span></code>:</p>
<ul class="simple">
<li>If <code class="docutils literal notranslate"><span class="pre">b</span></code> succeeds then the task <code class="docutils literal notranslate"><span class="pre">c</span></code> will run.</li>
<li>If <code class="docutils literal notranslate"><span class="pre">b</span></code> fails then the task <code class="docutils literal notranslate"><span class="pre">r</span></code> will run.</li>
</ul>
<p>Task <code class="docutils literal notranslate"><span class="pre">d</span></code> will run after either <code class="docutils literal notranslate"><span class="pre">c</span></code> or <code class="docutils literal notranslate"><span class="pre">r</span></code> succeeds.</p>
<div align="center" class="align-center"><div class="graphviz"><object data="../../_images/graphviz-49ba9b997629895dcb4de0b35f149b3287affd13.svg" type="image/svg+xml" class="graphviz">
<p class="warning">digraph example {
subgraph cluster_success {
   label = &quot;:succeed&quot;
   color = &quot;green&quot;
   fontcolor = &quot;green&quot;
   style = &quot;dashed&quot;

   c
}

subgraph cluster_failure {
   label = &quot;:fail&quot;
   color = &quot;red&quot;
   fontcolor = &quot;red&quot;
   style = &quot;dashed&quot;

   r
}

a -&gt; b -&gt; c -&gt; d
b -&gt; r -&gt; d
}</p></object></div>
</div>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">R1 </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
            <span class="c1"># the success path</span><span class="s2"></span>
<span class="s2">            a =&gt; b =&gt; c</span>
            <span class="c1"># the fail path</span><span class="s2"></span>
<span class="s2">            a =&gt; b:fail =&gt; r</span>
            <span class="c1"># carrying on with the rest of the workflow</span><span class="s2"></span>
<span class="s2">            c | r =&gt; d</span>
<span class="s2">        &quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Note the last line of the graph <code class="docutils literal notranslate"><span class="pre">c</span> <span class="pre">|</span> <span class="pre">r</span> <span class="pre">=&gt;</span> <span class="pre">d</span></code> which allows the graph to
continue on to <code class="docutils literal notranslate"><span class="pre">d</span></code> irrespective of which path has been taken.</p>




</article>
<article class="slide level-3" id="message-trigger-example">

<h3>Message Trigger Example<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#message-trigger-example" title="View HTML">§</a></h3>

<p>Branching is particularly powerful when combined with <a class="reference internal" href="#messagetriggers"><span class="std std-ref">Message Triggers</span></a>,
here is an example showing how message triggers can be used to define multiple
parallel pathways.</p>
<p>In this graph there is a task called <code class="docutils literal notranslate"><span class="pre">showdown</span></code> which produces one of three
possible custom outputs, <code class="docutils literal notranslate"><span class="pre">good</span></code>, <code class="docutils literal notranslate"><span class="pre">bad</span></code> or <code class="docutils literal notranslate"><span class="pre">ugly</span></code>. Cylc will follow
a different path depending on which of these three outputs is produced:</p>
<div align="center" class="align-center"><div class="graphviz"><object data="../../_images/graphviz-84db4e14a47d0eb83d1dbd618995d024c7e19b61.svg" type="image/svg+xml" class="graphviz">
<p class="warning">digraph Example {
subgraph cluster_1 {
   label = &quot;:good&quot;
   color = &quot;green&quot;
   fontcolor = &quot;green&quot;
   style = &quot;dashed&quot;
   good
}
subgraph cluster_2 {
   label = &quot;:bad&quot;
   color = &quot;red&quot;
   fontcolor = &quot;red&quot;
   style = &quot;dashed&quot;
   bad
}
subgraph cluster_3 {
   label = &quot;:ugly&quot;
   color = &quot;purple&quot;
   fontcolor = &quot;purple&quot;
   style = &quot;dashed&quot;
   ugly
}
showdown -&gt; good
showdown -&gt; bad
showdown -&gt; ugly
good -&gt; fin [arrowhead=&quot;onormal&quot;]
bad -&gt; fin [arrowhead=&quot;onormal&quot;]
ugly -&gt; fin [arrowhead=&quot;onormal&quot;]
}</p></object></div>
</div>
<p>As with the previous example each path begins with a different outcome
of a particular task and ends with an “or” dependency to allow the workflow
to continue irrespective of which path was taken:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">R1 </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">           showdown</span>
<span class="s2">           showdown:good =&gt; good</span>
<span class="s2">           showdown:bad =&gt; bad</span>
<span class="s2">           showdown:ugly =&gt; ugly</span>
<span class="s2">           good | bad | ugly =&gt; fin</span>
<span class="s2">        &quot;&quot;&quot;</span>

<span class="nt">[runtime]</span>
    <span class="nt">[[root]]</span>
        <span class="nv">script </span><span class="o">=</span><span class="s"> sleep 1</span>
    <span class="nt">[[showdown]]</span>
        <span class="c1"># Randomly return one of the three custom outputs.</span>
        <span class="nv">script </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            SEED=$RANDOM</span>
<span class="s2">            if ! (( $SEED % 3 )); then</span>
<span class="s2">                cylc message &#39;The-Good&#39;</span>
<span class="s2">            elif ! (( ( $SEED + 1 ) % 3 )); then</span>
<span class="s2">                cylc message &#39;The-Bad&#39;</span>
<span class="s2">            else</span>
<span class="s2">                cylc message &#39;The-Ugly&#39;</span>
<span class="s2">            fi</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="nt">[[[outputs]]]</span>
            <span class="c1"># Register the three custom outputs with cylc.</span>
            <span class="nv">good </span><span class="o">=</span><span class="s"> &#39;The-Good&#39;</span>
            <span class="nv">bad </span><span class="o">=</span><span class="s"> &#39;The-Bad&#39;</span>
            <span class="nv">ugly </span><span class="o">=</span><span class="s"> &#39;The-Ugly&#39;</span>
</pre></div>
</div>
<p>When using message triggers in this way there are two things to be aware of:</p>
<ol class="arabic">
<li><p class="first">Message triggers are not exit states.</p>
<p>Message triggers are produced <code class="docutils literal notranslate"><span class="pre">before</span></code> a task has completed, consequently,
it can be useful to combine a message trigger with a regular trigger for
safety e.g:</p>
<div class="highlight-cylc-graph notranslate"><div class="highlight"><pre><span></span><span class="c1"># good will wait for showdown to finish before running</span>
<span class="kd">showdown</span><span class="c">:</span><span class="kd">finish</span> <span class="o">&amp;</span> <span class="kd">showdown</span><span class="c">:</span><span class="kd">good</span> <span class="o">=&gt;</span> <span class="kd">good</span>

<span class="c1"># if showdown fails then good will not run</span>
<span class="kd">showdown</span><span class="c">:</span><span class="kd">succeed</span> <span class="o">&amp;</span> <span class="kd">showdown</span><span class="c">:</span><span class="kd">good</span> <span class="o">=&gt;</span> <span class="kd">good</span>
</pre></div>
</div>
</li>
<li><p class="first">Message triggers are not mutually exclusive.</p>
<p>There is nothing in Cylc to prevent a task from producing multiple outputs
e.g. <code class="docutils literal notranslate"><span class="pre">good</span></code>, <code class="docutils literal notranslate"><span class="pre">bad</span></code> and <code class="docutils literal notranslate"><span class="pre">ugly</span></code>.</p>
<p>This is hard to defend against, ensure that the task that produces these
outputs is written in such a way that this cannot happen.</p>
</li>
</ol>




</article>
<article class="slide level-2" id="model-restart-dependencies">

<h2>Model Restart Dependencies<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#model-restart-dependencies" title="View HTML">§</a></h2>

<p>Warm-cycled forecast models generate <em>restart files</em>, e.g. model
background fields, to initialize the next forecast. This kind of
dependence requires an inter-cycle trigger:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">T00,T06,T12,T18 </span><span class="o">=</span><span class="s"> &quot;A[-PT6H] =&gt; A&quot;</span>
</pre></div>
</div>
<p>If your model is configured to write out additional restart files
to allow one or more cycle points to be skipped in an emergency <em>do not
represent these potential dependencies in the workflow graph</em> as they
should not be used under normal circumstances. For example, the
following graph would result in task <code class="docutils literal notranslate"><span class="pre">A</span></code> erroneously
triggering off <code class="docutils literal notranslate"><span class="pre">A[T-24]</span></code> as a matter of course, instead of
off <code class="docutils literal notranslate"><span class="pre">A[T-6]</span></code>, because <code class="docutils literal notranslate"><span class="pre">A[T-24]</span></code> will always
be finished first:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="c1"># DO NOT DO THIS (SEE ACCOMPANYING TEXT):</span>
        <span class="nv">T00,T06,T12,T18 </span><span class="o">=</span><span class="s"> &quot;A[-PT24H] | A[-PT18H] | A[-PT12H] | A[-PT6H] =&gt; A&quot;</span>
</pre></div>
</div>




</article>
<article class="slide level-2" id="how-the-graph-determines-task-instantiation">

<h2>How The Graph Determines Task Instantiation<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#how-the-graph-determines-task-instantiation" title="View HTML">§</a></h2>

<p>A graph trigger pair like <code class="docutils literal notranslate"><span class="pre">foo</span> <span class="pre">=&gt;</span> <span class="pre">bar</span></code> determines the existence and
prerequisites (dependencies) of the downstream task <code class="docutils literal notranslate"><span class="pre">bar</span></code>, for
the cycle points defined by the associated graph section heading. In general it
does not say anything about the dependencies or existence of the upstream task
<code class="docutils literal notranslate"><span class="pre">foo</span></code>. However <em>if the trigger has no cycle point offset</em> Cylc
will infer that <code class="docutils literal notranslate"><span class="pre">bar</span></code> must exist at the same cycle points as
<code class="docutils literal notranslate"><span class="pre">foo</span></code>. This is a convenience to allow this:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nv">R1 </span><span class="o">=</span><span class="s"> &quot;foo =&gt; bar&quot;</span>
</pre></div>
</div>
<p>to be written as shorthand for this:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nv">R1 </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    foo</span>
<span class="s2">    foo =&gt; bar</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>(where <code class="docutils literal notranslate"><span class="pre">foo</span></code> by itself means <code class="docutils literal notranslate"><span class="pre">&lt;nothing&gt;</span> <span class="pre">=&gt;</span> <span class="pre">foo</span></code>, i.e. the
task exists at these cycle points but has no prerequisites - although other
prerequisites may be defined for it in other parts of the graph).</p>
<p><em>Cylc does not infer the existence of the upstream task in offset
triggers</em> like <code class="docutils literal notranslate"><span class="pre">foo[-P1D]</span> <span class="pre">=&gt;</span> <span class="pre">bar</span></code> because a typo in the offset
interval should generate an error rather than silently creating
tasks on an erroneous cycling sequence.</p>
<p>As a result you need to be careful not to define inter-cycle dependencies that
cannot be satisfied at run time. Workflow validation catches this kind of error if
the existence of the cycle offset task is not defined anywhere at all:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nv">initial cycle point </span><span class="o">=</span><span class="s"> 2020</span>
    <span class="nt">[[graph]]</span>
        <span class="c1"># ERROR</span>
        <span class="nv">P1Y </span><span class="o">=</span><span class="s"> &quot;foo[-P1Y] =&gt; bar&quot;</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cylc validate WORKFLOW
<span class="go">&#39;ERROR: No cycling sequences defined for foo&#39;</span>
</pre></div>
</div>
<p>To fix this, use another line in the graph to tell Cylc to define
<code class="docutils literal notranslate"><span class="pre">foo</span></code> at each cycle point:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nv">initial cycle point </span><span class="o">=</span><span class="s"> 2020</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">P1Y </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            foo</span>
<span class="s2">            foo[-P1Y] =&gt; bar</span>
<span class="s2">        &quot;&quot;&quot;</span>
</pre></div>
</div>
<p>But validation does not catch this kind of error if the offset task
is defined only on a different cycling sequence:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nv">initial cycle point </span><span class="o">=</span><span class="s"> 2020</span>
    <span class="nt">[[graph]]</span>
        <span class="c1"># ERROR</span>
        <span class="nv">P2Y </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            foo</span>
<span class="s2">            foo[-P1Y] =&gt; bar</span>
<span class="s2">        &quot;&quot;&quot;</span>
</pre></div>
</div>
<p>This workflow will validate OK, but it will stall at runtime with <code class="docutils literal notranslate"><span class="pre">bar</span></code>
waiting on <code class="docutils literal notranslate"><span class="pre">foo[-P1Y]</span></code> at the intermediate years where it does not
exist. The offset <code class="docutils literal notranslate"><span class="pre">[-P1Y]</span></code> is presumably an error (it should be
<code class="docutils literal notranslate"><span class="pre">[-P2Y]</span></code>), or else another graph line is needed to generate
<code class="docutils literal notranslate"><span class="pre">foo</span></code> instances on the yearly sequence:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nv">initial cycle point </span><span class="o">=</span><span class="s"> 2020</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">P1Y </span><span class="o">=</span><span class="s"> &quot;foo&quot;</span>
        <span class="nv">P2Y </span><span class="o">=</span><span class="s"> &quot;foo[-P1Y] =&gt; bar&quot;</span>
</pre></div>
</div>
<p>Similarly the following workflow will validate OK, but it will stall at
runtime with <code class="docutils literal notranslate"><span class="pre">bar</span></code> waiting on <code class="docutils literal notranslate"><span class="pre">foo[-P1Y]</span></code> in
every cycle point, when only a single instance of it exists, at the initial
cycle point:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nv">initial cycle point </span><span class="o">=</span><span class="s"> 2020</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">R1 </span><span class="o">=</span><span class="s"> foo</span>
        <span class="c1"># ERROR</span>
        <span class="nv">P1Y </span><span class="o">=</span><span class="s"> foo[-P1Y] =&gt; bar</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">cylc</span> <span class="pre">graph</span></code> will display un-satisfiable inter-cycle
dependencies as “ghost nodes”, as illustrated in this
screenshot of cylc graph displaying the above example with the
un-satisfiable task (foo) displayed as a “ghost node”.</p>
<div class="last figure align-center" id="id8">
<span id="ghost-node-screenshot"></span><img alt="../../_images/ghost-node-example.png" src="../../_images/ghost-node-example.png" />
<p class="caption"><span class="caption-text">Screenshot of <code class="docutils literal notranslate"><span class="pre">cylc</span> <span class="pre">graph</span></code> showing one task as a “ghost node”.</span></p>
</div>
</div>




</article>
<article class="slide level-2" id="omitting-tasks-at-runtime">

<h2>Omitting Tasks At Runtime<a class="headerlink" href="../../../html/user-guide/writing-workflows/scheduling.html#omitting-tasks-at-runtime" title="View HTML">§</a></h2>

<p>It is sometimes convenient to omit certain tasks from the workflow at
runtime without actually deleting their definitions from the workflow.</p>
<p>Defining <a class="reference internal" href="../../reference/config/workflow.html#flow.cylc[runtime]" title="flow.cylc[runtime]"><code class="xref cylc cylc-conf docutils literal notranslate"><span class="pre">[runtime]</span></code></a> properties for tasks that do not appear
in the workflow graph results in verbose-mode validation warnings that the
tasks are disabled. They cannot be used because the workflow graph is what
defines their dependencies and valid cycle points. Nevertheless, it is
legal to leave these orphaned runtime sections in the workflow
configuration because it allows you to temporarily remove tasks from
the workflow by commenting them out of the graph.</p>
<p>With Jinja2 (<a class="reference internal" href="jinja2.html#user-guide-jinja2"><span class="std std-ref">Jinja2</span></a>) you can radically alter
workflow structure by including or excluding tasks from the
<a class="reference internal" href="../../reference/config/workflow.html#flow.cylc[scheduling]" title="flow.cylc[scheduling]"><code class="xref cylc cylc-conf docutils literal notranslate"><span class="pre">[scheduling]</span></code></a> and <a class="reference internal" href="../../reference/config/workflow.html#flow.cylc[runtime]" title="flow.cylc[runtime]"><code class="xref cylc cylc-conf docutils literal notranslate"><span class="pre">[runtime]</span></code></a> sections according to the
value of a single logical flag defined at the top of the workflow.</p>
<table class="docutils footnote" frame="void" id="id6" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[1]</a></td><td>An OR operator on the right doesn’t make much sense: if “B or C”
triggers off A, what exactly should Cylc do when A finishes?</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id7" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[2]</a></td><td>In NWP forecast analysis workflows parts of the observation
processing and data assimilation subsystem will typically also
depend on model background fields generated by the previous forecast.</td></tr>
</tbody>
</table>




</article>

</section>

<section id="slide_notes">

</section>

  </body>
</html>


<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>External Triggers &mdash; Cylc 8.5.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=47202671" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/diff_selector.css?v=9704a72b" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/grid_table.css?v=0285b42e" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/hieroglyph_theme_addons.css?v=814c2015" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/tutorial.css?v=b869d33c" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/addons.css?v=d1f804c3" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=0fad80e6" />

  
    <link rel="shortcut icon" href="../../_static/cylc-favicon.ico"/>
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=3fea0a2f"></script>
      <script src="../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/js/diff_selector.js?v=3109bfa4"></script>
      <script src="../../_static/js/minicylc.js?v=ddc882fd"></script>
      <script src="../../_static/js/spoiler.js?v=12631137"></script>
      <script src="../../_static/js/addons.js?v=39bd7dee"></script>
      <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Suicide Triggers" href="suicide-triggers.html" />
    <link rel="prev" title="Jinja2" href="jinja2.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/cylc-logo-white.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../7-to-8/index.html">Cylc 8 Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/index.html">Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Writing Workflows</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="configuration.html">Workflow Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="scheduling.html">Scheduling Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="runtime.html">Task Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="parameterized-tasks.html">Task Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="jinja2.html">Jinja2</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">External Triggers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#xtriggers-pull">Xtriggers (pull)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ext-triggers-push">Ext-Triggers (push)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#workflow-state-polling-old-style">Workflow State Polling (old style)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="suicide-triggers.html">Suicide Triggers</a></li>
<li class="toctree-l3"><a class="reference internal" href="scheduler.html">Scheduler Configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../installing-workflows.html">Installing Workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../running-workflows/index.html">Running Workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../task-implementation/index.html">Task Implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interventions/index.html">Interventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../removing-workflows.html">Removing Workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cheat-sheet.html">Cheat Sheet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/index.html">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting.html">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../plugins/index.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../workflow-design-guide/index.html">Workflow Design Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/index.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Cylc</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">User Guide</a></li>
          <li class="breadcrumb-item"><a href="index.html">Writing Workflows</a></li>
      <li class="breadcrumb-item active">External Triggers</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/user-guide/writing-workflows/external-triggers.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="external-triggers">
<span id="section-external-triggers"></span><h1>External Triggers<a class="headerlink" href="#external-triggers" title="Link to this heading"></a></h1>
<p>Cylc <a class="reference internal" href="../../glossary.html#term-dependency"><span class="xref std std-term">dependencies</span></a> allow us to trigger tasks off of
events/outputs created within the workflow.</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="c1"># &quot;bar&quot; will wait until &quot;foo&quot; has succeeded</span>
        <span class="nv">P1D = foo:succeeded </span><span class="o">=</span><span class="c">&gt;</span> <span class="kd">bar</span>
</pre></div>
</div>
<p>External triggers allow us to trigger tasks off of events that are external
to the workflow itself, for example the real-world time (aka wallclock time),
the arrival of a data set, or the completion of tasks in other workflows.</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="c1"># &quot;bar&quot; will wait until the real-world time matches the cycle point</span>
        <span class="nv">P1D = @wall_clock </span><span class="o">=</span><span class="c">&gt;</span> <span class="kd">bar</span>
</pre></div>
</div>
<p>Cylc provides two mechanisms for implementing external triggers in a workflow:</p>
<dl class="simple">
<dt><a class="reference internal" href="#user-guide-xtriggers"><span class="std std-ref">Xtriggers (pull)</span></a>:</dt><dd><p>These are Python functions that are routinely “polled” until a condition
is satisfied.</p>
</dd>
<dt><a class="reference internal" href="#user-guide-ext-triggers"><span class="std std-ref">Ext-triggers (push)</span></a>:</dt><dd><p>These are commands that send messages to the <a class="reference internal" href="../../glossary.html#term-scheduler"><span class="xref std std-term">scheduler</span></a> once a
condition has been satisfied.</p>
</dd>
</dl>
<section id="xtriggers-pull">
<span id="user-guide-xtriggers"></span><h2>Xtriggers (pull)<a class="headerlink" href="#xtriggers-pull" title="Link to this heading"></a></h2>
<p>Xtriggers allow tasks to trigger off of arbitrary external conditions. The
<a class="reference internal" href="../../glossary.html#term-scheduler"><span class="xref std std-term">scheduler</span></a> periodically calls a Python function, to check on the
condition, until it returns success to satisfy dependent tasks.</p>
<p>You can write <a class="reference internal" href="#custom-trigger-functions"><span class="std std-ref">Custom Xtrigger Functions</span></a>, and Cylc has several built in:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#built-in-clock-triggers"><span class="std std-ref">Clock xtriggers</span></a> - real time trigger relative to task cycle point</p></li>
<li><p><a class="reference internal" href="#built-in-workflow-state-triggers"><span class="std std-ref">Workflow state xtriggers</span></a> - trigger off tasks in other workflows</p></li>
<li><p><a class="reference internal" href="#built-in-toy-xtriggers"><span class="std std-ref">Toy xtriggers</span></a> - to facilitate understanding</p></li>
</ul>
<section id="periodic-checking">
<h3>Periodic Checking<a class="headerlink" href="#periodic-checking" title="Link to this heading"></a></h3>
<p>Xtrigger calls commence when the first dependent task enters the
<a class="reference internal" href="../../glossary.html#term-active-window"><span class="xref std std-term">active window</span></a>, repeating at configurable intervals until success
is achieved. The default call interval is 10 seconds.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The xtrigger prerequisites of future tasks that have yet to enter the
<a class="reference internal" href="../../glossary.html#term-active-window"><span class="xref std std-term">active window</span></a>, will always show as unsatisfied because the
associated xtrigger function has not been called yet.</p>
</div>
<p>The scheduler satisfies future tasks when they enter the active window, if
they depend on the same xtrigger, without calling the function again - see
<a class="reference internal" href="#user-guide-xtriggers-specificity"><span class="std std-ref">xtrigger Specificity</span></a>.</p>
<p>Xtriggers must return quickly, or be killed by the
<a class="reference internal" href="../../reference/config/global.html#global.cylc[scheduler]process pool timeout" title="global.cylc[scheduler]process pool timeout"><code class="xref cylc cylc-conf docutils literal notranslate"><span class="pre">global.cylc[scheduler]process</span> <span class="pre">pool</span> <span class="pre">timeout</span></code></a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Each xtrigger call is made in a new Python subprocess. Consider increasing the
call interval if you have many xtriggers, to reduce the associated system load.</p>
</div>
</section>
<section id="declaring-xtriggers">
<h3>Declaring Xtriggers<a class="headerlink" href="#declaring-xtriggers" title="Link to this heading"></a></h3>
<p>Xtriggers are declared under <a class="reference internal" href="../../reference/config/workflow.html#flow.cylc[scheduling][xtriggers]" title="flow.cylc[scheduling][xtriggers]"><code class="xref cylc cylc-conf docutils literal notranslate"><span class="pre">flow.cylc[scheduling][xtriggers]</span></code></a>
by associating a short <em>label</em> with a function name, arguments, and optional
custom check interval.</p>
<p>The label must be prefixed by “&#64;” for use in the graph, and must comply with
basic naming rules:</p>
<dl class="py class">
<dt class="sig sig-object py" id="cylc.flow.unicode_rules.XtriggerNameValidator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cylc.flow.unicode_rules.</span></span><span class="sig-name descname"><span class="pre">XtriggerNameValidator</span></span><a class="reference internal" href="../../_modules/cylc/flow/unicode_rules.html#XtriggerNameValidator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cylc.flow.unicode_rules.XtriggerNameValidator" title="Link to this definition"></a></dt>
<dd><p>The rules for valid xtrigger labels:</p>
<ul class="simple">
<li><p>can only contain: latin letters and numbers, <code class="docutils literal notranslate"><span class="pre">_</span></code></p></li>
<li><p>cannot start with: <code class="docutils literal notranslate"><span class="pre">_cylc</span></code></p></li>
</ul>
</dd></dl>

<p>The following workflow declares an xtrigger <code class="docutils literal notranslate"><span class="pre">x1</span> <span class="pre">=</span> <span class="pre">check_data</span></code>. The function
has one argument, a file path, and will be called every 30 seconds until
it succeeds - at which point <code class="docutils literal notranslate"><span class="pre">process_data</span></code> can trigger:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[xtriggers]]</span>
        <span class="nv">x1 </span><span class="o">=</span><span class="s"> check_data(loc=&quot;/path/to/data/source&quot;):PT30S</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">P1D = &quot;@x1 </span><span class="o">=</span><span class="c">&gt;</span> <span class="kd">process_data</span><span class="c">&quot;</span>
<span class="nt">[runtime]</span>
    <span class="nt">[[process_data]]</span>
</pre></div>
</div>
<p>Argument keywords can be omitted, so long as argument order is preserved:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[xtriggers]]</span>
        <span class="nv">x1 </span><span class="o">=</span><span class="s"> check_data(&quot;/path/to/data/source&quot;):PT30S</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Trigger labels can be used with <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> (AND) operators in the graph, but
currently not with <code class="docutils literal notranslate"><span class="pre">|</span></code> (OR) - attempts to do that will fail validation.</p>
</div>
</section>
<section id="xtrigger-results">
<span id="user-guide-xtrigger-results"></span><h3>Xtrigger Results<a class="headerlink" href="#xtrigger-results" title="Link to this heading"></a></h3>
<p>Xtrigger functions must return a flat <em>dictionary</em> of results to be
<a class="reference internal" href="../running-workflows/dynamic-behaviour.html#cylc-broadcast"><span class="std std-ref">broadcast</span></a> to dependent tasks, via environment
variables named as <code class="docutils literal notranslate"><span class="pre">&lt;xtrigger_label&gt;_&lt;dictionary_key&gt;</span></code>.</p>
<p>For example, if the <code class="docutils literal notranslate"><span class="pre">x1</span></code> xtrigger returns this dictionary:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># returned by check_data() on success:</span>
<span class="p">{</span>
    <span class="s2">&quot;data_path&quot;</span><span class="p">:</span> <span class="s2">&quot;/path/to/data&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;netcdf&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Then the <code class="docutils literal notranslate"><span class="pre">process_data</span></code> task, which depends on <code class="docutils literal notranslate"><span class="pre">x1</span></code>, will see the
following environment variables:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="c1"># job environment of process_data:</span>
<span class="nv">x1_data_path</span><span class="o">=</span><span class="s2">&quot;/path/to/data&quot;</span>
<span class="nv">x1_data_type</span><span class="o">=</span><span class="s2">&quot;netcdf&quot;</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">process_data</span></code> task would likely run an application that needs this
information in terms of its native configuration. You can translate from
xtrigger to application in the workflow configuration:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[runtime]</span>
    <span class="nt">[[process_data]]</span>
        <span class="nv">script </span><span class="o">=</span><span class="s"> run-process.py</span>
        <span class="nt">[[[environment]]]</span>
            <span class="nv">INPUT_DATA_LOCN </span><span class="o">=</span><span class="s"> $x1_data_path</span>
            <span class="nv">INPUT_DATA_TYPE </span><span class="o">=</span><span class="s"> $x1_date_type</span>
</pre></div>
</div>
</section>
<section id="task-and-cycle-specificity">
<span id="user-guide-xtriggers-specificity"></span><h3>Task and Cycle Specificity<a class="headerlink" href="#task-and-cycle-specificity" title="Link to this heading"></a></h3>
<p>Cylc makes a call sequence for each unique xtrigger with one or more dependent
tasks in the <a class="reference internal" href="../../glossary.html#term-active-window"><span class="xref std std-term">active window</span></a>. Uniqueness is determined by the
<em>function signature</em>, i.e. the function name and arguments.</p>
<p>Depending on the argument list, an xtrigger can be universal - the same for
all tasks that depend on it; or specific - to the name and/or cycle point of
tasks that depend on it.</p>
<p class="rubric">Universal xtriggers</p>
<p>If an xtrigger has no arguments that vary as the workflow runs, a single call
sequence will satisfy every dependent task in the entire graph.</p>
<p>Below, every cycle point instance of <code class="docutils literal notranslate"><span class="pre">process_data</span></code> depends on the same
xtrigger, which presumably checks data for the entire workflow. Once satisfied
it allows every instance of the task to run:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nv">cycling mode </span><span class="o">=</span><span class="s"> integer</span>
    <span class="nv">initial cycle point </span><span class="o">=</span><span class="s"> 1</span>
    <span class="nv">final cycle point </span><span class="o">=</span><span class="s"> 10</span>
    <span class="nt">[[xtriggers]]</span>
        <span class="nv">x </span><span class="o">=</span><span class="s"> check_data(&quot;/path/to/data&quot;)</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">P1 = &quot;@x </span><span class="o">=</span><span class="c">&gt;</span> <span class="kd">process_data</span><span class="c">&quot;</span>
<span class="nt">[runtime]</span>
    <span class="nt">[[check_data]]</span>
</pre></div>
</div>
<p class="rubric">Task and Cycle-Specific Xtriggers</p>
<p>Xtrigger arguments can incorporate string templates as placeholders for certain
workflow parameters - see <a class="reference internal" href="#custom-trigger-functions"><span class="std std-ref">Custom Xtrigger Functions</span></a>. Several of these
are specific to the cycle point or name of tasks that depend on the xtrigger:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">%(point)s</span></code> - cycle point of the dependent task</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">%(names)s</span></code> - name of the dependent task</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">%(id)s</span></code> - identity (<code class="docutils literal notranslate"><span class="pre">point/name</span></code>) of the dependent task</p></li>
</ul>
<p>If these are used, a new call sequence, with new arguments, will commence
whenever a dependent task with a new name or cycle point enters the
<a class="reference internal" href="../../glossary.html#term-active-window"><span class="xref std std-term">active window</span></a>.</p>
<p>Below, every instance of <code class="docutils literal notranslate"><span class="pre">process_data</span></code> depends on a different, cycle
point-specific xtrigger, which presumably checks data just for that instance.
Each xtrigger, once satisfied, allows just one instance of the task to run:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nv">cycling mode </span><span class="o">=</span><span class="s"> integer</span>
    <span class="nv">initial cycle point </span><span class="o">=</span><span class="s"> 1</span>
    <span class="nv">final cycle point </span><span class="o">=</span><span class="s"> 10</span>
    <span class="nt">[[xtriggers]]</span>
        <span class="nv">x </span><span class="o">=</span><span class="s"> check_data(loc=&quot;/path/to/data&quot;, cycle=&quot;%(point)s&quot;)</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">P1 = &quot;@x </span><span class="o">=</span><span class="c">&gt;</span> <span class="kd">process_data</span><span class="c">&quot;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You have to inspect the function signature to see the cycle
and task specificity of xtriggers.</p>
</div>
<p>The following working example shows four xtriggers based on the
<a class="reference internal" href="#built-in-toy-xtriggers"><span class="std std-ref">toy “echo” xtrigger</span></a>,
which takes an arbitrary list of arguments:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nv">cycling mode </span><span class="o">=</span><span class="s"> integer</span>
    <span class="nv">initial cycle point </span><span class="o">=</span><span class="s"> 1</span>
    <span class="nv">final cycle point </span><span class="o">=</span><span class="s"> 2</span>
    <span class="nt">[[xtriggers]]</span>
        <span class="nv">w1 </span><span class="o">=</span><span class="s"> echo(succeed=True)</span>  <span class="c1"># universal</span>
        <span class="nv">x2 </span><span class="o">=</span><span class="s"> echo(succeed=True, task=&quot;%(name)s&quot;)</span>  <span class="c1"># task name specific</span>
        <span class="nv">y2 </span><span class="o">=</span><span class="s"> echo(succeed=True, cycle=&quot;%(point)s&quot;)</span>  <span class="c1"># cycle point specific</span>
        <span class="nv">z4 </span><span class="o">=</span><span class="s"> echo(succeed=True, task=&quot;%(name)s&quot;, cycle=&quot;%(point)s&quot;)</span>  <span class="c1"># both</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">P1 = &quot;@w1 &amp; @x1 &amp; @y2 &amp; @z4 </span><span class="o">=</span><span class="c">&gt;</span> <span class="kd">foo</span> <span class="o">&amp;</span> <span class="kd">bar</span><span class="c">&quot;</span>
<span class="nt">[runtime]</span>
    <span class="nt">[[foo, bar]]</span>
</pre></div>
</div>
<p>Run this with <code class="docutils literal notranslate"><span class="pre">cylc</span> <span class="pre">play</span> <span class="pre">--no-detach</span></code> and watch when each xtrigger is called:
<code class="docutils literal notranslate"><span class="pre">w1</span></code> will be called once, because it has only static arguments; <code class="docutils literal notranslate"><span class="pre">x2</span></code> will
be called twice, once for each task name (regardless of cycle point); <code class="docutils literal notranslate"><span class="pre">y2</span></code>
will be called twice, once for each cycle point (regardless of task name); and
<code class="docutils literal notranslate"><span class="pre">z4</span></code> will be called four times, once for each task in each cycle point:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cylc<span class="w"> </span>cat-log<span class="w"> </span>xtr<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s1">&#39;xtrigger succeeded&#39;</span>
<span class="go">INFO - xtrigger succeeded: w1 = echo(succeed=True)</span>
<span class="go">INFO - xtrigger succeeded: x2 = echo(succeed=True, task=bar)</span>
<span class="go">INFO - xtrigger succeeded: y2 = echo(cycle=1, succeed=True)</span>
<span class="go">INFO - xtrigger succeeded: z4 = echo(cycle=1, succeed=True, task=bar)</span>
<span class="go">INFO - xtrigger succeeded: x2 = echo(succeed=True, task=foo)</span>
<span class="go">INFO - xtrigger succeeded: z4 = echo(cycle=1, succeed=True, task=foo)</span>
<span class="go">INFO - xtrigger succeeded: y2 = echo(cycle=2, succeed=True)</span>
<span class="go">INFO - xtrigger succeeded: z4 = echo(cycle=2, succeed=True, task=bar)</span>
<span class="go">INFO - xtrigger succeeded: z4 = echo(cycle=2, succeed=True, task=foo)</span>
</pre></div>
</div>
</section>
<section id="user-guide-xtriggers-sequential">
<span id="sequential-xtriggers"></span><span id="id1"></span><h3>Sequential Xtriggers<a class="headerlink" href="#user-guide-xtriggers-sequential" title="Link to this heading"></a></h3>
<p><a class="reference internal" href="../../glossary.html#term-parentless"><span class="xref std std-term">Parentless tasks</span></a>, which often depend on clock or other
xtriggers, automatically spawn into the <a class="reference internal" href="../../glossary.html#term-active-window"><span class="xref std std-term">active window</span></a>, multiple
cycles ahead (to the <a class="reference internal" href="../../glossary.html#term-runahead-limit"><span class="xref std std-term">runahead limit</span></a>). If they depend on xtriggers
that will only be satisfied in cycle point order, this causes
unnecessary xtrigger checking and UI clutter.</p>
<p>Sequential xtriggers prevent this by delaying the spawning of the next
dependent task instance until the current one is satisfied. To do this
(in reverse order of precedence):</p>
<ul class="simple">
<li><p>set
<a class="reference internal" href="../../reference/config/workflow.html#flow.cylc[scheduling]sequential xtriggers" title="flow.cylc[scheduling]sequential xtriggers"><code class="xref cylc cylc-conf docutils literal notranslate"><span class="pre">[scheduling]sequential</span> <span class="pre">xtriggers=True</span></code></a>
for all xtriggers in the workflow</p></li>
<li><p>add a <code class="docutils literal notranslate"><span class="pre">sequential=True</span></code> argument to function definitions (in Python source files)</p></li>
<li><p>add a <code class="docutils literal notranslate"><span class="pre">sequential=True</span></code> argument to function declarations (in workflow configurations)</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The built in <code class="docutils literal notranslate"><span class="pre">wall_clock</span></code> xtrigger is sequential by default.</p>
</div>
</section>
<section id="forcing-xtriggers">
<h3>Forcing Xtriggers<a class="headerlink" href="#forcing-xtriggers" title="Link to this heading"></a></h3>
<p>You can manually satisfy a task’s xtrigger prerequisites via the GUI or
command line, so the task can run even if the xtrigger has not yet succeeded.</p>
<p>This will not affect other tasks that depend on the same xtrigger, but the
scheduler will stop checking the xtrigger if no other active tasks depend on it.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>Satisfy<span class="w"> </span>@x1<span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>foo<span class="w"> </span><span class="k">in</span><span class="w"> </span>cycle<span class="w"> </span>point<span class="w"> </span><span class="m">1</span>
<span class="gp">$ </span>cylc<span class="w"> </span><span class="nb">set</span><span class="w"> </span>--pre<span class="o">=</span>xtrigger/x1<span class="w"> </span>my_workflow//1/foo
<span class="gp"># </span>See<span class="w"> </span>cylc<span class="w"> </span><span class="nb">set</span><span class="w"> </span>--help
</pre></div>
</div>
<p>For this to work without causing task failure, set appropriate default values
for <a class="reference internal" href="#user-guide-xtrigger-results"><span class="std std-ref">xtrigger results</span></a> in task scripting.</p>
</section>
<section id="built-in-clock-triggers">
<span id="id2"></span><h3>Built-in Clock Triggers<a class="headerlink" href="#built-in-clock-triggers" title="Link to this heading"></a></h3>
<p>Clock xtriggers succeed when the real (“wall clock”) time reaches some offset
from the task’s cycle point value.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These should be used instead of the older task clock triggers documented in
<a class="reference internal" href="scheduling.html#clocktriggertasks"><span class="std std-ref">Clock Triggers</span></a>.</p>
</div>
<p>The clock xtrigger function signature looks like this:</p>
<dl class="py function">
<dt class="sig sig-object py" id="cylc.flow.xtriggers.wall_clock.wall_clock">
<span class="sig-prename descclassname"><span class="pre">cylc.flow.xtriggers.wall_clock.</span></span><span class="sig-name descname"><span class="pre">wall_clock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'PT0S'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequential</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/cylc/flow/xtriggers/wall_clock.html#wall_clock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cylc.flow.xtriggers.wall_clock.wall_clock" title="Link to this definition"></a></dt>
<dd><p>Trigger at a specific real “wall clock” time relative to the cycle point
in the graph.</p>
<p>Clock triggers, unlike other trigger functions, are executed synchronously
in the main process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – ISO 8601 interval to wait after the cycle point is reached in real
time before triggering. May be negative, in which case it will
trigger before the real time reaches the cycle point.</p></li>
<li><p><strong>sequential</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Wall-clock xtriggers are run sequentially by default.
See <a class="reference internal" href="#sequential-xtriggers"><span class="std std-ref">Sequential Xtriggers</span></a> for more details.</p></li>
</ul>
</dd>
</dl>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 8.3.0: </span>The <code class="docutils literal notranslate"><span class="pre">sequential</span></code> argument was added.</p>
</div>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Clock xtriggers are cycle-point specific by nature; you don’t need
to <a class="reference internal" href="#user-guide-xtriggers-specificity"><span class="std std-ref">use function arguments</span></a>
to achieve this.</p>
</div>
<p>In the following workflow, task <code class="docutils literal notranslate"><span class="pre">foo</span></code> has a daily cycle point sequence, and
each task instance will trigger when the real time is one hour past its cycle
point value.</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nv">initial cycle point </span><span class="o">=</span><span class="s"> 2018-01-01</span>
    <span class="nt">[[xtriggers]]</span>
        <span class="nv">clock_1 </span><span class="o">=</span><span class="s"> wall_clock(offset=PT1H)</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">P1D = &quot;@clock_1 </span><span class="o">=</span><span class="c">&gt;</span> <span class="kd">foo</span><span class="c">&quot;</span>
<span class="nt">[runtime]</span>
    <span class="nt">[[foo]]</span>
        <span class="nv">script </span><span class="o">=</span><span class="s"> run-foo.sh</span>
</pre></div>
</div>
<p>Or omitting the argument keyword:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[xtriggers]]</span>
        <span class="nv">clock_1 </span><span class="o">=</span><span class="s"> wall_clock(PT1H)</span>
</pre></div>
</div>
<p>A zero-offset clock trigger does not need to be declared before use:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nv">initial cycle point </span><span class="o">=</span><span class="s"> 2018-01-01</span>
    <span class="nt">[[graph]]</span>
         <span class="c1"># zero-offset clock trigger:</span>
        <span class="nv">P1D = &quot;@wall_clock </span><span class="o">=</span><span class="c">&gt;</span> <span class="kd">foo</span><span class="c">&quot;</span>
<span class="nt">[runtime]</span>
    <span class="nt">[[foo]]</span>
        <span class="nv">script </span><span class="o">=</span><span class="s"> run-foo.sh</span>
</pre></div>
</div>
</section>
<section id="built-in-workflow-state-triggers">
<span id="id3"></span><h3>Built-in Workflow State Triggers<a class="headerlink" href="#built-in-workflow-state-triggers" title="Link to this heading"></a></h3>
<p>Workflow-state xtriggers succeed when a given task in another workflow achieves
a given state or output.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These should be used instead of the older workflow state polling tasks described
in <a class="reference internal" href="#user-guide-workflow-state-polling"><span class="std std-ref">Workflow State Polling (old style)</span></a>.</p>
</div>
<p>The workflow state trigger function signature looks like this:</p>
<dl class="py function">
<dt class="sig sig-object py" id="cylc.flow.xtriggers.workflow_state.workflow_state">
<span class="sig-prename descclassname"><span class="pre">cylc.flow.xtriggers.workflow_state.</span></span><span class="sig-name descname"><span class="pre">workflow_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">workflow_task_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flow_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_trigger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_message</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alt_cylc_run_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/cylc/flow/xtriggers/workflow_state.html#workflow_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cylc.flow.xtriggers.workflow_state.workflow_state" title="Link to this definition"></a></dt>
<dd><p>Connect to a workflow DB and check a task status or output.</p>
<p>If the status or output has been achieved, return {True, result}.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>workflow_task_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – ID (workflow//point/task:selector) of the target task.</p></li>
<li><p><strong>offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – Offset from cycle point as an ISO8601 or integer duration,
e.g. PT1H (1 hour) or P1 (1 integer cycle)</p></li>
<li><p><strong>flow_num</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>) – Flow number of the target task.</p></li>
<li><p><strong>is_trigger</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Interpret the task:selector as a task trigger name rather than a
task status.</p></li>
<li><p><strong>is_message</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Interpret the task:selector as a task output message rather than a
task status.</p></li>
<li><p><strong>alt_cylc_run_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – Alternate cylc-run directory, e.g. for another user.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>(satisfied, result)</p>
<dl class="simple">
<dt>satisfied:</dt><dd><p>True if <code class="docutils literal notranslate"><span class="pre">satisfied</span></code> else <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
<dt>result:</dt><dd><p>Dict containing the keys:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">workflow</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">task</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">point</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">offset</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">status</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">message</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trigger</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">flow_num</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">run_dir</span></code></p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 8.3.0: </span>The <code class="docutils literal notranslate"><span class="pre">workflow_task_id</span></code> argument was introduced to replace the
separate <code class="docutils literal notranslate"><span class="pre">workflow</span></code>, <code class="docutils literal notranslate"><span class="pre">point</span></code>, <code class="docutils literal notranslate"><span class="pre">task</span></code>, <code class="docutils literal notranslate"><span class="pre">status</span></code>, and <code class="docutils literal notranslate"><span class="pre">message</span></code>
arguments (which are still supported for backwards compatibility).
The <code class="docutils literal notranslate"><span class="pre">flow_num</span></code> argument was added. The <code class="docutils literal notranslate"><span class="pre">cylc_run_dir</span></code> argument
was renamed to <code class="docutils literal notranslate"><span class="pre">alt_cylc_run_dir</span></code>.</p>
</div>
</dd></dl>

<p>The first argument identifies the target workflow, cycle, task, and status or
output trigger name. The function arguments mirror the arguments and options of
the <code class="docutils literal notranslate"><span class="pre">cylc</span> <span class="pre">workflow-state</span></code> command - see <code class="docutils literal notranslate"><span class="pre">cylc</span> <span class="pre">workflow-state</span> <span class="pre">--help</span></code>.</p>
<p>As a simple example, consider the following “upstream”
workflow (which we want to trigger off of):</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduler]</span>
    <span class="nv">cycle point format </span><span class="o">=</span><span class="s"> %Y</span>
<span class="nt">[scheduling]</span>
    <span class="nv">initial cycle point </span><span class="o">=</span><span class="s"> 2005</span>
    <span class="nv">final cycle point </span><span class="o">=</span><span class="s"> 2015</span>
   <span class="nt">[[graph]]</span>
      <span class="nv">P1Y = &quot;foo </span><span class="o">=</span><span class="c">&gt;</span> <span class="kd">bar</span><span class="c">&quot;</span>
<span class="nt">[runtime]</span>
   <span class="nt">[[bar]]</span>
      <span class="nv">script </span><span class="o">=</span><span class="s"> sleep 10</span>
   <span class="nt">[[foo]]</span>
      <span class="nv">script </span><span class="o">=</span><span class="s"> sleep 5; cylc message &quot;data ready&quot;</span>
      <span class="nt">[[[outputs]]]</span>
          <span class="nv">x </span><span class="o">=</span><span class="s"> &quot;data ready&quot;</span>
</pre></div>
</div>
<p>It must be installed and run under the name <em>up</em>, as referenced in the
“downstream” workflow that depends on it:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduler]</span>
  <span class="nv">cycle point format </span><span class="o">=</span><span class="s"> %Y</span>
<span class="nt">[scheduling]</span>
    <span class="nv">initial cycle point </span><span class="o">=</span><span class="s"> 2010</span>
    <span class="nt">[[xtriggers]]</span>
         <span class="nv">upstream </span><span class="o">=</span><span class="s"> workflow_state(&quot;up//%(point)s/foo:x&quot;, is_trigger=True):PT10S</span>
         <span class="nv">clock_0 </span><span class="o">=</span><span class="s"> wall_clock(offset=PT0H)</span>
   <span class="nt">[[graph]]</span>
        <span class="nv">P1Y </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
            <span class="kd">foo</span>
            <span class="cp">@clock_0</span> <span class="o">&amp;</span> <span class="cp">@upstream</span> <span class="o">=&gt;</span> <span class="kd">FAM</span><span class="c">:</span><span class="kd">succeed</span><span class="c">-</span><span class="kd">all</span> <span class="o">=&gt;</span> <span class="kd">blam</span>
        <span class="s2">&quot;&quot;&quot;</span>
<span class="nt">[runtime]</span>
    <span class="nt">[[root]]</span>
        <span class="nv">script </span><span class="o">=</span><span class="s"> sleep 5</span>
    <span class="nt">[[foo, blam]]</span>
    <span class="nt">[[FAM]]</span>
    <span class="nt">[[f1,f2,f3]]</span>
        <span class="nv">inherit </span><span class="o">=</span><span class="s"> FAM</span>
</pre></div>
</div>
<p>Try starting the downstream workflow first, then the upstream, and watch what
happens. In each cycle point the <code class="docutils literal notranslate"><span class="pre">&#64;upstream</span></code> trigger in the downstream workflow
waits for the upstream task <code class="docutils literal notranslate"><span class="pre">foo</span></code> (with the same cycle point) workflow to generate
the “data ready” message.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">workflow_state</span></code> trigger function, like the <code class="docutils literal notranslate"><span class="pre">cylc</span> <span class="pre">workflow-state</span></code> command,
must have read-access to the upstream workflow’s public database.</p></li>
<li><p>The task cycle point is supplied by a string template <code class="docutils literal notranslate"><span class="pre">%(point)s</span></code>.
See <a class="reference internal" href="#custom-trigger-functions"><span class="std std-ref">Custom Xtrigger Functions</span></a>) for other string templates available
to xtriggers.</p></li>
</ul>
</div>
<p>The return value of the <code class="docutils literal notranslate"><span class="pre">workflow_state</span></code> trigger function looks like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;workflow&#39;</span><span class="p">:</span> <span class="n">workflow_id</span><span class="p">,</span>
    <span class="s1">&#39;task&#39;</span><span class="p">:</span> <span class="n">task_name</span><span class="p">,</span>
    <span class="s1">&#39;point&#39;</span><span class="p">:</span> <span class="n">cycle_point</span><span class="p">,</span>
    <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="n">task_status</span><span class="p">,</span>  <span class="c1"># or</span>
    <span class="s1">&#39;trigger&#39;</span><span class="p">:</span> <span class="n">task_output_trigger</span><span class="p">,</span>  <span class="c1"># or</span>
    <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="n">task_output_message</span><span class="p">,</span>
    <span class="s1">&#39;flow_num&#39;</span><span class="p">:</span> <span class="n">flow_num</span>  <span class="c1"># if given</span>
<span class="p">}</span>
<span class="k">return</span> <span class="p">(</span><span class="n">satisfied</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">results</span></code> dictionary contains the names and values of the
target workflow state parameters. Each name gets qualified with the
unique trigger name (“upstream” here) and passed to the environment of
dependent tasks (the members of the <code class="docutils literal notranslate"><span class="pre">FAM</span></code> family in this case).
To see this, take a look at the job script for one of the downstream tasks:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">% </span>cylc<span class="w"> </span>cat-log<span class="w"> </span>-f<span class="w"> </span>j<span class="w"> </span>dn//2011/f22011
<span class="go">...</span>
<span class="go">cylc__job__inst__user_env() {</span>
<span class="gp">    # </span>TASK<span class="w"> </span>RUNTIME<span class="w"> </span>ENVIRONMENT:
<span class="go">    export upstream_workflow upstream_cylc_run_dir upstream_offset \</span>
<span class="go">      upstream_message upstream_status upstream_point upstream_task</span>
<span class="go">    upstream_workflow=&quot;up&quot;</span>
<span class="go">    upstream_task=&quot;foo&quot;</span>
<span class="go">    upstream_point=&quot;2011&quot;</span>
<span class="go">    upstream_status=&quot;succeeded&quot;</span>
<span class="go">}</span>
<span class="go">...</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The dependent task has to know the name of the xtrigger that it
depends on - “upstream” in this case - in order to use this information.
However the name could be given to the task environment in the workflow
configuration.</p>
</div>
</section>
<section id="built-in-toy-xtriggers">
<span id="id4"></span><h3>Built-in Toy Xtriggers<a class="headerlink" href="#built-in-toy-xtriggers" title="Link to this heading"></a></h3>
</section>
<section id="echo">
<h3>echo<a class="headerlink" href="#echo" title="Link to this heading"></a></h3>
<p>The toy <code class="docutils literal notranslate"><span class="pre">echo</span></code> trigger simply prints any arguments that you give it to stdout,
and then fails (trigger condition not met) or succeeds (trigger condition met)
according to the value of a <code class="docutils literal notranslate"><span class="pre">succeed=True</span></code> argument (which defaults to
<code class="docutils literal notranslate"><span class="pre">False</span></code>). On success, it returns all arguments in the result dictionary.</p>
<dl class="py function">
<dt class="sig sig-object py" id="cylc.flow.xtriggers.echo.echo">
<span class="sig-prename descclassname"><span class="pre">cylc.flow.xtriggers.echo.</span></span><span class="sig-name descname"><span class="pre">echo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/cylc/flow/xtriggers/echo.html#echo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cylc.flow.xtriggers.echo.echo" title="Link to this definition"></a></dt>
<dd><p>Print arguments to stdout, return kwargs[‘succeed’] and kwargs.</p>
<p>This may be a useful aid to understanding how xtriggers work.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>succeed</strong> – Set the success of failure of this xtrigger.</p></li>
<li><p><strong>*args</strong> – Print to stdout.</p></li>
<li><p><strong>**kwargs</strong> – Print to stdout, and return as output.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(True/False, kwargs)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><em>Tuple</em></a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">echo</span><span class="p">(</span><span class="s1">&#39;Breakfast Time&#39;</span><span class="p">,</span> <span class="n">succeed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">egg</span><span class="o">=</span><span class="s1">&#39;poached&#39;</span><span class="p">)</span>
<span class="go">echo: ARGS: (&#39;Breakfast Time&#39;,)</span>
<span class="go">echo: KWARGS: {&#39;succeed&#39;: True, &#39;egg&#39;: &#39;poached&#39;}</span>
<span class="go">(True, {&#39;succeed&#39;: True, &#39;egg&#39;: &#39;poached&#39;})</span>
</pre></div>
</div>
</dd></dl>

<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nv">initial cycle point </span><span class="o">=</span><span class="s"> now</span>
    <span class="nt">[[xtriggers]]</span>
        <span class="nv">echo_1 </span><span class="o">=</span><span class="s"> echo(succeeded=True, hello, 99, point=%(point)s, foo=10)</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">PT1H = &quot;@echo_1 </span><span class="o">=</span><span class="c">&gt;</span> <span class="kd">foo</span><span class="c">&quot;</span>
<span class="nt">[runtime]</span>
    <span class="nt">[[foo]]</span>
        <span class="nv">script </span><span class="o">=</span><span class="s"> &quot;printenv | grep echo_1&quot;</span>
</pre></div>
</div>
<p>Run this with <code class="docutils literal notranslate"><span class="pre">cylc</span> <span class="pre">play</span> <span class="pre">--no-detach</span> <span class="pre">&lt;workflow&gt;</span></code> and watch your terminal to see
the xtrigger calls. View the task job log with <code class="docutils literal notranslate"><span class="pre">cylc</span> <span class="pre">cat-log</span> <span class="pre">&lt;workflow_id&gt;//1/foo</span></code>
to confirm that the dependent task received the xtrigger results.</p>
</section>
<section id="xrandom">
<h3>xrandom<a class="headerlink" href="#xrandom" title="Link to this heading"></a></h3>
<p>The toy <code class="docutils literal notranslate"><span class="pre">xrandom</span></code> function sleeps for a configurable amount of time (useful for
testing the effect of a long-running trigger function - which should be avoided)
and has a configurable random chance of success. The function signature is:</p>
<dl class="py function" id="module-cylc.flow.xtriggers.xrandom">
<dt class="sig sig-object py" id="cylc.flow.xtriggers.xrandom.xrandom">
<span class="sig-prename descclassname"><span class="pre">cylc.flow.xtriggers.xrandom.</span></span><span class="sig-name descname"><span class="pre">xrandom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">percent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">secs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/cylc/flow/xtriggers/xrandom.html#xrandom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cylc.flow.xtriggers.xrandom.xrandom" title="Link to this definition"></a></dt>
<dd><p>Random xtrigger, with configurable sleep and percent success.</p>
<p>Sleep for <code class="docutils literal notranslate"><span class="pre">sec</span></code> seconds, and report satisfied with <code class="docutils literal notranslate"><span class="pre">percent</span></code>
likelihood.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">_</span></code> argument is not used in the function code, but can be used to
specialize the function signature to cycle point or task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>percent</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Percent likelihood of passing.</p></li>
<li><p><strong>secs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Seconds to sleep before starting the trigger.</p></li>
<li><p><strong>_</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em> | </em><em>None</em>) – Used to allow users to specialize the trigger with extra
parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>(satisfied, results)</p>
<dl>
<dt>satisfied:</dt><dd><p>True if <code class="docutils literal notranslate"><span class="pre">satisfied</span></code> else <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
<dt>results:</dt><dd><p>A dictionary containing the following keys:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">COLOR</span></code></dt><dd><p>A random colour (e.g. red, orange, …).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">SIZE</span></code></dt><dd><p>A random size (e.g. small, medium, …).</p>
</dd>
</dl>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>If the percent is zero, it returns that the trigger condition was
not satisfied, and an empty dictionary.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">xrandom</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">(False, {})</span>
</pre></div>
</div>
<p>If the percent is not zero, but the random percent success is not met,
then it also returns that the trigger condition was not satisfied,
and an empty dictionary.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mocked_random</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="mf">0.3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span><span class="o">.</span><span class="n">random</span> <span class="o">=</span> <span class="n">mocked_random</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xrandom</span><span class="p">(</span><span class="mf">15.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">(False, {})</span>
</pre></div>
</div>
<p>Finally, if the percent is not zero, and the random percent success is
met, then it returns that the trigger condition was satisfied, and a
dictionary containing random colour and size as result.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mocked_random</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="mf">0.9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span><span class="o">.</span><span class="n">random</span> <span class="o">=</span> <span class="n">mocked_random</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mocked_randint</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span><span class="o">.</span><span class="n">randint</span> <span class="o">=</span> <span class="n">mocked_randint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xrandom</span><span class="p">(</span><span class="mf">99.99</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">(True, {&#39;COLOR&#39;: &#39;orange&#39;, &#39;SIZE&#39;: &#39;small&#39;})</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cylc.flow.xtriggers.xrandom.validate">
<span class="sig-prename descclassname"><span class="pre">cylc.flow.xtriggers.xrandom.</span></span><span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/cylc/flow/xtriggers/xrandom.html#validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cylc.flow.xtriggers.xrandom.validate" title="Link to this definition"></a></dt>
<dd><p>Validate the args that xrandom is called with.</p>
<p>Cylc calls this function automatically when parsing the workflow.</p>
<p>Here we specify the rules for args are:</p>
<ul class="simple">
<li><p>percent: Must be 0 ≤ x ≤ 100</p></li>
<li><p>secs: Must be an integer.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><em>Dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em>]</em>)</p>
</dd>
</dl>
</dd></dl>

<p>An example xrandom trigger workflow:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nv">cycling mode </span><span class="o">=</span><span class="s"> integer</span>
    <span class="nv">initial cycle point </span><span class="o">=</span><span class="s"> 1</span>
    <span class="nv">final cycle point </span><span class="o">=</span><span class="s"> 5</span>
    <span class="nt">[[xtriggers]]</span>
        <span class="c1"># Called once for all dependent tasks (all cycles).</span>
        <span class="nv">x1 </span><span class="o">=</span><span class="s"> xrandom(percent=25, secs=2):PT5S</span>
        <span class="c1"># Called once per dependent task name (all cycles).</span>
        <span class="nv">x2 </span><span class="o">=</span><span class="s"> xrandom(percent=25, secs=2, _=%(name)s):PT5S</span>
        <span class="c1"># Called once per cycle for all dependent tasks.</span>
        <span class="nv">x3 </span><span class="o">=</span><span class="s"> xrandom(percent=25, secs=2, _=%(point)s):PT5S</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">P1 </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
            <span class="c1"># all instances of foo and bar should trigger at once, together</span>
            <span class="cp">@x1</span> <span class="o">=&gt;</span> <span class="kd">foo</span> <span class="o">&amp;</span> <span class="kd">bar</span>

            <span class="c1"># all instances of cat should trigger at once, and separately, all</span>
            <span class="c1"># instances of baz should trigger at once.</span>
            <span class="cp">@x2</span> <span class="o">=&gt;</span> <span class="kd">cat</span> <span class="o">&amp;</span> <span class="kd">dog</span>

            <span class="c1"># each instance of qux should trigger separately</span>
            <span class="cp">@x3</span> <span class="o">=&gt;</span> <span class="kd">qux</span>

            <span class="c1"># Result:</span>
            <span class="c1"># - x1 should return True once, and not be called again.</span>
            <span class="c1"># - x2 should return True twice, and not be called again.</span>
            <span class="c1"># - x3 should return True five times, and not be called again.</span>
            <span class="c1"># i.e. 8 True returns in the 5-cycle workflow run.</span>
        <span class="s2">&quot;&quot;&quot;</span>
<span class="nt">[runtime]</span>
    <span class="nt">[[root]]</span>
        <span class="nv">script </span><span class="o">=</span><span class="s"> sleep 5</span>
    <span class="nt">[[foo, bar, cat, dog, qux]]</span>
</pre></div>
</div>
</section>
<section id="custom-xtrigger-functions">
<span id="custom-trigger-functions"></span><h3>Custom Xtrigger Functions<a class="headerlink" href="#custom-xtrigger-functions" title="Link to this heading"></a></h3>
<p>Xtrigger functions are Python functions with some special requirements.</p>
<p class="rubric">Requirements:</p>
<p>Xtrigger functions must be compatible with the Python version that runs the
scheduler (see <a class="reference external" href="https://docs.python.org/3/library/importlib.metadata.html#requirements" title="(in Python v3.13)"><span>Distribution requirements</span></a> for the latest version specification).</p>
<p>Xtrigger functions must return a Tuple of <code class="docutils literal notranslate"><span class="pre">(Boolean,</span> <span class="pre">Dictionary)</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">(False,</span> <span class="pre">{})</span></code> - failed: trigger condition not met</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(True,</span> <span class="pre">results)</span></code> - succeeded: trigger condition met</p></li>
</ul>
<p>where <code class="docutils literal notranslate"><span class="pre">results</span></code> is a flat (non-nested) dictionary of information to be passed
to dependent tasks - see <a class="reference internal" href="#user-guide-xtrigger-results"><span class="std std-ref">Xtrigger Results</span></a>.
Each dictionary key must be valid as an
<a class="reference external" href="https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap08.html">environment variable</a>
name.</p>
<p>Xtrigger functions can take arbitrary positional and keyword arguments, except
for the keyword <code class="docutils literal notranslate"><span class="pre">sequential</span></code>, which is
reserved for <a class="reference internal" href="#user-guide-xtriggers-sequential"><span class="std std-ref">sequential xtriggers</span></a>.</p>
<p>Xtrigger functions cannot store data between invocations, because each call
is executed via a wrapper in a new subprocess. If necessary the filesystem
could be used for persistent data.</p>
<p>If xtriggers depend on files (say) that might not exist when the function is first
called, just return trigger condition not met (i.e., <code class="docutils literal notranslate"><span class="pre">(False,</span> <span class="pre">{})</span></code>).</p>
<p class="rubric">Installation:</p>
<p>We recommend using the <code class="docutils literal notranslate"><span class="pre">cylc.xtriggers</span></code> entry point to install the xtrigger
as a Python package - see <a class="reference internal" href="../../plugins/xtriggers/index.html#developing-xtrigger-plugins"><span class="std std-ref">Developing xtrigger plugins</span></a>.</p>
<p>Otherwise, e.g., for installing custom xtriggers under your own user account,
xtrigger functions must be:</p>
<ul class="simple">
<li><p>defined in a module with the same name as the function</p></li>
<li><p>located in:
- <code class="docutils literal notranslate"><span class="pre">&lt;workflow-dir&gt;/lib/python/</span></code>;
- or anywhere in your <code class="docutils literal notranslate"><span class="pre">$CYLC_PYTHONPATH</span></code></p></li>
</ul>
<p>Custom xtrigger module can also provide a <code class="docutils literal notranslate"><span class="pre">validate</span></code> function for checking
configured arguments, see
<a class="reference internal" href="#user-guide-xtrigger-validation-functions"><span class="std std-ref">Xtrigger Validation Functions</span></a> for details.</p>
</section>
<section id="passing-workflow-parameters-to-xtrigger-functions">
<h3>Passing Workflow Parameters to Xtrigger Functions<a class="headerlink" href="#passing-workflow-parameters-to-xtrigger-functions" title="Link to this heading"></a></h3>
<p>Workflow and task parameters can be passed to function arguments from the
workflow configuration via the following string templates. Task parameters
affect <a class="reference internal" href="#user-guide-xtriggers-specificity"><span class="std std-ref">xtrigger specificity</span></a>.</p>
<dl>
<p>Templates variables for string replacement in xtrigger functions.</p>
<p>The following string templates are available for use, if the trigger
function needs any of this information, in function arguments in the
workflow configuration.</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nv">initial cycle point </span><span class="o">=</span><span class="s"> now</span>
    <span class="nt">[[xtriggers]]</span>
        <span class="nv">my_xtrigger </span><span class="o">=</span><span class="s"> my_xtrigger_fcn(&#39;%(workflow)s&#39;, &#39;%(point)s&#39;)</span>
</pre></div>
</div>
<p>For an explanation of the substitution syntax, see
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#printf-style-string-formatting">String Formatting Operations in the Python documentation</a>.</p>
<dl class="describe">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">point</span></span></dt>
<dd><p>The cycle point of the dependent task.</p>
</dd></dl>

<dl class="describe">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">debug</span></span></dt>
<dd><p>True if Cylc is being run in debug mode (–debug, -vv).</p>
</dd></dl>

<dl class="describe">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">workflow_run_dir</span></span></dt>
<dd><p>The path to the workflow run directory.</p>
</dd></dl>

<dl class="describe">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">workflow_share_dir</span></span></dt>
<dd><p>The path to the workflow share directory.</p>
</dd></dl>

<dl class="describe">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">id</span></span></dt>
<dd><p>The ID of the dependent task.</p>
</dd></dl>

<dl class="describe">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">name</span></span></dt>
<dd><p>The name of the dependent task.</p>
</dd></dl>

<dl class="describe">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">user_name</span></span></dt>
<dd><p>The user account under which the workflow is being run.</p>
</dd></dl>

<dl class="describe">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">workflow</span></span></dt>
<dd><p>The workflow ID.</p>
</dd></dl>

<dl class="describe">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">workflow_name</span></span></dt>
<dd><p>The workflow ID.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 8.0.0: </span>Use <code class="docutils literal notranslate"><span class="pre">workflow</span></code> instead.</p>
</div>
</dd></dl>

<dl class="describe">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">suite_name</span></span></dt>
<dd><p>The workflow ID.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 8.0.0: </span>Use <code class="docutils literal notranslate"><span class="pre">workflow</span></code> instead.</p>
</div>
</dd></dl>

<dl class="describe">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">suite_run_dir</span></span></dt>
<dd><p>The path to the workflow run directory.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 8.0.0: </span>Use <code class="docutils literal notranslate"><span class="pre">workflow_run_dir</span></code> instead.</p>
</div>
</dd></dl>

<dl class="describe">
<dt class="sig sig-object">
<span class="sig-name descname"><span class="pre">suite_share_dir</span></span></dt>
<dd><p>The path to the workflow share directory.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 8.0.0: </span>Use <code class="docutils literal notranslate"><span class="pre">workflow_share_dir</span></code> instead.</p>
</div>
</dd></dl>

</dl>

</section>
<section id="xtrigger-validation-functions">
<span id="user-guide-xtrigger-validation-functions"></span><h3>Xtrigger Validation Functions<a class="headerlink" href="#xtrigger-validation-functions" title="Link to this heading"></a></h3>
<p>The arguments you call the xtrigger function with are automatically validated
against the function signature, however, you might wish to add extra validation
logic to your custom xtrigger, e.g. to check argument types or values.</p>
<p>If a function named <code class="docutils literal notranslate"><span class="pre">validate</span></code> is present alongside the xtrigger in its
module, it will be automatically called with a dictionary of all the arguments
passed to the xtrigger function in the workflow config. It should raise a
<a class="reference internal" href="../../reference/api/exceptions.html#cylc.flow.exceptions.WorkflowConfigError" title="cylc.flow.exceptions.WorkflowConfigError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cylc.flow.exceptions.WorkflowConfigError</span></code></a> exception if an error is
detected.</p>
<p>The <a class="reference internal" href="#module-cylc.flow.xtriggers.xrandom" title="cylc.flow.xtriggers.xrandom"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cylc.flow.xtriggers.xrandom</span></code></a> xtrigger module contains an example
of an xtrigger validation function.</p>
</section>
<section id="filesystem-events">
<h3>Filesystem Events?<a class="headerlink" href="#filesystem-events" title="Link to this heading"></a></h3>
<p>Cylc does not have built-in support for triggering off of filesystem events
such as <code class="docutils literal notranslate"><span class="pre">inotify</span></code> on Linux. There is no cross-platform standard for
filesystem events, and they can only be detected on the generating node in
on HPC clusters.</p>
</section>
<section id="persistent-event-watchers">
<h3>Persistent Event Watchers?<a class="headerlink" href="#persistent-event-watchers" title="Link to this heading"></a></h3>
<p>For some applications a process that continually monitors an external condition
might be preferred over periodic checking. This would be more difficult to
support as a Cylc plugin, but we may decide to do it in the future. In the
meantime, consider implementing a small daemon process as the watcher
and have your Cylc xtrigger functions interact with that.</p>
</section>
</section>
<section id="ext-triggers-push">
<span id="user-guide-ext-triggers"></span><span id="old-style-external-triggers"></span><h2>Ext-Triggers (push)<a class="headerlink" href="#ext-triggers-push" title="Link to this heading"></a></h2>
<p>These external triggers are hidden task prerequisites that must be satisfied by
using the <code class="docutils literal notranslate"><span class="pre">cylc</span> <span class="pre">ext-trigger</span></code> client command to send a pre-defined message to
the workflow along with an ID string that distinguishes one instance of the
event from another (the name of the target task and its current cycle point are
not required). The event ID is just an arbitrary string to Cylc, but it can be
used to identify something associated with the event to the workflow - such as
the filename of a new externally-generated dataset. When the <a class="reference internal" href="../../glossary.html#term-scheduler"><span class="xref std std-term">scheduler</span></a>
receives the event notification it will trigger the next instance of any task
waiting on that trigger (whatever its cycle point) and then broadcast
(see <a class="reference internal" href="../running-workflows/dynamic-behaviour.html#cylc-broadcast"><span class="std std-ref">Cylc Broadcast</span></a>) the event ID to the cycle point of the triggered
task as <code class="docutils literal notranslate"><span class="pre">$CYLC_EXT_TRIGGER_ID</span></code>. Downstream tasks with the same cycle
point therefore know the new event ID too and can use it, if they need to, to
identify the same new dataset. In this way a whole workflow can be associated
with each new dataset, and multiple datasets can be processed in parallel if
they happen to arrive in quick succession.</p>
<p>An externally-triggered task must register the event it waits on in the workflow
scheduling section:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="c1"># workflow &quot;sat-proc&quot;</span>
<span class="nt">[scheduling]</span>
    <span class="nv">cycling mode </span><span class="o">=</span><span class="s"> integer</span>
    <span class="nv">initial cycle point </span><span class="o">=</span><span class="s"> 1</span>
    <span class="nt">[[special tasks]]</span>
        <span class="nv">external-trigger </span><span class="o">=</span><span class="s"> get-data(&quot;new sat X data avail&quot;)</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">P1 = get-data =&gt; conv-data </span><span class="o">=</span><span class="c">&gt;</span> <span class="kd">products</span>
</pre></div>
</div>
<p>Then, each time a new dataset arrives the external detection system should
notify the workflow like this:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cylc<span class="w"> </span>ext-trigger<span class="w"> </span>sat-proc<span class="w"> </span><span class="s2">&quot;new sat X data avail&quot;</span><span class="w"> </span>passX12334a
</pre></div>
</div>
<p>where “sat-proc” is the workflow name and “passX12334a” is the ID string for
the new event. The workflow passphrase must be installed on triggering account.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only one task in a workflow can trigger off a particular external message.
Other tasks can trigger off the externally triggered task as required,
of course.</p>
</div>
<p>Here is a working example of a simulated satellite processing workflow:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="ch">#!Jinja2</span>

<span class="c1"># WARNING: this uses the old-style push external trigger mechanism.</span>

<span class="nt">[meta]</span>
    <span class="nv">title </span><span class="o">=</span><span class="s"> Real time satellite data processing demo, variant 3 of 3</span>

    <span class="nv">description </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Successive cycle points retrieve and process the next arbitrarily timed</span>
<span class="s2">        and labelled dataset, in parallel if the data comes in quickly. This</span>
<span class="s2">        variant of the workflow has initial get_data tasks with external triggers:</span>
<span class="s2">        they do not submit until triggered by an external system.</span>
<span class="s2">    &quot;&quot;&quot;</span>

<span class="c1"># Note that the satellite simulator task here that supplies the external event</span>
<span class="c1"># trigger happens to be a workflow task - i.e. it is not really &quot;external&quot; - but</span>
<span class="c1"># this is only a convenience - an easy route to a self-contained example workflow.</span>

<span class="c1"># you can monitor output processing with:</span>
<span class="c1"># $ watch -n 1 \</span>
<span class="c1">#    &quot;find ~/cylc-run/&lt;workflow-id&gt;/share; find ~/cylc-run/&lt;workflow-id&gt;/work&quot;</span>

<span class="cp">{% set N_DATASETS = 5 %}</span>

<span class="c1"># define shared directories (could use runtime namespaces for this)</span>
<span class="cp">{% set DATA_IN_DIR = &quot;$CYLC_WORKFLOW_SHARE_DIR/incoming&quot; %}</span>
<span class="cp">{% set PRODUCT_DIR = &quot;$CYLC_WORKFLOW_SHARE_DIR/products&quot; %}</span>

<span class="nt">[scheduling]</span>
    <span class="nv">cycling mode </span><span class="o">=</span><span class="s"> integer</span>
    <span class="nv">initial cycle point </span><span class="o">=</span><span class="s"> 1</span>
    <span class="nv">final cycle point </span><span class="o">=</span><span class="s"> </span><span class="cp">{{N_DATASETS}}</span>
    <span class="nt">[[special tasks]]</span>
        <span class="nv">external-trigger </span><span class="o">=</span><span class="s"> get_data(&quot;new dataset ready for processing&quot;)</span>
    <span class="nt">[[graph]]</span>
        <span class="c1"># first cycle</span>
        <span class="nv">R1 = prep </span><span class="o">=</span><span class="c">&gt;</span> <span class="kd">satsim</span> <span class="o">&amp;</span> <span class="kd">get_data</span>
<span class="nv">        P1 </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
            <span class="c1"># Processing chain for each dataset</span>
            <span class="kd">get_data</span> <span class="o">=&gt;</span> <span class="kd">proc1</span> <span class="o">=&gt;</span> <span class="kd">proc2</span> <span class="o">=&gt;</span> <span class="kd">products</span>
            <span class="c1"># As one dataset is retrieved, start waiting on another.</span>
            <span class="kd">get_data</span>[<span class="nb">-P1</span>] <span class="o">=&gt;</span> <span class="kd">get_data</span>
        <span class="s2">&quot;&quot;&quot;</span>
        <span class="c1"># last cycle</span>
        <span class="nv">R1//{{N_DATASETS}} = products </span><span class="o">=</span><span class="c">&gt;</span> <span class="kd">collate</span>

<span class="nt">[runtime]</span>
    <span class="nt">[[prep]]</span>
        <span class="nv">script </span><span class="o">=</span><span class="s"> \</span>
<span class="s">rm -rf $CYLC_WORKFLOW_SHARE_DIR $CYLC_WORKFLOW_WORK_DIR</span>
        <span class="nt">[[[meta]]]</span>
            <span class="nv">title </span><span class="o">=</span><span class="s"> clean the workflow output directories</span>
    <span class="nt">[[satsim]]</span>
        <span class="nv">pre-script </span><span class="o">=</span><span class="s"> mkdir -p </span><span class="cp">{{DATA_IN_DIR}}</span>
        <span class="nv">script </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            COUNT=0</span>
<span class="s2">            while true; do</span>
<span class="s2">                ((COUNT == </span><span class="cp">{{N_DATASETS}}</span><span class="s2">)) &amp;&amp; break</span>
                <span class="c1"># sleep $((RANDOM % 20))</span>
                <span class="c1"># Generate datasets very quickly to test parallel processing.</span>
<span class="s2">                DATA_ID=$(date +%s).$((RANDOM % 100))</span>
<span class="s2">                DATA_FILE=dataset-${DATA_ID}.raw</span>
<span class="s2">                touch </span><span class="cp">{{DATA_IN_DIR}}</span><span class="s2">/$DATA_FILE</span>
<span class="s2">                ((COUNT += 1))</span>
                <span class="c1"># (required to distinguish fast-arriving messages).</span>
                <span class="c1"># Trigger downstream processing in the workflow.</span>
<span class="s2">                cylc ext-trigger $CYLC_WORKFLOW_ID \</span>
<span class="s2">                   &quot;new dataset ready for processing&quot; $DATA_ID</span>
<span class="s2">            done</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="nt">[[[meta]]]</span>
            <span class="nv">title </span><span class="o">=</span><span class="s"> simulate a satellite data feed</span>
            <span class="nv">description </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                Generates </span><span class="cp">{{N_DATASETS}}</span><span class="s2"> arbitrarily labelled datasets very</span>
<span class="s2">                quickly, to show parallel processing streams.</span>
<span class="s2">            &quot;&quot;&quot;</span>
    <span class="nt">[[WORKDIR]]</span>
        <span class="c1"># Define a common cycle-point-specific work-directory for all</span>
        <span class="c1"># processing tasks so that they all work on the same dataset.</span>
        <span class="nv">work sub-directory </span><span class="o">=</span><span class="s"> proc-$CYLC_TASK_CYCLE_POINT</span>
        <span class="nv">post-script </span><span class="o">=</span><span class="s"> sleep 5</span>
        <span class="nt">[[[environment]]]</span>
            <span class="nv">DATASET </span><span class="o">=</span><span class="s"> dataset-$CYLC_EXT_TRIGGER_ID</span>

    <span class="nt">[[get_data]]</span>
        <span class="nv">inherit </span><span class="o">=</span><span class="s"> WORKDIR</span>
        <span class="nv">script </span><span class="o">=</span><span class="s"> mv </span><span class="cp">{{DATA_IN_DIR}}</span><span class="s">/${DATASET}.raw $PWD</span>
        <span class="nt">[[[meta]]]</span>
            <span class="nv">title </span><span class="o">=</span><span class="s"> retrieve next dataset</span>
            <span class="nv">description </span><span class="o">=</span><span class="s"> just do it - we know it exists already</span>
  <span class="nt">[[proc1]]</span>
        <span class="nv">inherit </span><span class="o">=</span><span class="s"> WORKDIR</span>
        <span class="nv">script </span><span class="o">=</span><span class="s"> mv ${DATASET}.raw ${DATASET}.proc1</span>
        <span class="nt">[[[meta]]]</span>
            <span class="nv">title </span><span class="o">=</span><span class="s"> convert .raw dataset to .proc1 form</span>
   <span class="nt">[[proc2]]</span>
        <span class="nv">inherit </span><span class="o">=</span><span class="s"> WORKDIR</span>
        <span class="nv">script </span><span class="o">=</span><span class="s"> mv ${DATASET}.proc1 ${DATASET}.proc2</span>
        <span class="nt">[[[meta]]]</span>
            <span class="nv">title </span><span class="o">=</span><span class="s"> convert .proc1 dataset to .proc2 form</span>
   <span class="nt">[[products]]</span>
        <span class="nv">inherit </span><span class="o">=</span><span class="s"> WORKDIR</span>
        <span class="nv">script </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            mkdir -p </span><span class="cp">{{PRODUCT_DIR}}</span>
<span class="s2">            mv ${DATASET}.proc2 </span><span class="cp">{{PRODUCT_DIR}}</span><span class="s2">/${DATASET}.prod</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="nt">[[[meta]]]</span>
            <span class="nv">title </span><span class="o">=</span><span class="s"> generate products from .proc2 processed dataset</span>
    <span class="nt">[[collate]]</span>
        <span class="c1"># Note you might want to use &quot;cylc workflow-state&quot; to check that</span>
        <span class="c1"># _all_ product tasks have finished before collating results.</span>
        <span class="nv">script </span><span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            echo PRODUCTS:</span>
<span class="s2">            ls </span><span class="cp">{{PRODUCT_DIR}}</span>
<span class="s2">            sleep 20</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="nt">[[[meta]]]</span>
            <span class="nv">title </span><span class="o">=</span><span class="s"> collate all products from the workflow run</span>
</pre></div>
</div>
<p>External triggers are not normally needed in datetime cycling workflows driven
by real time data that comes in at regular intervals. In these cases a data
retrieval task can be clock-triggered (and have appropriate retry intervals) to
submit at the expected data arrival time, so little time is wasted in polling.
However, if the arrival time of the cycle-point-specific data is highly
variable, external triggering may be used with the cycle point embedded in the
message:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="c1"># workflow &quot;data-proc&quot;</span>
<span class="nt">[scheduling]</span>
    <span class="nv">initial cycle point </span><span class="o">=</span><span class="s"> 20150125T00</span>
    <span class="nv">final cycle point   </span><span class="o">=</span><span class="s"> 20150126T00</span>
    <span class="nt">[[special tasks]]</span>
        <span class="nv">external-trigger </span><span class="o">=</span><span class="s"> get-data(&quot;data arrived for $CYLC_TASK_CYCLE_POINT&quot;)</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">T00 = init-process =&gt; get-data </span><span class="o">=</span><span class="c">&gt;</span> <span class="kd">post</span><span class="c">-</span><span class="kd">process</span>
</pre></div>
</div>
<p>Once the variable-length waiting is finished, an external detection system
should notify the workflow like this:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cylc<span class="w"> </span>ext-trigger<span class="w"> </span>data-proc<span class="w"> </span><span class="s2">&quot;data arrived for 20150126T00&quot;</span><span class="w"> </span>passX12334a
</pre></div>
</div>
<p>where “data-proc” is the workflow name, the cycle point has replaced the
variable in the trigger string, and “passX12334a” is the ID string for
the new event. The workflow passphrase must be installed on the triggering
account. In this case, the event will trigger for the second cycle point but
not the first because of the cycle-point matching.</p>
</section>
<section id="workflow-state-polling-old-style">
<span id="user-guide-workflow-state-polling"></span><span id="workflowstatepolling"></span><h2>Workflow State Polling (old style)<a class="headerlink" href="#workflow-state-polling-old-style" title="Link to this heading"></a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Please read <a class="reference internal" href="#built-in-workflow-state-triggers"><span class="std std-ref">Built-in Workflow State Triggers</span></a> before using the older
inter-workflow triggering mechanism described in this section.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">cylc</span> <span class="pre">workflow-state</span></code> command interrogates workflow run databases. It
has a polling mode that waits for a given task in the target workflow to achieve a
given state, or receive a given message. This can be used to make task
scripting wait for a remote task to succeed (for example).</p>
<p>Automatic workflow-state polling tasks can be defined with in the graph. They get
automatically-generated task scripting that uses <code class="docutils literal notranslate"><span class="pre">cylc</span> <span class="pre">workflow-state</span></code>
appropriately (it is an error to give your own <code class="docutils literal notranslate"><span class="pre">script</span></code> item for these
tasks).</p>
<p>Here’s how to trigger a task <code class="docutils literal notranslate"><span class="pre">bar</span></code> off a task <code class="docutils literal notranslate"><span class="pre">foo</span></code> in
a remote workflow called <code class="docutils literal notranslate"><span class="pre">other.workflow</span></code>:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">T00, T12 = &quot;my-foo&lt;other.workflow::foo&gt; </span><span class="o">=</span><span class="c">&gt;</span> <span class="kd">bar</span><span class="c">&quot;</span>
</pre></div>
</div>
<p>Local task <code class="docutils literal notranslate"><span class="pre">my-foo</span></code> will poll for the success of <code class="docutils literal notranslate"><span class="pre">foo</span></code>
in workflow <code class="docutils literal notranslate"><span class="pre">other.workflow</span></code>, at the same cycle point, succeeding only when
or if it succeeds. Other task states can also be polled:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nv">T00, T12 </span><span class="o">=</span><span class="s"> &quot;my-foo&lt;other.workflow::foo:fail&gt; =&gt; bar&quot;</span>
</pre></div>
</div>
<p>The default polling parameters (e.g. maximum number of polls and the interval
between them) are printed by <code class="docutils literal notranslate"><span class="pre">cylc</span> <span class="pre">workflow-state</span> <span class="pre">--help</span></code> and can be
configured if necessary under the local polling task runtime section:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">T00,T12 = &quot;my-foo&lt;other.workflow::foo&gt; </span><span class="o">=</span><span class="c">&gt;</span> <span class="kd">bar</span><span class="c">&quot;</span>
<span class="nt">[runtime]</span>
    <span class="nt">[[my-foo]]</span>
        <span class="nt">[[[workflow state polling]]]</span>
            <span class="nv">max-polls </span><span class="o">=</span><span class="s"> 100</span>
            <span class="nv">interval </span><span class="o">=</span><span class="s"> PT10S</span>
</pre></div>
</div>
<p>To poll for the target task to receive a message rather than achieve a state,
give the message in the runtime configuration (in which case the task status
inferred from the graph syntax will be ignored):</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[runtime]</span>
    <span class="nt">[[my-foo]]</span>
        <span class="nt">[[[workflow state polling]]]</span>
            <span class="nv">message </span><span class="o">=</span><span class="s"> &quot;the quick brown fox&quot;</span>
</pre></div>
</div>
<p>For workflows owned by others, or those with run databases in non-standard
locations, use the <code class="docutils literal notranslate"><span class="pre">--run-dir</span></code> option, or in-workflow:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[runtime]</span>
    <span class="nt">[[my-foo]]</span>
        <span class="nt">[[[workflow state polling]]]</span>
            <span class="nv">run-dir </span><span class="o">=</span><span class="s"> /path/to/top/level/cylc/run-directory</span>
</pre></div>
</div>
<p>If the remote task has a different cycling sequence, just arrange for the
local polling task to be on the same sequence as the remote task that it
represents. For instance, if local task <code class="docutils literal notranslate"><span class="pre">cat</span></code> cycles 6-hourly at
<code class="docutils literal notranslate"><span class="pre">0,6,12,18</span></code> but needs to trigger off a remote task <code class="docutils literal notranslate"><span class="pre">dog</span></code>
at <code class="docutils literal notranslate"><span class="pre">3,9,15,21</span></code>:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">T03,T09,T15,T21 </span><span class="o">=</span> <span class="c">&quot;</span><span class="kd">my</span><span class="c">-</span><span class="kd">dog</span>&lt;<span class="bp">other.workflow</span>::<span class="nb">dog</span>&gt;<span class="c">&quot;</span>
<span class="nv">        T00,T06,T12,T18 = &quot;my-dog[-PT3H] </span><span class="o">=</span><span class="c">&gt;</span> <span class="kd">cat</span><span class="c">&quot;</span>
</pre></div>
</div>
<p>For workflow-state polling, the cycle point is automatically converted to the
cycle point format of the target workflow.</p>
<p>The remote workflow does not have to be running when polling commences because the
command interrogates the workflow run database, not the <a class="reference internal" href="../../glossary.html#term-scheduler"><span class="xref std std-term">scheduler</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The graph syntax for workflow polling tasks cannot be combined with
cycle point offsets, family triggers, or parameterized task notation.
This does not present a problem because workflow polling tasks can be put on
the same cycling sequence as the remote-workflow target task (as recommended
above), and there is no point in having multiple tasks (family members or
parameterized tasks) performing the same polling operation. Task state
triggers can be used with workflow polling, e.g. to trigger another task if
polling fails after 10 tries at 10 second intervals:</p>
<div class="highlight-cylc notranslate"><div class="highlight"><pre><span></span><span class="nt">[scheduling]</span>
    <span class="nt">[[graph]]</span>
        <span class="nv">R1 = &quot;poller&lt;other-workflow::foo:succeed&gt;:fail </span><span class="o">=</span><span class="c">&gt;</span> <span class="kd">another</span><span class="c">-</span><span class="kd">task</span><span class="c">&quot;</span>
<span class="nt">[runtime]</span>
    <span class="nt">[[my-foo]]</span>
        <span class="nt">[[[workflow state polling]]]</span>
            <span class="nv">max-polls </span><span class="o">=</span><span class="s"> 10</span>
            <span class="nv">interval </span><span class="o">=</span><span class="s"> PT10S</span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="jinja2.html" class="btn btn-neutral float-left" title="Jinja2" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="suicide-triggers.html" class="btn btn-neutral float-right" title="Suicide Triggers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2008-2025 NIWA &amp; British Crown (Met Office) &amp; Contributors.
      <span class="lastupdated">Last updated on Aug 08, 2025.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <!--
  element which gets populated with the list of available versions and
  formats for the documentation by versions.js
-->
<div
  class="rst-versions"
  data-toggle="rst-versions"
  id='versions-and-formats'
></div>




<script type="text/javascript">
    const CUR_FORMAT = "html";
    const CUR_VERSION = "8.5.1";
    // name of page (in URL), for singlepage builds this will be `index`
    const PAGE_NAME = "user-guide/writing-workflows/external-triggers";
    // URL path to the base docs dir i.e. ROOT_DIR/version/format
    const ROOT_DIR = "../../../..";
</script>

<script
  type="text/javascript"
  src="../../../../versions.js"
></script><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
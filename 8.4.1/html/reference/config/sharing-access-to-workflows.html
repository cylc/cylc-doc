

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Authorizing Others to Access Your Workflows &mdash; Cylc 8.4.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=47202671" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/diff_selector.css?v=9704a72b" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/grid_table.css?v=0285b42e" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/hieroglyph_theme_addons.css?v=814c2015" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/tutorial.css?v=b869d33c" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/addons.css?v=d1f804c3" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=0fad80e6" />

  
    <link rel="shortcut icon" href="../../_static/cylc-favicon.ico"/>
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=4e3f4076"></script>
      <script src="../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/js/diff_selector.js?v=3109bfa4"></script>
      <script src="../../_static/js/minicylc.js?v=ddc882fd"></script>
      <script src="../../_static/js/spoiler.js?v=12631137"></script>
      <script src="../../_static/js/addons.js?v=39bd7dee"></script>
      <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Cylc Configuration Data Types" href="types.html" />
    <link rel="prev" title="UI Server Configuration" href="ui-server.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/cylc-logo-white.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../7-to-8/index.html">Cylc 8 Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/index.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user-guide/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plugins/index.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../workflow-design-guide/index.html">Workflow Design Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../changes.html">Changes</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Configuration</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="file-format.html">The .cylc File Format</a></li>
<li class="toctree-l3"><a class="reference internal" href="workflow.html">Workflow Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="global.html">Global Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="ui-server.html">UI Server Configuration</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Authorizing Others to Access Your Workflows</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jupyter-hub-authorisation">Jupyter Hub Authorisation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#jupyter-server-authorisation">Jupyter Server Authorisation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cylc-user-authorisation">Cylc User Authorisation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cylc-site-configuration">Cylc Site Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#interacting-with-others-workflows">Interacting with Others’ Workflows</a></li>
<li class="toctree-l4"><a class="reference internal" href="#troubleshooting-authorization">Troubleshooting Authorization</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="types.html">Cylc Configuration Data Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="writing-platform-configs.html">Platform Configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../job-script-vars/index.html">Job Script Environment Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../architecture/index.html">Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/index.html">Cylc API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/conda.html">Conda Environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev-history-major-changes.html">Cylc Development History - Major Changes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Cylc</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Reference</a></li>
          <li class="breadcrumb-item"><a href="index.html">Configuration</a></li>
      <li class="breadcrumb-item active">Authorizing Others to Access Your Workflows</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/reference/config/sharing-access-to-workflows.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="authorizing-others-to-access-your-workflows">
<span id="cylc-uiserver-multi-user"></span><h1>Authorizing Others to Access Your Workflows<a class="headerlink" href="#authorizing-others-to-access-your-workflows" title="Link to this heading"></a></h1>
<p>For multi-user setups, the Cylc web GUI can be deployed as part of a
<a class="reference external" href="https://jupyterhub.readthedocs.io/en/stable/">Jupyter Hub</a> setup where a central service spawns servers on behalf of users.</p>
<p>The Cylc UI Server can be configured to allow specified users to monitor and
optionally control workflows running under other user accounts.</p>
<p>This has many use cases including:</p>
<ul class="simple">
<li><p>Collaborative research setups where multiple users need to access the same
workflow.</p></li>
<li><p>Production systems where different levels of support may have different
levels of access.</p></li>
<li><p>Support where administrators may require access to users workflows.</p></li>
</ul>
<p>A multi-user Cylc setup consists of three components:</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://jupyterhub.readthedocs.io/en/stable/">Jupyter Hub</a></p></li>
<li><p><a class="reference external" href="https://jupyter-server.readthedocs.io">Jupyter Server</a></p></li>
<li><p><a class="reference external" href="https://github.com/cylc/cylc-uiserver">Cylc UI Server</a></p></li>
</ol>
<p>And may additionally include other Jupyter Server extensions such as
<a class="reference external" href="https://jupyterlab.readthedocs.io/en/stable/getting_started/overview.html">Jupyter Lab</a> to provide a full interactive virtual workstation in the
browser.</p>
<p>In order to allow access to other users servers, to permit the monitoring and
optionally control of other users workflows, each of these three components
must be configured:</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://jupyterhub.readthedocs.io/en/stable/">Jupyter Hub</a> must be configured to allow connections to other users servers.</p></li>
<li><p>The <a class="reference external" href="https://jupyter-server.readthedocs.io">Jupyter Server</a> authorisation policy must be set.</p></li>
<li><p>Cylc must be configured with user permissions.</p></li>
</ol>
<p>This configuration can all be performed in the same Jupyter / Cylc UI Server
configuration file. See <a class="reference internal" href="ui-server.html#ui-server-config"><span class="std std-ref">UI Server Configuration</span></a> for more details.</p>
<p class="rubric">Quick Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># /etc/cylc/uiserver/jupyter_config.py</span>

<span class="c1"># 1. Jupyter Hub</span>
<span class="c1">#    Allow all authenticated users to access, start and stop</span>
<span class="c1">#    each other&#39;s servers</span>
<span class="n">c</span><span class="o">.</span><span class="n">JupyterHub</span><span class="o">.</span><span class="n">load_roles</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span>
        <span class="s2">&quot;scopes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;self&quot;</span><span class="p">,</span> <span class="s2">&quot;access:servers&quot;</span><span class="p">,</span> <span class="s2">&quot;servers&quot;</span><span class="p">],</span>
    <span class="p">}</span>
<span class="p">]</span>


<span class="c1"># 2. Jupyter Server</span>
<span class="c1">#    Set a safe authorisation policy for multi-user setups</span>
<span class="c1">#    Note: This is ONLY necessary if you are deploying the Cylc UI Server</span>
<span class="c1">#          using commands other than `cylc hub` and `cylc hubapp`,</span>
<span class="c1">#          otherwise, it is the default.</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cylc.uiserver.authorise</span><span class="w"> </span><span class="kn">import</span> <span class="n">CylcAuthorizer</span>
<span class="n">c</span><span class="o">.</span><span class="n">ServerApp</span><span class="o">.</span><span class="n">authorizer_class</span> <span class="o">=</span> <span class="n">CylcAuthorizer</span>


<span class="c1"># 3. Cylc</span>
<span class="c1">#    Delegate permissions to users</span>
<span class="n">c</span><span class="o">.</span><span class="n">CylcUIServer</span><span class="o">.</span><span class="n">user_authorization</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># provide all authenticated users with read-only access to each other&#39;s</span>
    <span class="c1"># servers</span>
    <span class="s2">&quot;*&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;READ&quot;</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The rest of this document takes you through each of these configurations, some
of the key options and how they relate to their respective systems.</p>
<section id="jupyter-hub-authorisation">
<span id="jupyterhub-authorization"></span><h2>Jupyter Hub Authorisation<a class="headerlink" href="#jupyter-hub-authorisation" title="Link to this heading"></a></h2>
<p>By default, <a class="reference external" href="https://jupyterhub.readthedocs.io/en/stable/">Jupyter Hub</a> only allows users to access their own servers.</p>
<p>In order to allow access to other users’ servers, two scopes must be configured:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">access:servers</span></code></dt><dd><p>Permits us to connect to another user’s server.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">servers</span></code></dt><dd><p>Permits us to start another user’s server.</p>
</dd>
</dl>
<p>This is done using the
<a class="reference external" href="https://jupyterhub.readthedocs.io/en/stable/reference/api/app.html#jupyterhub.app.JupyterHub.load_roles" title="(in JupyterHub)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">c.JupyterHub.load_roles</span></code></a>
configuration.
For more information see the
<a class="reference external" href="https://jupyterhub.readthedocs.io/en/stable/rbac/scopes.html#jupyterhub-scopes" title="(in JupyterHub)"><span class="xref std std-ref">JupyterHub scopes reference</span></a>.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># /etc/cylc/uiserver/jupyter_config.py</span>

<span class="n">c</span><span class="o">.</span><span class="n">JupyterHub</span><span class="o">.</span><span class="n">load_roles</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="c1"># allow all authenticated users to access, start and stop</span>
        <span class="c1"># each other&#39;s servers</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span>
        <span class="s2">&quot;scopes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;self&quot;</span><span class="p">,</span> <span class="s2">&quot;access:servers&quot;</span><span class="p">,</span> <span class="s2">&quot;servers&quot;</span><span class="p">],</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</section>
<section id="jupyter-server-authorisation">
<span id="jupyterserver-authorization"></span><h2>Jupyter Server Authorisation<a class="headerlink" href="#jupyter-server-authorisation" title="Link to this heading"></a></h2>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can skip this section if you are starting Jupyter Hub using <code class="docutils literal notranslate"><span class="pre">cylc</span> <span class="pre">hub</span></code>
command and have not overridden the
<a class="reference external" href="https://jupyterhub.readthedocs.io/en/stable/reference/api/app.html#jupyterhub.app.JupyterHub.spawner_class" title="(in JupyterHub)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">c.JupyterHub.spawner_class</span></code></a>
configuration (so are spawning the <code class="docutils literal notranslate"><span class="pre">cylc</span> <span class="pre">hubapp</span></code> command).</p>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="cylc.uiserver.authorise.CylcAuthorizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cylc.uiserver.authorise.</span></span><span class="sig-name descname"><span class="pre">CylcAuthorizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/cylc/uiserver/authorise.html#CylcAuthorizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cylc.uiserver.authorise.CylcAuthorizer" title="Link to this definition"></a></dt>
<dd><p>Defines a safe default authorization policy for Jupyter Server.</p>
<p><a class="reference external" href="https://jupyter-server.readthedocs.io">Jupyter Server</a> provides an authorisation layer which gives full
permissions to any user who has been granted permission to the Jupyter Hub
<code class="docutils literal notranslate"><span class="pre">access:servers</span></code> scope
(see <a class="reference external" href="https://jupyterhub.readthedocs.io/en/stable/rbac/scopes.html#jupyterhub-scopes" title="(in JupyterHub)"><span class="xref std std-ref">JupyterHub scopes reference</span></a>). This allows
the execution of arbitrary code under another user account.</p>
<p>To prevent this you must define an authorisation policy using
<a class="reference external" href="https://jupyter-server.readthedocs.io/en/latest/api/jupyter_server.html#jupyter_server.serverapp.ServerApp.authorizer_class" title="(in Jupyter Server v2.16)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">c.ServerApp.authorizer_class</span></code></a>.</p>
<p>This class defines a policy which blocks all API calls to another user’s
server, apart from calls to Cylc interfaces explicitly defined in the
<a class="reference internal" href="#cylc-uiserver-user-authorization"><span class="std std-ref">Cylc authorisation configuration</span></a>.</p>
<p>This class is configured as the default authoriser for all Jupyter Server
instances spawned via the <code class="docutils literal notranslate"><span class="pre">cylc</span> <span class="pre">hubapp</span></code> command. This is the default if
you started <a class="reference external" href="https://jupyterhub.readthedocs.io/en/stable/">Jupyter Hub</a> using the <code class="docutils literal notranslate"><span class="pre">cylc</span> <span class="pre">hub</span></code> command. To see where
this default is set, see this file for the appropriate release of
cylc-uiserver:
<a class="reference external" href="https://github.com/cylc/cylc-uiserver/blob/master/cylc/uiserver/jupyter_config.py">https://github.com/cylc/cylc-uiserver/blob/master/cylc/uiserver/jupyter_config.py</a></p>
<p>If you are launching Jupyter Hub via another command (e.g. <code class="docutils literal notranslate"><span class="pre">jupyterhub</span></code>)
or are overriding <a class="reference external" href="https://jupyterhub.readthedocs.io/en/stable/reference/api/app.html#jupyterhub.app.JupyterHub.spawner_class" title="(in JupyterHub)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">jupyterhub.app.JupyterHub.spawner_class</span></code></a>, then
you will need to configure a safe authorisation policy e.g:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">cylc.uiserver.authorise</span><span class="w"> </span><span class="kn">import</span> <span class="n">CylcAuthorizer</span>
<span class="n">c</span><span class="o">.</span><span class="n">ServerApp</span><span class="o">.</span><span class="n">authorizer_class</span> <span class="o">=</span> <span class="n">CylcAuthorizer</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is possible to provide read-only access to Jupyter Server extensions
such as Jupyter Lab, however, this isn’t advisable as Jupyter Lab does
not apply file-system permissions to what another user is allowed to
see.</p>
<p>If you wish to grant users access to other user’s Jupyter Lab servers,
override this configuration with due care over what you choose to
expose.</p>
</div>
</dd></dl>

</section>
<section id="cylc-user-authorisation">
<span id="cylc-uiserver-user-authorization"></span><h2>Cylc User Authorisation<a class="headerlink" href="#cylc-user-authorisation" title="Link to this heading"></a></h2>
<p>Cylc Authorisation is configurable on a per-user and per-command basis but
not on a per-workflow basis.</p>
<p>By default users can only see and interact with their own workflows.</p>
<p>Sites can restrict the permissions that users are allowed to grant each
other and can configure default permissions (see <a class="reference internal" href="#site-configuration"><span class="std std-ref">Cylc Site Configuration</span></a>).</p>
<p>Authorization is configured by these two configurations:</p>
<ul class="simple">
<li><p><a class="reference internal" href="ui-server.html#cylc.uiserver.app.CylcUIServer.user_authorization" title="cylc.uiserver.app.CylcUIServer.user_authorization"><code class="xref py py-attr docutils literal notranslate"><span class="pre">c.CylcUIServer.user_authorization</span></code></a> (user configuration)</p></li>
<li><p><a class="reference internal" href="ui-server.html#cylc.uiserver.app.CylcUIServer.site_authorization" title="cylc.uiserver.app.CylcUIServer.site_authorization"><code class="xref py py-attr docutils literal notranslate"><span class="pre">c.CylcUIServer.site_authorization</span></code></a> (site configuration)</p></li>
</ul>
<p class="rubric">Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ~/.cylc/uiserver/jupyter_config.py</span>

<span class="n">c</span><span class="o">.</span><span class="n">CylcUIServer</span><span class="o">.</span><span class="n">user_authorization</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># &lt;user/group&gt;: [&lt;permission&gt;, ...],</span>

    <span class="c1"># allow &quot;user1&quot; to monitor my workflows</span>
    <span class="s2">&quot;user1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;READ&quot;</span><span class="p">],</span>

    <span class="c1"># allow &quot;user2&quot; to monitor and trigger tasks in my workflows</span>
    <span class="s2">&quot;user2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;READ&quot;</span><span class="p">,</span> <span class="s2">&quot;Trigger&quot;</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
<section id="users">
<h3>Users<a class="headerlink" href="#users" title="Link to this heading"></a></h3>
<p>There are three methods of identifying a user to grant access to:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">&lt;username&gt;</span></code></dt><dd><p>Configures permissions for a single user.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">group:&lt;groupname&gt;</span></code></dt><dd><p>Configures a user group. For more information, see <a class="reference internal" href="#group-support"><span class="std std-ref">Group Support</span></a>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">*</span></code></dt><dd><p>Configures permissions for any authenticated user (see
<a class="reference external" href="https://jupyterhub.readthedocs.io/en/stable/reference/authenticators.html#authenticators-reference" title="(in JupyterHub)"><span class="xref std std-ref">Jupyter Hub authenticators reference</span></a>
for details).</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using glob patterns to match user and group names is
not currently supported.</p>
</div>
</section>
<section id="permissions">
<h3>Permissions<a class="headerlink" href="#permissions" title="Link to this heading"></a></h3>
<p>Permissions can be granted for each Cylc command individually. For convenience,
commands are arranged into groups to avoid having to list them individually:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">READ</span></code> (i.e. read-only access)</dt><dd><p>A user with read permissions may view workflows, monitor tasks states and
open log files, but they cannot interact with the workflows.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Read</span></code></p></li>
</ul>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">CONTROL</span></code> (e.g. start &amp; stop workflows)</dt><dd><p>A user with control permissions may issue commands to interact with workflows
and can start/stop workflows but cannot redefine the workflow configuration
itself (without direct filesystem access).</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Clean</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Ext-trigger</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Hold</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Kill</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Message</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Pause</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Play</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Poll</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Release</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ReleaseHoldPoint</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Reload</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Remove</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Resume</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SetGraphWindowExtent</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SetHoldPoint</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SetOutputs</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SetVerbosity</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Stop</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Trigger</span></code></p></li>
</ul>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ALL</span></code> (i.e. full control)</dt><dd><p>A user with all permissions may alter task configuration so may inject
arbitrary code into the workflow.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Broadcast</span></code></p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>With the exception of <code class="docutils literal notranslate"><span class="pre">Read</span></code> all of the above permissions map onto the
Cylc GraphQL mutations which themselves map onto the command line.</p>
<p>E.G. the <code class="docutils literal notranslate"><span class="pre">Play</span></code> permission maps onto <code class="docutils literal notranslate"><span class="pre">mutation</span> <span class="pre">play</span></code> in the GraphQL
schema and <code class="docutils literal notranslate"><span class="pre">cylc</span> <span class="pre">play</span></code> on the command line.</p>
<p>To find out more about a command, see the GraphQL or CLI documentation.</p>
</div>
<p>By default, users have full permissions (<code class="docutils literal notranslate"><span class="pre">READ</span></code>, <code class="docutils literal notranslate"><span class="pre">CONTROL</span></code> and <code class="docutils literal notranslate"><span class="pre">ALL</span></code>) for their own workflows and no
permissions for other users’ workflows.</p>
<p>Permissions are additive, so for example, granting <code class="docutils literal notranslate"><span class="pre">READ</span></code> and <code class="docutils literal notranslate"><span class="pre">CONTROL</span></code>
would provide all of the permissions from those two groups.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">!</span></code> character can be used to subtract permissions, e.g. delegating
<code class="docutils literal notranslate"><span class="pre">CONTROL</span></code> and <code class="docutils literal notranslate"><span class="pre">!Stop</span></code> would provide all control permissions except stop.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Granting access to a group does not automatically grant access to lower
groups e.g. granting <code class="docutils literal notranslate"><span class="pre">CONTROL</span></code> access does not automatically grant
<code class="docutils literal notranslate"><span class="pre">READ</span></code> access.</p>
</div>
</section>
<section id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ~/.cylc/uiserver/jupyter_config.py</span>

<span class="n">c</span><span class="o">.</span><span class="n">CylcUIServer</span><span class="o">.</span><span class="n">user_authorization</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;*&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;READ&quot;</span><span class="p">],</span>
    <span class="s2">&quot;group:groupA&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;CONTROL&quot;</span><span class="p">],</span>
    <span class="s2">&quot;user1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;read&quot;</span><span class="p">,</span> <span class="s2">&quot;pause&quot;</span><span class="p">,</span> <span class="s2">&quot;!play&quot;</span><span class="p">],</span>
    <span class="s2">&quot;user2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;!ALL&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In this scenario:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;*&quot;</span></code>  represents any authenticated user. They have permission to view all
workflows on the GUI.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;group:groupA&quot;</span></code> applies <code class="docutils literal notranslate"><span class="pre">CONTROL</span></code> permissions to any member of system
<code class="docutils literal notranslate"><span class="pre">groupA</span></code>.
Note that, since permissions are inherited, these users will gain <code class="docutils literal notranslate"><span class="pre">READ</span></code> access
from the <code class="docutils literal notranslate"><span class="pre">&quot;*&quot;:[&quot;READ&quot;]</span></code> assignment.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;user1&quot;</span></code> will have permission to view workflows, <code class="docutils literal notranslate"><span class="pre">pause</span></code> but not <code class="docutils literal notranslate"><span class="pre">play</span></code>
workflows, even if <code class="docutils literal notranslate"><span class="pre">user1</span></code> is a member of the system <code class="docutils literal notranslate"><span class="pre">groupA</span></code>. This is due
to negations taking precedence over additions.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;user2&quot;</span></code> is not permitted to view workflows, or perform any operations.</p></li>
</ul>
</section>
</section>
<section id="cylc-site-configuration">
<span id="site-configuration"></span><h2>Cylc Site Configuration<a class="headerlink" href="#cylc-site-configuration" title="Link to this heading"></a></h2>
<p>The <a class="reference internal" href="ui-server.html#cylc.uiserver.app.CylcUIServer.site_authorization" title="cylc.uiserver.app.CylcUIServer.site_authorization"><code class="xref py py-attr docutils literal notranslate"><span class="pre">c.CylcUIServer.site_authorization</span></code></a> configuration allows sites
to configure sensible defaults and limits for the permissions users can
grant.</p>
<p>It takes the form:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;&lt;owner&gt;&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;&lt;user&gt;&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="p">[],</span>
      <span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="p">[]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">&lt;owner&gt;</span></code> is the username of the account that is running a server and
<code class="docutils literal notranslate"><span class="pre">&lt;user&gt;</span></code> is the username of an account trying to connect to it.</p>
<p>Sites can set both limits and defaults for users:</p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">limit</span></code></dt><dd><p>Determines the maximum access users can grant to their workflows.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">default</span></code></dt><dd><p>Sets a default access level, which applies if the user does not appear in
the user_authorization configuration (via explicit user name or group).</p>
<p>Note, these defaults apply only if a user does not appear in
<a class="reference internal" href="ui-server.html#cylc.uiserver.app.CylcUIServer.user_authorization" title="cylc.uiserver.app.CylcUIServer.user_authorization"><code class="xref py py-attr docutils literal notranslate"><span class="pre">c.CylcUIServer.user_authorization</span></code></a>.</p>
</dd>
</dl>
<ul class="simple">
<li><p>If a limit is not set but a default is, then the limit is the default.</p></li>
<li><p>If a default is not set but a limit is, then the default is no access.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As the UI Server runs as the workflow owner, the owner has full control over
it and in theory may bypass these restrictions in a variety of ways. As an
extreme example, a workflow owner could pass their account credentials to
another person. This cannot be prevented by technical means. However, a
workflow owner cannot unilaterally gain access to any other user’s account
or workflows by configuring their own UI Server.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Changes to the Cylc authorization configuration will take effect when the
Cylc UI Server is restarted.</p>
</div>
<section id="group-support">
<span id="id1"></span><h3>Group Support<a class="headerlink" href="#group-support" title="Link to this heading"></a></h3>
<p>Unix-like systems support user groups. Cylc authorization supports granting
access by membership of these system groups. You can indicate a system group
by using the <code class="docutils literal notranslate"><span class="pre">group:</span></code> indicator.</p>
<p>System groups are found by
<a class="reference internal" href="#cylc.uiserver.authorise.get_groups" title="cylc.uiserver.authorise.get_groups"><code class="xref py py-mod docutils literal notranslate"><span class="pre">get_groups</span></code></a></p>
<dl class="py function">
<dt class="sig sig-object py" id="cylc.uiserver.authorise.get_groups">
<span class="sig-prename descclassname"><span class="pre">cylc.uiserver.authorise.</span></span><span class="sig-name descname"><span class="pre">get_groups</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/cylc/uiserver/authorise.html#get_groups"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cylc.uiserver.authorise.get_groups" title="Link to this definition"></a></dt>
<dd><p>Return a list of system groups for given user.</p>
<p>Uses <code class="docutils literal notranslate"><span class="pre">os.getgrouplist</span></code> and <code class="docutils literal notranslate"><span class="pre">os.NGROUPS_MAX</span></code> to get system groups for a
given user. <code class="docutils literal notranslate"><span class="pre">grp.getgrgid</span></code> then parses these to return a list of group
names.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>username</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – username used to check system groups.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>System groups for username given</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><em>Tuple</em></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><em>List</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><em>List</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>]]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="example-site-authorization-configuration">
<h3>Example Site Authorization Configuration<a class="headerlink" href="#example-site-authorization-configuration" title="Link to this heading"></a></h3>
<p>Whilst most site configurations will be simpler than the example below, this
example provides an indication of the combinations available.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># /etc/cylc/uiserver/jupyter_config.py</span>

<span class="n">c</span><span class="o">.</span><span class="n">CylcUIServer</span><span class="o">.</span><span class="n">site_authorization</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;*&quot;</span><span class="p">:</span> <span class="p">{</span>  <span class="c1"># For all ui-server owners,</span>
        <span class="s2">&quot;*&quot;</span><span class="p">:</span> <span class="p">{</span>  <span class="c1"># Any authenticated user</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="s2">&quot;READ&quot;</span><span class="p">,</span>  <span class="c1"># Will have default read-only access</span>
        <span class="p">},</span>
        <span class="s2">&quot;user1&quot;</span><span class="p">:</span> <span class="p">{</span>  <span class="c1"># for all ui-server owners, user1</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;!ALL&quot;</span><span class="p">],</span>  <span class="c1"># has no privileges by default</span>
        <span class="p">},</span>  <span class="c1"># No limit set, so all ui-server owners are unable to permit user1</span>
    <span class="p">},</span>
    <span class="s2">&quot;server_owner_1&quot;</span><span class="p">:</span> <span class="p">{</span>  <span class="c1"># For specific UI Server owner, server_owner_1</span>
        <span class="s2">&quot;*&quot;</span><span class="p">:</span> <span class="p">{</span>  <span class="c1"># Any authenticated user</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="s2">&quot;READ&quot;</span><span class="p">,</span>  <span class="c1"># Will have default read-only access</span>
            <span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;READ&quot;</span><span class="p">,</span> <span class="s2">&quot;CONTROL&quot;</span><span class="p">],</span>  <span class="c1"># server_owner_1 is able to give away</span>
        <span class="p">},</span>  <span class="c1"># READ and CONTROL privileges.</span>
    <span class="p">},</span>
    <span class="s2">&quot;server_owner_2&quot;</span><span class="p">:</span> <span class="p">{</span>  <span class="c1"># For specific UI Server owner,</span>
        <span class="s2">&quot;user2&quot;</span><span class="p">:</span> <span class="p">{</span>  <span class="c1"># Specific user2</span>
            <span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="s2">&quot;ALL&quot;</span>  <span class="c1"># Can only be granted a maximum of ALL by</span>
        <span class="p">},</span>  <span class="c1"># server_owner2, default access for user2 falls back to</span>
        <span class="c1"># standard READ only (if server_owner_2/user2 are</span>
        <span class="c1"># included in other auth config e.g. the top example),</span>
        <span class="c1"># or none if not in any other auth config sections.</span>
        <span class="s2">&quot;group:groupA&quot;</span><span class="p">:</span> <span class="p">{</span>  <span class="c1"># group denoted with a `group:`</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;READ&quot;</span><span class="p">,</span>
                <span class="s2">&quot;CONTROL&quot;</span><span class="p">,</span>
            <span class="p">]</span>  <span class="c1"># groupA has default READ, CONTROL access to server_owner_2&#39;s</span>
        <span class="p">},</span>  <span class="c1"># workflows</span>
    <span class="p">},</span>
    <span class="s2">&quot;group:grp_of_svr_owners&quot;</span><span class="p">:</span> <span class="p">{</span>  <span class="c1"># Group of users who own UI Servers</span>
        <span class="s2">&quot;group:groupB&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="s2">&quot;READ&quot;</span><span class="p">,</span>  <span class="c1"># can grant groupB users up to READ and CONTROL</span>
            <span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="p">[</span>  <span class="c1"># privileges, without stop and kill</span>
                <span class="s2">&quot;READ&quot;</span><span class="p">,</span>
                <span class="s2">&quot;CONTROL&quot;</span><span class="p">,</span>
                <span class="s2">&quot;!stop&quot;</span><span class="p">,</span>  <span class="c1"># operations</span>
                <span class="s2">&quot;!kill&quot;</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">},</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="interacting-with-others-workflows">
<h2>Interacting with Others’ Workflows<a class="headerlink" href="#interacting-with-others-workflows" title="Link to this heading"></a></h2>
<p>If you have been granted access to another user’s workflows, you can view and
interact with these workflows.
Say, you, userA, wish to interact with userB’s workflows.
You can do this by navigating to the URL <code class="docutils literal notranslate"><span class="pre">https://&lt;hub&gt;/user/userB</span></code>, using
the hub of userB. You should authenticate as yourself (userA) and, provided you
have the correct permissions, you will see userB’s workflows for interaction.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Operations that are not authorized will appear greyed out on the UI.</p>
</div>
</section>
<section id="troubleshooting-authorization">
<h2>Troubleshooting Authorization<a class="headerlink" href="#troubleshooting-authorization" title="Link to this heading"></a></h2>
<p>If authorization is not performing as expected, check</p>
<ul class="simple">
<li><p>you are permitted by the site configuration to give away access.</p></li>
<li><p>you have provided <code class="docutils literal notranslate"><span class="pre">read</span></code> permissions, which enables the user to see your
workflows.</p></li>
<li><p>check the spelling in your configuration. The correct spelling is
<code class="docutils literal notranslate"><span class="pre">c.CylcUIServer.user_authorization</span></code></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ui-server.html" class="btn btn-neutral float-left" title="UI Server Configuration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="types.html" class="btn btn-neutral float-right" title="Cylc Configuration Data Types" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2008-2025 NIWA &amp; British Crown (Met Office) &amp; Contributors.
      <span class="lastupdated">Last updated on Feb 25, 2025.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <!--
  element which gets populated with the list of available versions and
  formats for the documentation by versions.js
-->
<div
  class="rst-versions"
  data-toggle="rst-versions"
  id='versions-and-formats'
></div>




<script type="text/javascript">
    const CUR_FORMAT = "html";
    const CUR_VERSION = "8.4.1";
    // name of page (in URL), for singlepage builds this will be `index`
    const PAGE_NAME = "reference/config/sharing-access-to-workflows";
    // URL path to the base docs dir i.e. ROOT_DIR/version/format
    const ROOT_DIR = "../../../..";
</script>

<script
  type="text/javascript"
  src="../../../../versions.js"
></script><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>